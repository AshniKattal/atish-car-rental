(this["webpackJsonp@minimal/minimal-kit-react"]=this["webpackJsonp@minimal/minimal-kit-react"]||[]).push([[91],{1829:function(e,n,t){"use strict";t.r(n);var i=t(9),l=t(28),a=t(7),o=t(18),c=t(3),d=t.n(c),r=t(4),u=t(48),s=t(52),v=t(1514),b=t(1522),m=t(1473),p=t(130),j=t(1497),O=t(147),f=t(286),y=t(156),h=t(251),x=t(72),N=t(120),g=t(207),C=t(77),k=t(84),w=t(0),R=Object(r.lazy)((function(){return Promise.all([t.e(1),t.e(8)]).then(t.bind(null,1547))})),T=Object(r.lazy)((function(){return Promise.all([t.e(7),t.e(92)]).then(t.bind(null,1586))})),S=Object(r.lazy)((function(){return t.e(93).then(t.bind(null,1774))}));n.default=function(){var e,n=Object(k.a)().themeStretch,t=Object(s.b)(),c=Object(N.b)().enqueueSnackbar,E=Object(x.a)().user,I=Object(s.c)(y.c).companyList,D=Object(r.useState)([]),L=Object(o.a)(D,2),B=L[0],_=L[1],P=Object(r.useState)([]),z=Object(o.a)(P,2),F=z[0],H=z[1],A=Object(r.useState)({id:"",companyRefId:"",companyRefName:"",name:"",companyType:"",tan:"",address:"",contactNumber:"",mobileNumber:"",email:"",email2:"",email3:"",email4:"",brn:"",nic:"",buyerType:null,representativeName:"",representativeContactNumber:""}),J=Object(o.a)(A,2),K=J[0],M=J[1],Z=Object(r.useState)(""),q=Object(o.a)(Z,2),U=q[0],V=q[1],W=Object(r.useState)(null),Y=Object(o.a)(W,2),G=Y[0],Q=Y[1],X=Object(r.useState)(null),$=Object(o.a)(X,2),ee=$[0],ne=$[1],te=Object(r.useState)(!1),ie=Object(o.a)(te,2),le=ie[0],ae=ie[1],oe=Object(r.useState)(""),ce=Object(o.a)(oe,2),de=ce[0],re=ce[1],ue=Object(r.useRef)(),se=Object(r.useRef)(),ve=Object(r.useRef)(),be=Object(r.useRef)(),me=Object(r.useRef)(),pe=Object(r.useState)(!1),je=Object(o.a)(pe,2),Oe=je[0],fe=je[1];Object(r.useEffect)((function(){me.current()}),[U]),me.current=function(){var e,n,t;U&&(null!==E&&void 0!==E&&null!==(e=E.permissions)&&void 0!==e&&null!==(n=e.viewClientChk)&&void 0!==n&&null!==(t=n.assignedCompanyId)&&void 0!==t&&t.includes(U)?fe(!0):(c("You do not have the permission to view clients for this company",{variant:"error"}),fe(!1)))},Object(r.useEffect)((function(){ue.current()}),[E]),Object(r.useEffect)((function(){se.current()}),[I]),Object(r.useEffect)((function(){U&&Oe?ve.current():(_([]),H([]))}),[U,Oe]),Object(r.useEffect)((function(){be.current()}),[G]);var ye=function(){var e=Object(a.a)(d.a.mark((function e(){var n,t,i,l;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"admin_member"===(null===E||void 0===E?void 0:E.role)&&null!==E&&void 0!==E&&E.a_comp&&(null===E||void 0===E||null===(n=E.a_comp)||void 0===n?void 0:n.length)>0&&null!==E&&void 0!==E&&null!==(t=E.permissions)&&void 0!==t&&t.viewClientChk&&1===(null===E||void 0===E||null===(i=E.a_comp)||void 0===i?void 0:i.length)&&V(null===E||void 0===E||null===(l=E.a_comp[0])||void 0===l?void 0:l.id);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();ue.current=ye;var he=function(){var e=Object(a.a)(d.a.mark((function e(){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!I||0!==I.length){e.next=6;break}return t(Object(C.d)(!0)),e.next=4,Object(h.j)(null===E||void 0===E?void 0:E.id,null===E||void 0===E?void 0:E.a_comp,null===E||void 0===E?void 0:E.role);case 4:(n=e.sent).error?(c(n.msg||"",{variant:n.variant}),t(Object(C.d)(!1))):(t(Object(y.d)(n)),t(Object(C.d)(!1)));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();se.current=he;var xe=function(){var e=Object(a.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!U||""===U){e.next=4;break}return t(Object(C.d)(!0)),e.next=4,u.b.collection("company").doc("5HAEgHE1kKox9ZdweP3I").collection("client").orderBy("name","asc").get().then((function(e){var n,i=[];(null===e||void 0===e||null===(n=e.docs)||void 0===n?void 0:n.length)>0?(e.docs.forEach((function(e){var n,t,l,a,o,c,d,r,u,s,v,b,m,p,j,O,f,y;"--counterStatus--"!==e.id&&i.push({id:null===e||void 0===e?void 0:e.id,data:null===e||void 0===e?void 0:e.data(),name:(null===e||void 0===e||null===(n=e.data())||void 0===n?void 0:n.name)||"",companyRefName:(null===e||void 0===e||null===(t=e.data())||void 0===t?void 0:t.companyRefName)||"",companyRefId:(null===e||void 0===e||null===(l=e.data())||void 0===l?void 0:l.companyRefId)||"",companyType:(null===e||void 0===e||null===(a=e.data())||void 0===a?void 0:a.companyType)||"",address:(null===e||void 0===e||null===(o=e.data())||void 0===o?void 0:o.address)||"",contactNumber:(null===e||void 0===e||null===(c=e.data())||void 0===c?void 0:c.contactNumber)||"",mobileNumber:(null===e||void 0===e||null===(d=e.data())||void 0===d?void 0:d.mobileNumber)||"",email:(null===e||void 0===e||null===(r=e.data())||void 0===r?void 0:r.email)||"",email2:(null===e||void 0===e||null===(u=e.data())||void 0===u?void 0:u.email2)||"",email3:(null===e||void 0===e||null===(s=e.data())||void 0===s?void 0:s.email3)||"",email4:(null===e||void 0===e||null===(v=e.data())||void 0===v?void 0:v.email4)||"",tan:(null===e||void 0===e||null===(b=e.data())||void 0===b?void 0:b.tan)||"",brn:(null===e||void 0===e||null===(m=e.data())||void 0===m?void 0:m.brn)||"",nic:(null===e||void 0===e||null===(p=e.data())||void 0===p?void 0:p.nic)||"",buyerType:null!==e&&void 0!==e&&null!==(j=e.data())&&void 0!==j&&j.buyerType?JSON.stringify(null===e||void 0===e||null===(O=e.data())||void 0===O?void 0:O.buyerType):null,representativeName:(null===e||void 0===e||null===(f=e.data())||void 0===f?void 0:f.representativeName)||"",representativeContactNumber:(null===e||void 0===e||null===(y=e.data())||void 0===y?void 0:y.representativeContactNumber)||""})})),H(i),_(i),t(Object(C.d)(!1))):(H([]),_([]),t(Object(C.d)(!1)))})).catch((function(e){c("Error occured while fetching clients: ".concat(null===e||void 0===e?void 0:e.message),{variant:"error"}),t(Object(C.d)(!1))}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();ve.current=xe,be.current=function(){if(G){var e=B.filter((function(e){return(null===e||void 0===e?void 0:e.id)===(null===G||void 0===G?void 0:G.id)}));H(e)}else H(Object(l.a)(B))};var Ne=function(){ae(!1),M({id:"",companyRefId:"",companyRefName:"",name:"",companyType:"",tan:"",address:"",contactNumber:"",mobileNumber:"",email:"",email2:"",email3:"",email4:"",brn:"",nic:"",buyerType:null,representativeName:"",representativeContactNumber:""})},ge=function(){var e=Object(a.a)(d.a.mark((function e(n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(Object(C.d)(!0)),e.next=3,u.b.collection("company").doc("5HAEgHE1kKox9ZdweP3I").collection("client").doc(n).delete().then(Object(a.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:xe(),t(Object(g.e)(void 0)),t(Object(g.d)(void 0)),t(Object(C.d)(!1));case 4:case"end":return e.stop()}}),e)})))).catch((function(e){c("Error occured while deleting a client: ".concat(null===e||void 0===e?void 0:e.message),{variant:"error"}),t(Object(C.d)(!1))}));case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return Object(w.jsxs)(v.a,{maxWidth:!n&&"xl",children:[Object(w.jsxs)("div",{style:{display:"admin_member"===(null===E||void 0===E?void 0:E.role)&&null!==E&&void 0!==E&&E.a_comp&&1===(null===E||void 0===E||null===(e=E.a_comp)||void 0===e?void 0:e.length)?"none":""},children:[Object(w.jsx)(b.a,{children:Object(w.jsx)(m.a,{sx:{p:3},children:Object(w.jsx)(p.a,{container:!0,children:Object(w.jsx)(p.a,{item:!0,xs:12,md:4,children:Object(w.jsx)(j.a,{ListboxProps:{style:{maxHeight:"70vh"}},size:"small",label:"Please select company",id:"client-drop-down",options:I||[],value:ee||null,renderInput:function(e){return Object(w.jsx)(O.a,Object(i.a)(Object(i.a)({},e),{},{label:"Please select company"}))},onChange:function(e,n,t){"removeOption"!==t&&"clear"!==t&&n?(V(null===n||void 0===n?void 0:n.id),ne(n)):"removeOption"!==t&&"clear"!==t||(V(""),ne(null))},getOptionLabel:function(e){return(null===e||void 0===e?void 0:e.name)||""},renderOption:function(e,n){return Object(r.createElement)("li",Object(i.a)(Object(i.a)({},e),{},{key:null===n||void 0===n?void 0:n.id}),Object(w.jsx)("span",{children:(null===n||void 0===n?void 0:n.name)||""}))}})})})})}),Object(w.jsx)("br",{})]}),Object(w.jsx)(p.a,{container:!0,spacing:3,children:U&&Oe&&F?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)(p.a,{item:!0,xs:12,md:12,children:[Object(w.jsx)(f.a,{children:"".concat(null===F||void 0===F?void 0:F.length," clients retrieved")})," "]}),(null===F||void 0===F?void 0:F.length)>0?Object(w.jsx)(p.a,{item:!0,xs:12,md:4,children:Object(w.jsx)(j.a,{ListboxProps:{style:{maxHeight:"70vh"}},size:"small",label:"Search client",id:"client-drop-down",options:B||[],value:G||null,renderInput:function(e){return Object(w.jsx)(O.a,Object(i.a)(Object(i.a)({},e),{},{label:"Search client"}))},onChange:function(e,n,t){"removeOption"!==t&&"clear"!==t&&n?Q(n):"removeOption"!==t&&"clear"!==t||Q(null)},getOptionLabel:function(e){return(null===e||void 0===e?void 0:e.name)||""},renderOption:function(e,n){return Object(r.createElement)("li",Object(i.a)(Object(i.a)({},e),{},{key:null===n||void 0===n?void 0:n.id}),Object(w.jsx)("span",{children:(null===n||void 0===n?void 0:n.name)||""}))}})}):Object(w.jsx)(w.Fragment,{}),Object(w.jsx)(p.a,{item:!0,xs:12,md:12,children:Object(w.jsx)(r.Suspense,{fallback:Object(w.jsx)("p",{children:"Loading..."}),children:Object(w.jsx)(R,{companyId:U,type:"client",headers:[{id:"list",label:"List"},{id:"update",label:"Update"},{id:"delete",label:"Delete"},{id:"name",label:"Name"},{id:"companyType",label:"Type"},{id:"address",label:"Address"},{id:"contactNumber",label:"Contact number"},{id:"mobileNumber",label:"Mobile_Number"},{id:"email",label:"Email 1"},{id:"email2",label:"Email 2"},{id:"email3",label:"Email 3"},{id:"email4",label:"Email 4"},{id:"tan",label:"VAT"},{id:"brn",label:"BRN"},{id:"nic",label:"NIC"},{id:"buyerType",label:"Buyer Type"},{id:"representativeName",label:"Representative name"},{id:"representativeContactNumber",label:"Representative contact number"}],aCollection:F,addBtnDisplay:!!ee,addBtnLabel:"Create a client",addBtnFunc:function(){re("add"),ae(!0),M(Object(i.a)(Object(i.a)({},K),{},{id:"",companyRefName:"",name:"",companyType:"",tan:"",address:"",contactNumber:"",mobileNumber:"",email:"",email2:"",email3:"",email4:"",brn:"",nic:"",buyerType:null,representativeName:"",representativeContactNumber:""}))},openDialog:le,handleCloseDialog:Ne,emptyColMsg:"Sorry, not a single client has been created yet. Please create a client.",updateBtnDisplay:!0,deleteBtnDisplay:!0,updateBtnFunc:function(e,n){re("update"),ae(!0),M({id:e,name:(null===n||void 0===n?void 0:n.name)||"",companyRefId:(null===n||void 0===n?void 0:n.companyRefId)||"",companyRefName:(null===n||void 0===n?void 0:n.companyRefName)||"",companyType:(null===n||void 0===n?void 0:n.companyType)||"",tan:(null===n||void 0===n?void 0:n.tan)||"",address:(null===n||void 0===n?void 0:n.address)||"",email:(null===n||void 0===n?void 0:n.email)||"",email2:(null===n||void 0===n?void 0:n.email2)||"",email3:(null===n||void 0===n?void 0:n.email3)||"",email4:(null===n||void 0===n?void 0:n.email4)||"",contactNumber:(null===n||void 0===n?void 0:n.contactNumber)||"",mobileNumber:(null===n||void 0===n?void 0:n.mobileNumber)||"",brn:(null===n||void 0===n?void 0:n.brn)||"",nic:(null===n||void 0===n?void 0:n.nic)||"",buyerType:(null===n||void 0===n?void 0:n.buyerType)||null,representativeName:(null===n||void 0===n?void 0:n.representativeName)||"",representativeContactNumber:(null===n||void 0===n?void 0:n.representativeContactNumber)||""})},deleteBtnFunc:ge})})})]}):Object(w.jsx)(w.Fragment,{})}),Object(w.jsx)("div",{children:de&&"add"===de?Object(w.jsx)(r.Suspense,{fallback:Object(w.jsx)("p",{children:"Loading..."}),children:Object(w.jsx)(T,{companyId:U,openDialog:le,handleCloseDialog:Ne,clientDetails:K,setClientDetails:M,initializeClientList:xe})}):Object(w.jsx)(r.Suspense,{fallback:Object(w.jsx)("p",{children:"Loading..."}),children:Object(w.jsx)(S,{companyId:U,openDialog:le,handleCloseDialog:Ne,clientDetails:K,setClientDetails:M,initializeClientList:xe})})})]})}}}]);
//# sourceMappingURL=91.1897f1ed.chunk.js.map