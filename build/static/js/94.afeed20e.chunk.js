(this["webpackJsonp@minimal/minimal-kit-react"]=this["webpackJsonp@minimal/minimal-kit-react"]||[]).push([[94],{1828:function(e,a,n){"use strict";n.r(a);var i=n(28),l=n(9),t=n(7),o=n(18),d=n(3),c=n.n(d),r=n(4),u=n(48),m=n(52),s=n(156),v=n(77),b=n(251),p=n(1514),g=n(72),N=n(120),y=n(84),f=n(0),j=Object(r.lazy)((function(){return Promise.all([n.e(7),n.e(95)]).then(n.bind(null,1772))})),O=Object(r.lazy)((function(){return n.e(96).then(n.bind(null,1773))})),k=Object(r.lazy)((function(){return Promise.all([n.e(1),n.e(8)]).then(n.bind(null,1547))}));a.default=function(){var e=Object(y.a)().themeStretch,a=Object(N.b)().enqueueSnackbar,n=Object(m.b)(),d=Object(g.a)().user,h=Object(m.c)(s.c).companyList,A=Object(r.useState)([]),R=Object(o.a)(A,2),S=R[0],T=R[1],w=Object(r.useRef)(),B=Object(r.useState)({id:"",name:"",vatPercentage:0,imageName:"",imageUrl:"",imageSig:"",sigUrl:"",stampName:"",stampUrl:"",companyType:"",vatOrNonVatRegistered:null,tan:"",address:"",contactNumber:"",mobileNumber:"",email:"",brn:"",beneficiaryName:"",bankName:"",bankAccNo:"",bankIban:"",bankSwiftCode:"",MRATemplateFlag:null,displayMRAFiscalisationButton:!1,documentTemplate:""}),x=Object(o.a)(B,2),C=x[0],U=x[1],M=Object(r.useState)(!1),F=Object(o.a)(M,2),D=F[0],I=F[1],P=Object(r.useState)(""),V=Object(o.a)(P,2),_=V[0],E=V[1];Object(r.useEffect)((function(){w.current()}),[]);var z=function(){var e=Object(t.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===(null===d||void 0===d?void 0:d.id)){e.next=6;break}return n(Object(v.d)(!0)),e.next=4,u.b.collection("company").orderBy("name","asc").get().then((function(e){var a=[],i=[];e.docs&&e.docs.length>0?(e.docs.forEach((function(e){var n,t,o,c,r,u,m,s,v,b,p,g,N,y,f,j,O,k,h,A,R,S,T,w,B,x,C,U,M;("super-admin"===(null===d||void 0===d?void 0:d.role)||null!==d&&void 0!==d&&d.a_comp&&(null===d||void 0===d||null===(n=d.a_comp)||void 0===n?void 0:n.length)>0&&null!==d&&void 0!==d&&d.a_comp.find((function(a){return a.id===e.id})))&&"companyIds"!==(null===e||void 0===e?void 0:e.id)&&(null!==d&&void 0!==d&&null!==(t=d.permissions)&&void 0!==t&&null!==(o=t.viewCompChk)&&void 0!==o&&o.assignedCompanyId.includes(e.id)&&(a.push({id:null===e||void 0===e?void 0:e.id,data:null===e||void 0===e?void 0:e.data(),name:(null===e||void 0===e||null===(c=e.data())||void 0===c?void 0:c.name)||"",MRATemplateFlag:null!==e&&void 0!==e&&null!==(r=e.data())&&void 0!==r&&r.MRATemplateFlag?JSON.stringify(null===e||void 0===e||null===(u=e.data())||void 0===u?void 0:u.MRATemplateFlag):null,displayMRAFiscalisationButton:(null===e||void 0===e||null===(m=e.data())||void 0===m?void 0:m.displayMRAFiscalisationButton)||!1,vatOrNonVatRegistered:null!==e&&void 0!==e&&null!==(s=e.data())&&void 0!==s&&s.vatOrNonVatRegistered?JSON.stringify(null===e||void 0===e||null===(v=e.data())||void 0===v?void 0:v.vatOrNonVatRegistered):null,vatPercentage:(null===e||void 0===e||null===(b=e.data())||void 0===b?void 0:b.vatPercentage)||0,imageName:(null===e||void 0===e||null===(p=e.data())||void 0===p?void 0:p.imageName)||"",imageSig:(null===e||void 0===e||null===(g=e.data())||void 0===g?void 0:g.imageSig)||"",imageUrl:(null===e||void 0===e||null===(N=e.data())||void 0===N?void 0:N.imageUrl)||"",sigUrl:(null===e||void 0===e||null===(y=e.data())||void 0===y?void 0:y.sigUrl)||"",stampName:(null===e||void 0===e||null===(f=e.data())||void 0===f?void 0:f.stampName)||"",stampUrl:(null===e||void 0===e||null===(j=e.data())||void 0===j?void 0:j.stampUrl)||"",companyType:(null===e||void 0===e||null===(O=e.data())||void 0===O?void 0:O.companyType)||"",tan:(null===e||void 0===e||null===(k=e.data())||void 0===k?void 0:k.tan)||"",brn:(null===e||void 0===e||null===(h=e.data())||void 0===h?void 0:h.brn)||"",address:(null===e||void 0===e||null===(A=e.data())||void 0===A?void 0:A.address)||"",contactNumber:(null===e||void 0===e||null===(R=e.data())||void 0===R?void 0:R.contactNumber)||"",mobileNumber:(null===e||void 0===e||null===(S=e.data())||void 0===S?void 0:S.mobileNumber)||"",email:(null===e||void 0===e||null===(T=e.data())||void 0===T?void 0:T.email)||"",beneficiaryName:(null===e||void 0===e||null===(w=e.data())||void 0===w?void 0:w.beneficiaryName)||"",bankName:(null===e||void 0===e||null===(B=e.data())||void 0===B?void 0:B.bankName)||"",bankAccNo:(null===e||void 0===e||null===(x=e.data())||void 0===x?void 0:x.bankAccNo)||"",bankIban:(null===e||void 0===e||null===(C=e.data())||void 0===C?void 0:C.bankIban)||"",bankSwiftCode:(null===e||void 0===e||null===(U=e.data())||void 0===U?void 0:U.bankSwiftCode)||"",documentTemplate:(null===e||void 0===e||null===(M=e.data())||void 0===M?void 0:M.documentTemplate)||""}),i.push({id:e.id,name:e.data().name,data:Object(l.a)({},e.data())})))})),a.sort(Object(b.e)("name")),T(a),n(Object(s.d)(i)),n(Object(v.d)(!1))):(T([]),n(Object(s.d)([])),n(Object(v.d)(!1)))})).catch((function(e){a("Error occured while fetching companies: ".concat(null===e||void 0===e?void 0:e.message),{variant:"error"})}));case 4:e.next=7;break;case 6:a("Your session has been terminated due to greater than 30 minutes of inactivity. Please log in again.",{variant:"error"});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();w.current=z;var J=function(){U({name:"",vatPercentage:0,imageName:"",imageSig:"",imageUrl:"",sigUrl:"",stampName:"",stampUrl:"",companyType:"",vatOrNonVatRegistered:null,tan:"",address:"",email:"",contactNumber:"",mobileNumber:"",brn:"",beneficiaryName:"",bankName:"",bankAccNo:"",bankIban:"",bankSwiftCode:"",MRATemplateFlag:null,displayMRAFiscalisationButton:!1,documentTemplate:""}),I(!1)},L=function(){var e=Object(t.a)(c.a.mark((function e(l){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(Object(v.d)(!0)),e.next=3,u.b.collection("company").doc(l).delete().then(Object(t.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){for(var a=Object(i.a)(h),n=a.length,t=0,o=0;o<n;o++)a[o].id===l&&(t=o);a.splice(t,1),a.sort(Object(b.e)("name")),e(a)}));case 2:if(!(t=e.sent)){e.next=6;break}return e.next=6,u.b.collection("company").doc("companyIds").set({companyIdArray:t},{merge:!0}).then((function(){z(),a("Row deleted successfully",{variant:"success"}),n(Object(v.d)(!1))})).catch((function(e){a("Error occured while deleting company: ".concat(null===e||void 0===e?void 0:e.message),{variant:"error"}),n(Object(v.d)(!1))}));case 6:case"end":return e.stop()}}),e)})))).catch((function(e){a("Error occured while deleting company: ".concat(null===e||void 0===e?void 0:e.message),{variant:"error"}),n(Object(v.d)(!1))}));case 3:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}();return Object(f.jsxs)(p.a,{maxWidth:!e&&"xl",children:[Object(f.jsx)(r.Suspense,{fallback:Object(f.jsx)("p",{}),children:Object(f.jsx)(k,{type:"company",headers:[{id:"update",label:"Update"},{id:"delete",label:"Delete"},{id:"name",label:"Name"},{id:"MRATemplateFlag",label:"Apply MRA new template"},{id:"displayMRAFiscalisationButton",lable:"Display MRA Send Button"},{id:"vatOrNonVatRegistered",label:"VAT/Non-VAT Registered"},{id:"vatPercentage",label:"VAT_Percentage"},{id:"imageName",label:"Image_Logo"},{id:"imageSig",label:"Image_Sig."},{id:"stampName",label:"Stamp_Pic"},{id:"companyType",label:"Type"},{id:"tan",label:"VAT"},{id:"brn",label:"BRN"},{id:"address",label:"Address"},{id:"contactNumber",label:"Contact_Number"},{id:"mobileNumber",label:"Mobile_Number"},{id:"email",label:"Email"},{id:"beneficiaryName",label:"Beneficiary_Name"},{id:"bankName",label:"Bank_Name"},{id:"bankAccNo",label:"Bank_Account_No"},{id:"bankIban",label:"Bank IBAN"},{id:"bankSwiftCode",label:"Bank Swift Code"}],aCollection:S,addBtnDisplay:"super-admin"===(null===d||void 0===d?void 0:d.role),addBtnLabel:"Create a company",addBtnFunc:function(){E("add"),I(!0),U({name:"",vatPercentage:0,imageName:"",imageSig:"",imageUrl:"",sigUrl:"",stampName:"",stampUrl:"",companyType:"",vatOrNonVatRegistered:null,tan:"",address:"",email:"",contactNumber:"",mobileNumber:"",brn:"",beneficiaryName:"",bankName:"",bankAccNo:"",bankIban:"",bankSwiftCode:"",documentTemplate:"",MRATemplateFlag:null,displayMRAFiscalisationButton:!1})},openDialog:D,handleCloseDialog:J,emptyColMsg:"Sorry, not a single company has been created yet. Please create a company.",updateBtnDisplay:!0,deleteBtnDisplay:!0,updateBtnFunc:function(e,a){E("update"),I(!0),U({id:e,name:(null===a||void 0===a?void 0:a.name)||"",vatPercentage:(null===a||void 0===a?void 0:a.vatPercentage)||0,MRATemplateFlag:(null===a||void 0===a?void 0:a.MRATemplateFlag)||null,displayMRAFiscalisationButton:(null===a||void 0===a?void 0:a.displayMRAFiscalisationButton)||!1,vatOrNonVatRegistered:(null===a||void 0===a?void 0:a.vatOrNonVatRegistered)||null,imageName:(null===a||void 0===a?void 0:a.imageName)||"",imageSig:(null===a||void 0===a?void 0:a.imageSig)||"",imageUrl:(null===a||void 0===a?void 0:a.imageUrl)||"",sigUrl:(null===a||void 0===a?void 0:a.sigUrl)||"",stampName:(null===a||void 0===a?void 0:a.stampName)||"",stampUrl:(null===a||void 0===a?void 0:a.stampUrl)||"",companyType:(null===a||void 0===a?void 0:a.companyType)||"",tan:(null===a||void 0===a?void 0:a.tan)||"",address:(null===a||void 0===a?void 0:a.address)||"",email:(null===a||void 0===a?void 0:a.email)||"",contactNumber:(null===a||void 0===a?void 0:a.contactNumber)||"",mobileNumber:(null===a||void 0===a?void 0:a.mobileNumber)||"",brn:(null===a||void 0===a?void 0:a.brn)||"",beneficiaryName:(null===a||void 0===a?void 0:a.beneficiaryName)||"",bankName:(null===a||void 0===a?void 0:a.bankName)||"",bankAccNo:(null===a||void 0===a?void 0:a.bankAccNo)||"",bankIban:(null===a||void 0===a?void 0:a.bankIban)||"",bankSwiftCode:(null===a||void 0===a?void 0:a.bankSwiftCode)||"",documentTemplate:(null===a||void 0===a?void 0:a.documentTemplate)||""})},deleteBtnFunc:L})}),Object(f.jsx)("div",{children:_&&"add"===_?Object(f.jsx)(r.Suspense,{fallback:Object(f.jsx)("p",{}),children:Object(f.jsx)(j,{openDialog:D,handleCloseDialog:J,companyDetails:C,setCompanyDetails:U,initializeCompanies:z})}):Object(f.jsx)(r.Suspense,{fallback:Object(f.jsx)("p",{}),children:Object(f.jsx)(O,{openDialog:D,handleCloseDialog:J,companyDetails:C,setCompanyDetails:U,initializeCompanies:z})})})]})}}}]);
//# sourceMappingURL=94.afeed20e.chunk.js.map