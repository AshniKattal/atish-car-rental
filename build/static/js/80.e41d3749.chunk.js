(this["webpackJsonp@minimal/minimal-kit-react"]=this["webpackJsonp@minimal/minimal-kit-react"]||[]).push([[80],{1814:function(e,n,t){"use strict";t.r(n),t.d(n,"default",(function(){return W}));var a=t(9),r=t(27),c=t(6),i=t(18),o=t(3),l=t.n(o),s=t(1508),u=t(133),d=t(1491),b=t(145),j=t(286),h=t(1466),p=t(701),f=t(1465),m=t(1530),v=t(1531),x=t(1532),O=t(1533),y=t(1534),k=t(1485),g=t(287),w=t(640),L=t.n(w),S=t(118),C=t(52),D=t(68),I=t(1691),T=t(383),E=t.n(T),F=t(4),B=t(1690),P=t(1692),z=t.n(P),R=t(472),_=t(154),A=t(72),N=t(83),q=t(0);function W(){var e=Object(N.a)().themeStretch,n=Object(A.a)().user,t=Object(C.b)(),o=Object(S.b)().enqueueSnackbar,w=Object(C.c)(R.b).companyDetails,T=Object(C.c)(_.c).companyList,P=Object(F.useState)("All lines"),W=Object(i.a)(P,2),H=W[0],V=W[1],J=Object(F.useState)([]),M=Object(i.a)(J,2),U=M[0],Y=M[1],Z=Object(F.useState)([]),G=Object(i.a)(Z,2),K=G[0],Q=G[1],X=Object(F.useState)([]),$=Object(i.a)(X,2),ee=$[0],ne=$[1],te=Object(F.useState)(null),ae=Object(i.a)(te,2),re=ae[0],ce=ae[1],ie=Object(F.useState)(""),oe=Object(i.a)(ie,2),le=oe[0],se=oe[1],ue=Object(F.useState)(null),de=Object(i.a)(ue,2),be=de[0],je=de[1],he=Object(F.useRef)(null),pe=Object(F.useRef)(),fe=Object(F.useState)(!1),me=Object(i.a)(fe,2),ve=me[0],xe=me[1];Object(F.useEffect)((function(){pe.current()}),[w]),pe.current=function(){var e,t,a;w&&null!==w&&void 0!==w&&w.id&&(null!==n&&void 0!==n&&null!==(e=n.permissions)&&void 0!==e&&null!==(t=e.uploadBankStatementChk)&&void 0!==t&&null!==(a=t.assignedCompanyId)&&void 0!==a&&a.includes(null===w||void 0===w?void 0:w.id)?xe(!0):(o("You do not have the permission to upload bank statement",{variant:"error"}),xe(!1)))};var Oe=function(){var e=Object(c.a)(l.a.mark((function e(n){var a,r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(null===(a=n.target.files)||void 0===a?void 0:a.length)>0&&(t(Object(D.d)(!0)),r=n.target.files[0],je(r),(c=new FileReader).onload=function(){var e=c.result,n=btoa(e);ye(n,null===r||void 0===r?void 0:r.name)},c.readAsBinaryString(r));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),ye=function(e,n){var a={Parameters:[{Name:"File",FileValue:{Name:n,Data:e}},{Name:"SingleSheet",Value:!0}]};L.a.post("https://v2.convertapi.com/convert/pdf/to/xlsx?Secret=".concat("13cZcSaMcOWpV9lI"),a,{headers:{"Content-Type":"application/json"}}).then((function(e){console.log(e),function(e){var n=E.a.toByteArray(e),a=I.a(n,{type:"array"}),r=a.SheetNames[0],c=a.Sheets[r],i={header:1,defval:"",raw:!1,dateNF:"dd/mm/yyyy"},o=I.b.sheet_to_json(c,i).map((function(e){return e.map((function(e){return e instanceof Date?e.toISOString().split("T")[0]:e}))})),l=[];o.forEach((function(e){l.push({checked:!0,columns:e})}));var s,u,d=[];if((null===l||void 0===l?void 0:l.length)>0&&(null===(s=l[0])||void 0===s||null===(u=s.columns)||void 0===u?void 0:u.length)>0){var b;null===(b=l[0])||void 0===b||b.columns.forEach((function(){d.push({checked:!0})})),ne(d)}Q(l),Y(l),t(Object(D.d)(!1))}(e.data.Files[0].FileData)})).catch((function(e){var n=e.response.data.Message;o("Error occured while converting pdf: ".concat(n),{variant:"error"}),t(Object(D.d)(!1))}))};function ke(e,n,t){var c="mainCol"===t?Object(r.a)(ee):"row"===t?Object(r.a)(K):[];c[n]=Object(a.a)(Object(a.a)({},c[n]),{},{checked:e}),"mainCol"===t?ne(c):"row"===t&&Q(c)}var ge=function(){var e=Object(c.a)(l.a.mark((function e(){var n,t,a,r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,we(ee,K);case 2:n=e.sent,t=I.b.aoa_to_sheet(n),a=I.b.book_new(),I.b.book_append_sheet(a,t,"Sheet1"),r=I.c(a,{bookType:"xlsx",type:"array"}),c=new Blob([r],{type:"application/octet-stream"}),Object(B.saveAs)(c,"".concat(null===be||void 0===be?void 0:be.name,".xlsx"));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function we(e,n){return Le.apply(this,arguments)}function Le(){return(Le=Object(c.a)(l.a.mark((function e(n,t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){for(var a=[],r=null===t||void 0===t?void 0:t.length,c=null===n||void 0===n?void 0:n.length,i=0;i<r;i++){var o;if(null!==(o=t[i])&&void 0!==o&&o.checked){for(var l=[],s=0;s<c;s++){var u,d;if(null!==(u=n[s])&&void 0!==u&&u.checked)l.push(null===(d=t[i])||void 0===d?void 0:d.columns[s])}a.push([].concat(l))}}e(a)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Se(){return(Se=Object(c.a)(l.a.mark((function e(n,t,a){var c,i,o,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),"removeOption"===a||"clear"===a||!t){e.next=21;break}if(i=[],"Lines with DEBIT only"!==t){e.next=9;break}return e.next=6,Ie(U,4);case 6:i=e.sent,e.next=16;break;case 9:if("Lines with CREDIT only"!==t){e.next=15;break}return e.next=12,Ie(U,5);case 12:i=e.sent,e.next=16;break;case 15:i=Object(r.a)(U);case 16:(null===(c=i)||void 0===c?void 0:c.length)>0&&re&&(i=i.filter((function(e){return e.columns[2]&&e.columns[2].includes(re)}))),V(t),Q(i),e.next=22;break;case 21:"removeOption"!==a&&"clear"!==a||(s=[],s=Object(r.a)(U),(null===(o=s)||void 0===o?void 0:o.length)>0&&re&&(s=s.filter((function(e){return e.columns[2]&&e.columns[2].includes(re)}))),V(t),Q(s));case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ce(){return(Ce=Object(c.a)(l.a.mark((function e(n,t,a){var c,i,o,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),"removeOption"===a||"clear"===a||!t){e.next=19;break}if(i=[],i=U.filter((function(e){return e.columns[2]&&e.columns[2].includes(t)})),!((null===(c=i)||void 0===c?void 0:c.length)>0&&H)){e.next=15;break}if("Lines with DEBIT only"!==H){e.next=11;break}return e.next=8,Ie(i,4);case 8:i=e.sent,e.next=15;break;case 11:if("Lines with CREDIT only"!==H){e.next=15;break}return e.next=14,Ie(i,5);case 14:i=e.sent;case 15:Q(i),ce(t),e.next=35;break;case 19:if("removeOption"!==a&&"clear"!==a){e.next=35;break}if(s=[],s=Object(r.a)(U),!((null===(o=s)||void 0===o?void 0:o.length)>0&&H)){e.next=33;break}if("Lines with DEBIT only"!==H){e.next=29;break}return e.next=26,Ie(s,4);case 26:s=e.sent,e.next=33;break;case 29:if("Lines with CREDIT only"!==H){e.next=33;break}return e.next=32,Ie(s,5);case 32:s=e.sent;case 33:Q(s),ce(t);case 35:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function De(){return(De=Object(c.a)(l.a.mark((function e(){var n,t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(V("ALL Lines"),ce(null),le){e.next=6;break}Q(Object(r.a)(U)),e.next=20;break;case 6:if(t=[],t=U.filter((function(e){return e.columns[2]&&e.columns[2].toLowerCase().includes(le.toLowerCase())})),!((null===(n=t)||void 0===n?void 0:n.length)>0&&H)){e.next=19;break}if("Lines with DEBIT only"!==H){e.next=15;break}return e.next=12,Ie(t,4);case 12:t=e.sent,e.next=19;break;case 15:if("Lines with CREDIT only"!==H){e.next=19;break}return e.next=18,Ie(t,5);case 18:t=e.sent;case 19:Q(t);case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ie(e,n){return Te.apply(this,arguments)}function Te(){return(Te=Object(c.a)(l.a.mark((function e(n,t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){e(n.filter((function(e){return""!==e.columns[t]&&void 0!==e.columns[t]&&Number(e.columns[t])>=0})))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ee=function(){var e=Object(c.a)(l.a.mark((function e(n,a,r,c){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),"removeOption"!==r&&"clear"!==r&&a?"company"===c&&(t(Object(R.g)(a.id)),t(Object(R.f)(a))):"removeOption"!==r&&"clear"!==r||"company"===c&&(t(Object(R.g)(void 0)),t(Object(R.f)(null)));case 2:case"end":return e.stop()}}),e)})));return function(n,t,a,r){return e.apply(this,arguments)}}();return Object(q.jsx)(q.Fragment,{children:Object(q.jsx)(g.a,{title:"Document",children:Object(q.jsx)(s.a,{maxWidth:!e&&"xl",children:Object(q.jsxs)(u.a,{container:!0,spacing:3,children:[Object(q.jsx)(u.a,{item:!0,xs:12,md:4,children:Object(q.jsx)(d.a,{ListboxProps:{style:{maxHeight:"70vh"}},size:"small",label:"Please choose a company",id:"company-drop-down",options:T||[],value:w||null,renderInput:function(e){return Object(q.jsx)(b.a,Object(a.a)(Object(a.a)({},e),{},{label:"Please choose a company",InputLabelProps:{required:!0}}))},required:!0,onChange:function(e,n,t){return Ee(e,n,t,"company")},getOptionLabel:function(e){return(null===e||void 0===e?void 0:e.name)||""}})}),w&&ve?Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)(u.a,{item:!0,xs:12,md:12,children:Object(q.jsx)(j.a,{children:"Import bank statement pdf"})}),Object(q.jsxs)(u.a,{item:!0,xs:12,md:3,children:[Object(q.jsxs)(h.a,{spacing:2,children:[Object(q.jsx)(j.a,{children:"Upload bank statement"}),Object(q.jsx)(p.a,{variant:"contained",onClick:function(){he.current.click()},children:"Upload file"})]}),Object(q.jsx)("input",{type:"file",ref:he,style:{display:"none"},onChange:Oe})]}),U&&(null===U||void 0===U?void 0:U.length)>0?Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)(u.a,{item:!0,xs:12,md:12,children:Object(q.jsx)(f.a,{})}),Object(q.jsx)(u.a,{item:!0,xs:12,md:12,children:Object(q.jsx)("div",{align:"right",children:Object(q.jsx)(p.a,{variant:"contained",color:"primary",onClick:function(){return ge()},startIcon:Object(q.jsx)(z.a,{}),children:"Download as Excel"})})}),Object(q.jsx)(u.a,{item:!0,xs:12,md:5,children:Object(q.jsxs)(u.a,{container:!0,spacing:2,children:[Object(q.jsx)(u.a,{item:!0,xs:12,md:8,children:Object(q.jsx)(b.a,{variant:"outlined",name:"searchTransactionText",label:"Search transaction",id:"searchTransactionText",type:"text",value:le||"",size:"small",fullWidth:!0,onChange:function(e){return se(e.target.value)}})}),Object(q.jsx)(u.a,{item:!0,xs:12,md:4,children:Object(q.jsx)(p.a,{variant:"contained",color:"primary",onClick:function(){return function(){return De.apply(this,arguments)}()},children:"Search"})})]})}),Object(q.jsx)(u.a,{item:!0,xs:12,md:4,children:Object(q.jsx)(d.a,{ListboxProps:{style:{maxHeight:"70vh"}},size:"small",label:"Search transaction",id:"search-transaction-drop-down",options:K&&(null===K||void 0===K?void 0:K.length)>0?K.map((function(e){return""!==e.columns[2]})):[],value:re||null,renderInput:function(e){return Object(q.jsx)(b.a,Object(a.a)(Object(a.a)({},e),{},{label:"Search transaction",required:!0}))},onChange:function(e,n,t){return function(e,n,t){return Ce.apply(this,arguments)}(e,n,t)},getOptionLabel:function(e){return e||""},renderOption:function(e,n){return Object(F.createElement)("li",Object(a.a)(Object(a.a)({},e),{},{key:null===n||void 0===n?void 0:n.id}),Object(q.jsx)("span",{children:(null===n||void 0===n?void 0:n.name)||""}))},fullWidth:!0})}),Object(q.jsx)(u.a,{item:!0,xs:12,md:3,children:Object(q.jsx)(d.a,{ListboxProps:{style:{maxHeight:"70vh"}},size:"small",label:"Lines to display",id:"lines-display-drop-down",options:["All lines","Lines with DEBIT only","Lines with CREDIT only"],value:H||null,renderInput:function(e){return Object(q.jsx)(b.a,Object(a.a)(Object(a.a)({},e),{},{label:"Lines to display",required:!0}))},onChange:function(e,n,t){return function(e,n,t){return Se.apply(this,arguments)}(e,n,t)},getOptionLabel:function(e){return e||""},fullWidth:!0})}),Object(q.jsx)(u.a,{item:!0,xs:12,md:12,children:Object(q.jsx)(m.a,{children:Object(q.jsx)(v.a,{border:1,children:Object(q.jsxs)(x.a,{children:[Object(q.jsxs)(O.a,{children:[Object(q.jsx)(y.a,{size:"small"}),null===ee||void 0===ee?void 0:ee.map((function(e,n){return Object(q.jsx)(y.a,{size:"small",align:"center",children:Object(q.jsx)(k.a,{checked:null===e||void 0===e?void 0:e.checked,color:"primary",onChange:function(e){return ke(e.target.checked,n,"mainCol")}})},n)}))]}),K&&(null===K||void 0===K?void 0:K.length)>0&&(null===K||void 0===K?void 0:K.map((function(e,n){var t,a;return Object(q.jsx)(O.a,{children:e&&(null===e||void 0===e||null===(t=e.columns)||void 0===t?void 0:t.length)>0?Object(q.jsxs)(F.Fragment,{children:[Object(q.jsx)(y.a,{size:"small",align:"left",children:Object(q.jsx)(k.a,{checked:null===e||void 0===e?void 0:e.checked,color:"primary",onChange:function(e){return ke(e.target.checked,n,"row")}})}),null===e||void 0===e||null===(a=e.columns)||void 0===a?void 0:a.map((function(e,n){return Object(q.jsx)(F.Fragment,{children:Object(q.jsx)(y.a,{size:"small",align:"left",children:e})},n)}))]},n):Object(q.jsx)(F.Fragment,{},n)},n)})))]})})})})]}):Object(q.jsx)(q.Fragment,{})]}):Object(q.jsx)(q.Fragment,{})]})})})})}}}]);
//# sourceMappingURL=80.e41d3749.chunk.js.map