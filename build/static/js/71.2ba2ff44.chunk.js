(this["webpackJsonp@minimal/minimal-kit-react"]=this["webpackJsonp@minimal/minimal-kit-react"]||[]).push([[71],{1768:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return Z}));var i=n(27),o=n(9),c=n(6),a=n(18),d=n(3),l=n.n(d),r=n(1398),s=n(1406),u=n(1413),v=n(133),j=n(286),b=n(1466),h=n(145),O=n(1530),m=n(1531),x=n(1535),f=n(1533),p=n(1534),g=n(1532),D=n(1499),T=n(701),w=n(1414),S=n(69),y=n.n(S),k=n(52),z=n(472),I=n(46),C=n(250),A=n(4),F=n(49),M=n(68),q=n(118),E=n(1844),P=n(134),Y=n(0);function Z(e){var t=e.open,n=e.type,d=e.setType,S=e.setOpen,Z=e.logo,_=e.sigImage,B=e.documentDetails,J=e.setDocumentDetails,V=e.set_us_doc_number,W=Object(q.b)().enqueueSnackbar,N=Object(k.b)(),Q=Object(A.useRef)(),R=Object(k.c)(z.b),G=R.companyDetails,H=R.clientDocumentObjectSelected,K=Object(A.useState)(new Date),L=Object(a.a)(K,2),U=L[0],X=L[1],$=Object(A.useState)(new Date),ee=Object(a.a)($,2),te=ee[0],ne=ee[1],ie=Object(A.useState)([]),oe=Object(a.a)(ie,2),ce=oe[0],ae=oe[1],de=Object(A.useState)(""),le=Object(a.a)(de,2),re=le[0],se=le[1];function ue(){return(ue=Object(c.a)(l.a.mark((function e(){var t,i,o,c,a,d;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===U||""===U||void 0===te||""===te){e.next=18;break}if(!(new Date(U)>new Date(te))){e.next=6;break}W("Date incorrect. To Date cannot be before From Date.",{variant:"error"}),N(Object(M.d)(!1)),e.next=16;break;case 6:if(void 0===G||void 0===H){e.next=16;break}return N(Object(M.d)(!0)),t=U.toISOString(),i=t.split("T"),o=te.toISOString(),c=o.split("T"),a=new Date("".concat(i[0],"T00:00:00.000Z")),d=new Date("".concat(c[0],"T23:59:59.000Z")),e.next=16,F.b.collection("company").doc(null===G||void 0===G?void 0:G.id).collection(n).where("docDate",">=",P.a.firestore.Timestamp.fromDate(a)).where("docDate","<=",P.a.firestore.Timestamp.fromDate(d)).get().then((function(e){var t,n=[];(null===e||void 0===e||null===(t=e.docs)||void 0===t?void 0:t.length)>0?(null===e||void 0===e||e.docs.forEach((function(e){var t,i,o;(null===e||void 0===e||null===(t=e.data())||void 0===t?void 0:t.clientId)!==(null===H||void 0===H?void 0:H.id)||null!==e&&void 0!==e&&null!==(i=e.data())&&void 0!==i&&i.deleted||n.push({id:null===e||void 0===e?void 0:e.id,docString:null===e||void 0===e||null===(o=e.data())||void 0===o?void 0:o.docString,data:null===e||void 0===e?void 0:e.data(),checked:!1})})),25===(null===n||void 0===n?void 0:n.length)&&se(!0),n.sort(Object(C.e)("docString")),ae(n)):ae([]),N(Object(M.d)(!1))})).catch((function(e){W("Error occured while fetching documents: ".concat(null===e||void 0===e?void 0:e.message),{variant:"error"}),N(Object(M.d)(!1))}));case 16:e.next=19;break;case 18:N(Object(M.d)(!1));case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ve(){return(ve=Object(c.a)(l.a.mark((function e(){var t,o,c,a,d,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N(Object(M.d)(!0)),t=U.toISOString(),o=t.split("T"),c=te.toISOString(),a=c.split("T"),d=new Date("".concat(o[0],"T00:00:00.000Z")),r=new Date("".concat(a[0],"T23:59:59.000Z")),e.next=9,F.b.collection("company").doc(null===G||void 0===G?void 0:G.id).collection(n).where("docDate",">=",P.a.firestore.Timestamp.fromDate(d)).where("docDate","<=",P.a.firestore.Timestamp.fromDate(r)).startAfter(re).limit(25).get().then((function(e){var t,n=[];if((null===e||void 0===e||null===(t=e.docs)||void 0===t?void 0:t.length)>0){null===e||void 0===e||e.docs.forEach((function(e){var t,i;(null===e||void 0===e||null===(t=e.data())||void 0===t?void 0:t.clientId)!==(null===H||void 0===H?void 0:H.id)||null!==e&&void 0!==e&&null!==(i=e.data())&&void 0!==i&&i.deleted||n.push({id:null===e||void 0===e?void 0:e.id,data:null===e||void 0===e?void 0:e.data(),checked:!1})})),25===(null===n||void 0===n?void 0:n.length)?se(!0):se(!1);var o=[].concat(Object(i.a)(ce),n);ae(o),N(Object(M.d)(!1))}else se(!1),N(Object(M.d)(!1))})).catch((function(e){W("Error occured while fetching documents: ".concat(null===e||void 0===e?void 0:e.message),{variant:"error"}),N(Object(M.d)(!1))}));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(A.useEffect)((function(){Q.current()}),[U,te]),Q.current=function(){return ue.apply(this,arguments)},Object(Y.jsxs)(r.a,{open:t,onClose:function(){return S(!1)},maxWidth:"md",fullWidth:!0,children:[Object(Y.jsx)(s.a,{children:"quotation"===n?"Associate a quotation number to current document":"purchase_order"===n?"Associate a purchase order number to current document":""}),Object(Y.jsxs)(u.a,{children:[Object(Y.jsx)("br",{}),Object(Y.jsxs)(v.a,{container:!0,spacing:3,children:[Object(Y.jsxs)(v.a,{item:!0,xs:12,md:12,children:[Object(Y.jsx)("hr",{}),Object(Y.jsx)("br",{}),Object(Y.jsx)(j.a,{children:"Please choose a date"})]}),Object(Y.jsx)(v.a,{item:!0,xs:12,md:12,style:{width:"100%"},children:Object(Y.jsxs)(b.a,{direction:"row",spacing:3,alignItems:"center",children:[Object(Y.jsx)(E.a,{label:"From",value:U||"",onChange:function(e){X(e)},renderInput:function(e){return Object(Y.jsx)(h.a,Object(o.a)(Object(o.a)({},e),{},{size:"small"}))},inputFormat:"dd/MM/yyyy"}),Object(Y.jsx)(E.a,{label:"To",value:te||"",onChange:function(e){ne(e)},renderInput:function(e){return Object(Y.jsx)(h.a,Object(o.a)(Object(o.a)({},e),{},{size:"small"}))},inputFormat:"dd/MM/yyyy"})]})}),Object(Y.jsx)(v.a,{item:!0,xs:12,md:12,children:Object(Y.jsx)(O.a,{children:Object(Y.jsxs)(m.a,{border:1,children:[Object(Y.jsx)(x.a,{children:Object(Y.jsxs)(f.a,{children:[Object(Y.jsx)(p.a,{size:"small",children:"quotation"===n?"Quote number":"P.O number"}),Object(Y.jsx)(p.a,{size:"small",children:"Date created"}),Object(Y.jsx)(p.a,{size:"small",children:"Preview"}),Object(Y.jsx)(p.a,{size:"small",children:"Action"})]})}),Object(Y.jsxs)(g.a,{children:[ce&&(null===ce||void 0===ce?void 0:ce.length)>0&&(null===ce||void 0===ce?void 0:ce.map((function(e,t){var n,i,c;return Object(Y.jsxs)(f.a,{children:[Object(Y.jsx)(p.a,{size:"small",children:Object(Y.jsx)(j.a,{children:null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.docString})}),Object(Y.jsx)(p.a,{size:"small",children:Object(Y.jsx)(j.a,{children:null!==e&&void 0!==e&&null!==(i=e.data)&&void 0!==i&&i.docDate&&y()(null===e||void 0===e||null===(c=e.data)||void 0===c?void 0:c.docDate.toDate()).format("DD-MM-YYYY")||""})}),Object(Y.jsx)(p.a,{size:"small",align:"center",children:Object(Y.jsx)(D.a,{variant:"contained",color:"primary",onClick:function(){return Object(C.n)(G,H,e,Z,_,"view")},children:Object(Y.jsx)(I.a,{icon:"carbon:view"})})}),Object(Y.jsx)(p.a,{size:"small",children:Object(Y.jsx)(T.a,{variant:"contained",color:"primary",onClick:function(){return t=null===e||void 0===e?void 0:e.data,void(H&&(null===H||void 0===H?void 0:H.id)!==(null===t||void 0===t?void 0:t.clientId)?W("The quotation number you have selected does not match with the client you have selected above.",{variant:"error"}):(V((null===t||void 0===t?void 0:t.docString)||""),d(""),S(!1),J(Object(o.a)(Object(o.a)({},B),{},{docBillTo:(null===t||void 0===t?void 0:t.docBillTo)||(null===B||void 0===B?void 0:B.docBillTo)||"",docShipTo:(null===t||void 0===t?void 0:t.docShipTo)||(null===B||void 0===B?void 0:B.docShipTo)||"",docParticulars:(null===t||void 0===t?void 0:t.docParticulars)||[],docSubTotal:(null===t||void 0===t?void 0:t.docSubTotal)||0,docTotal:(null===t||void 0===t?void 0:t.docTotal)||0,docVatFee:(null===t||void 0===t?void 0:t.docVatFee)||0,docTermsAndCondition:(null===t||void 0===t?void 0:t.docTermsAndCondition)||(null===B||void 0===B?void 0:B.docTermsAndCondition)||""}))));var t},children:"select"})})]},t)}))),re?Object(Y.jsx)(f.a,{children:Object(Y.jsx)(p.a,{size:"small",colSpan:4,children:Object(Y.jsx)(T.a,{variant:"contained",color:"primary",onClick:function(){return function(){return ve.apply(this,arguments)}()},children:"Next"})})}):Object(Y.jsx)(Y.Fragment,{})]})]})})})]})]}),Object(Y.jsx)(w.a,{children:Object(Y.jsx)(T.a,{variant:"contained",color:"error",onClick:function(){return S(!1)},children:"cancel"})})]})}}}]);
//# sourceMappingURL=71.2ba2ff44.chunk.js.map