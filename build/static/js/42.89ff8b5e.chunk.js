/*! For license information please see 42.89ff8b5e.chunk.js.LICENSE.txt */
(this["webpackJsonp@minimal/minimal-kit-react"]=this["webpackJsonp@minimal/minimal-kit-react"]||[]).push([[42],{1751:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return N}));var i=n(9),a=n(6),o=n(18),r=n(3),c=n.n(r),s=n(1398),l=n(1406),u=n(1413),d=n(1465),h=n(133),p=n(1491),v=n(145),f=n(1466),g=n(286),m=n(471),b=n(701),j=n(1414),x=n(118),y=n(4),_=n(52),O=n(1752),w=n.n(O),D=n(68),P=n(134),C=n(49),E=n(69),S=n.n(E),k=n(72),M=n(250),R=n(1844),T=n(0),U=Object(y.lazy)((function(){return Promise.all([n.e(2),n.e(41)]).then(n.bind(null,1773))})),L=Object(y.lazy)((function(){return n.e(85).then(n.bind(null,1767))}));function N(t){var e,n=t.dialogType,r=t.openDialog,O=t.handleCloseDialog,E=t.surveyDetail,N=t.setSurveyDetail,B=t.fetchClientSurvey,W=t.companyId,z=t.documentType,I=t.clientList,A=t.logo,F=t.companyDetails,Y=Object(k.a)().user,q=Object(_.b)(),H=Object(x.b)().enqueueSnackbar,V=Object(y.useState)(null),G=Object(o.a)(V,2),J=G[0],X=G[1],K=Object(y.useState)(!1),Q=Object(o.a)(K,2),Z=Q[0],$=Q[1],tt=Object(y.useState)(null),et=Object(o.a)(tt,2),nt=et[0],it=et[1],at=Object(y.useState)(null),ot=Object(o.a)(at,2),rt=ot[0],ct=ot[1],st=Object(y.useState)(!1),lt=Object(o.a)(st,2),ut=lt[0],dt=lt[1],ht=Object(y.useState)(!1),pt=Object(o.a)(ht,2),vt=pt[0],ft=pt[1],gt=Object(y.useRef)(),mt=Object(y.useRef)();Object(y.useEffect)((function(){gt.current()}),[n,nt]),Object(y.useEffect)((function(){mt.current()}),[n,rt]),gt.current=function(){if(nt&&!ut&&"update"===n&&null!==E&&void 0!==E&&E.preparedBy){var t=nt.getCanvas(),e=t.getContext("2d"),i=new Image;i.crossOrigin="anonymous",i.src=null===E||void 0===E?void 0:E.preparedBy,i.onload=function(){var n=Math.min(t.width/i.width,t.height/i.height),a=i.width*n,o=i.height*n,r=t.width-a,c=t.height-o;e.drawImage(i,r,c,a,o);var s=t.toDataURL();nt.clear(),nt.fromDataURL(s),dt(!0)}}},mt.current=function(){if(rt&&!vt&&"update"===n&&null!==E&&void 0!==E&&E.clientSig){var t=rt.getCanvas(),e=t.getContext("2d"),i=new Image;i.crossOrigin="anonymous",i.src=null===E||void 0===E?void 0:E.clientSig,i.onload=function(){var n=Math.min(t.width/i.width,t.height/i.height),a=i.width*n,o=i.height*n,r=t.width-a,c=t.height-o;e.drawImage(i,r,c,a,o);var s=t.toDataURL();rt.clear(),rt.fromDataURL(s),ft(!0)}}};function bt(){return bt=Object(a.a)(c.a.mark((function t(){var e,n,o,r,s;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:q(Object(D.d)(!0)),xt()?(e=Object(i.a)({clientId:(null===J||void 0===J?void 0:J.id)||"",createdByUserId:(null===Y||void 0===Y?void 0:Y.id)||"",createdByUserEmail:(null===Y||void 0===Y?void 0:Y.email)||""},E),n=nt.getTrimmedCanvas().toDataURL("image/png"),o=rt.getTrimmedCanvas().toDataURL("image/png"),r=C.e.ref().child("survey/signatures/".concat(S()(new Date).format("DD-MM-YYYY"),"/").concat(W,"/").concat(null===E||void 0===E?void 0:E.customerName,"/signature_prepared_by_").concat(Date.now(),".png")),s=C.e.ref().child("survey/signatures/".concat(S()(new Date).format("DD-MM-YYYY"),"/").concat(W,"/").concat(null===E||void 0===E?void 0:E.customerName,"/signature_client_").concat(Date.now(),".png")),r.putString(n,"data_url").then((function(){console.log("Uploaded a prepared by data_url string!"),r.getDownloadURL().then((function(t){e=Object(i.a)(Object(i.a)({},e),{},{preparedBy:t}),s.putString(o,"data_url").then((function(){console.log("Uploaded a client by data_url string!"),s.getDownloadURL().then(function(){var t=Object(a.a)(c.a.mark((function t(n){var o,r;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=Object(i.a)(Object(i.a)({},e),{},{clientSig:n}),o=null===z||void 0===z?void 0:z.id,r=C.b.collection("company").doc(W).collection(o).doc("documentIndex"),C.b.runTransaction((function(t){return t.get(r).then((function(e){if(!e.exists)return t.update(r,{documentIndex:1}),1;var n=Number(e.data().documentIndex)+1;return t.update(r,{documentIndex:n}),n}))})).then(function(){var t=Object(a.a)(c.a.mark((function t(n){var a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(M.h)(n);case 2:if(!(a=t.sent)){t.next=6;break}return t.next=6,C.b.collection("company").doc(W).collection(o).doc(a).set(Object(i.a)(Object(i.a)({},e),{},{status:"Pending",dateCreated:P.a.firestore.Timestamp.fromDate(new Date)}),{merge:!0}).then((function(){H("".concat(null===z||void 0===z?void 0:z.title," recorded successfully")),B(W,o),O(),q(Object(D.d)(!1))})).catch((function(t){H("Error occured while saving ".concat(null===z||void 0===z?void 0:z.title,": ").concat(null===t||void 0===t?void 0:t.message),{variant:"error"}),q(Object(D.d)(!1))}));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){H("Error occured while overall Invoice saving transactions: ".concat(null===t||void 0===t?void 0:t.message),{variant:"error"}),q(Object(D.d)(!1))}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())})).catch((function(t){H("Error occured while uploading signature of client: ".concat(null===t||void 0===t?void 0:t.message),{variant:"error"}),q(Object(D.d)(!1))}))}))})).catch((function(t){H("Error occured while uploading signature of prepared by: ".concat(null===t||void 0===t?void 0:t.message),{variant:"error"}),q(Object(D.d)(!1))}))):(H("Please check if all required fields have been filled correctly",{variant:"error"}),q(Object(D.d)(!1)));case 2:case"end":return t.stop()}}),t)}))),bt.apply(this,arguments)}function jt(){return jt=Object(a.a)(c.a.mark((function t(){var e,n,o,r,s;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:q(Object(D.d)(!0)),xt()?(e=Object(i.a)({clientId:(null===J||void 0===J?void 0:J.id)||"",updatedByUserId:(null===Y||void 0===Y?void 0:Y.id)||"",updatedByUserEmail:(null===Y||void 0===Y?void 0:Y.email)||""},E),n=nt.getTrimmedCanvas().toDataURL("image/png"),o=rt.getTrimmedCanvas().toDataURL("image/png"),r=C.e.ref().child("survey/signatures/".concat(S()(new Date).format("DD-MM-YYYY"),"/").concat(W,"/").concat(null===E||void 0===E?void 0:E.customerName,"/signature_prepared_by_").concat(Date.now(),".png")),s=C.e.ref().child("survey/signatures/".concat(S()(new Date).format("DD-MM-YYYY"),"/").concat(W,"/").concat(null===E||void 0===E?void 0:E.customerName,"/signature_client_").concat(Date.now(),".png")),r.putString(n,"data_url").then((function(){console.log("Uploaded a prepared by data_url string!"),r.getDownloadURL().then((function(t){e=Object(i.a)(Object(i.a)({},e),{},{preparedBy:t}),s.putString(o,"data_url").then((function(){console.log("Uploaded a client by data_url string!"),s.getDownloadURL().then(function(){var t=Object(a.a)(c.a.mark((function t(n){var a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Object(i.a)(Object(i.a)({},e),{},{clientSig:n}),a=null===z||void 0===z?void 0:z.id,t.next=4,C.b.collection("company").doc(W).collection(a).doc(null===E||void 0===E?void 0:E.id).set(Object(i.a)({},e),{merge:!0}).then((function(){H("".concat(null===z||void 0===z?void 0:z.title," updated successfully")),B(W,a),O(),q(Object(D.d)(!1))})).catch((function(t){H("Error occured while updating ".concat(null===z||void 0===z?void 0:z.title,": ").concat(null===t||void 0===t?void 0:t.message),{variant:"error"}),q(Object(D.d)(!1))}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())})).catch((function(t){H("Error occured while uploading signature of client: ".concat(null===t||void 0===t?void 0:t.message),{variant:"error"}),q(Object(D.d)(!1))}))}))})).catch((function(t){H("Error occured while uploading signature of prepared by: ".concat(null===t||void 0===t?void 0:t.message),{variant:"error"}),q(Object(D.d)(!1))}))):(H("Please check if all required fields have been filled correctly",{variant:"error"}),q(Object(D.d)(!1)));case 2:case"end":return t.stop()}}),t)}))),jt.apply(this,arguments)}function xt(){return!(null===E||void 0===E||!E.customerName||null===E||void 0===E||!E.address)}return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsxs)(s.a,{fullWidth:!0,maxWidth:"lg",open:r,children:[Object(T.jsx)(l.a,{children:"".concat("update"===n?"Update":"Add new"," ").concat(null===z||void 0===z?void 0:z.title)}),Object(T.jsxs)(u.a,{children:[Object(T.jsx)(d.a,{sx:{borderStyle:"dotted"}}),Object(T.jsx)("br",{}),"update"===n?Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(h.a,{container:!0,spacing:3,children:Object(T.jsx)(h.a,{item:!0,xs:12,md:4,children:Object(T.jsx)(p.a,{ListboxProps:{style:{maxHeight:"70vh"}},size:"small",label:"Update status",id:"status-drop-down",options:["Pending","Confirmed","Rejected"],value:(null===E||void 0===E?void 0:E.status)||null,sx:{width:300},renderInput:function(t){return Object(T.jsx)(v.a,Object(i.a)(Object(i.a)({},t),{},{label:"Update status",InputLabelProps:{required:!0},size:"large"}))},required:!0,onChange:function(t,e,n){t.preventDefault(),"removeOption"!==n&&"clear"!==n&&e?N((function(t){return Object(i.a)(Object(i.a)({},t),{},{status:e})})):"removeOption"!==n&&"clear"!==n||N((function(t){return Object(i.a)(Object(i.a)({},t),{},{status:null})}))},getOptionLabel:function(t){return t}})})}),Object(T.jsx)("br",{}),Object(T.jsx)(d.a,{sx:{borderStyle:"dotted"}}),Object(T.jsx)("br",{})]}):Object(T.jsx)(T.Fragment,{}),"Contract Agreement"===(null===z||void 0===z?void 0:z.title)?Object(T.jsx)(y.Suspense,{fallback:Object(T.jsx)(T.Fragment,{}),children:Object(T.jsx)(U,{clientList:I,clientDocumentObjectSelected:J,setClientDocumentObjectSelected:X,companyId:W,dialogType:n,surveyDetail:E,setSurveyDetail:N,logo:A,companyDetails:F})}):Object(T.jsx)(y.Suspense,{fallback:Object(T.jsx)(T.Fragment,{}),children:Object(T.jsx)(L,{clientList:I,clientDocumentObjectSelected:J,setClientDocumentObjectSelected:X,setSurveyDetail:N,surveyDetail:E,dialogType:n,documentType:z})}),Object(T.jsx)("br",{}),Object(T.jsx)("br",{}),Object(T.jsx)(d.a,{sx:{borderStyle:"dotted"}}),Object(T.jsx)("br",{}),Object(T.jsxs)(h.a,{container:!0,spacing:3,children:["Contract Agreement"===(null===z||void 0===z?void 0:z.title)?Object(T.jsx)(h.a,{item:!0,xs:12,md:12,children:Object(T.jsx)(h.a,{container:!0,spacing:3,children:Object(T.jsx)(h.a,{item:!0,xs:12,md:4,children:Object(T.jsx)(R.a,{label:"Signature date",value:null!==E&&void 0!==E&&null!==(e=E.signatureDate)&&void 0!==e&&e.seconds?new Date(null===E||void 0===E?void 0:E.signatureDate.toDate()):null!==E&&void 0!==E&&E.signatureDate?null===E||void 0===E?void 0:E.signatureDate:"",onChange:function(t){N((function(e){return Object(i.a)(Object(i.a)({},e),{},{signatureDate:t})}))},renderInput:function(t){return Object(T.jsx)(v.a,Object(i.a)(Object(i.a)({},t),{},{size:"large"}))},inputFormat:"dd/MM/yyyy"})})})}):Object(T.jsx)(T.Fragment,{}),Object(T.jsx)(h.a,{item:!0,xs:12,md:6,children:"view"===n?Object(T.jsxs)(f.a,{spacing:3,children:[Object(T.jsx)(g.a,{children:"PREPARED BY: ".concat((null===E||void 0===E?void 0:E.preparedByName)||"")}),Object(T.jsx)("div",{children:Object(T.jsx)("img",{src:(null===E||void 0===E?void 0:E.preparedBy)||"",alt:"signaturePreparedBy"})})]}):Object(T.jsxs)(f.a,{spacing:3,children:[Object(T.jsx)(v.a,{variant:"outlined",name:"preparedByName",label:"PREPARED BY",id:"preparedByName",type:"text",value:(null===E||void 0===E?void 0:E.preparedByName)||"",size:"large",fullWidth:!0,onChange:function(t){N((function(e){return Object(i.a)(Object(i.a)({},e),{},{preparedByName:t.target.value})}))},disabled:"view"===n}),Object(T.jsx)(g.a,{children:"PREPARED BY SIGNATURE:"}),Object(T.jsx)(m.a,{sx:{border:"2px solid gray",padding:"10px",borderRadius:"8px"},children:Object(T.jsx)(w.a,{penColor:"black",canvasProps:{width:500,height:200,className:"sigCanvas"},ref:function(t){it(t)},disabled:"view"===n})}),Object(T.jsx)(b.a,{variant:"outlined",onClick:function(){nt.clear()},sx:{margin:"10px"},size:"large",children:"Clear signature"})]})}),Object(T.jsx)(h.a,{item:!0,xs:12,md:6,children:"view"===n?Object(T.jsxs)(f.a,{spacing:3,children:[Object(T.jsx)(g.a,{children:"CLIENT: ".concat((null===E||void 0===E?void 0:E.clientSigName)||"")}),Object(T.jsx)("div",{children:Object(T.jsx)("img",{src:(null===E||void 0===E?void 0:E.clientSig)||"",alt:"signaturePreparedBy"})})]}):Object(T.jsxs)(f.a,{spacing:3,children:[Object(T.jsx)(v.a,{variant:"outlined",name:"clientSigName",label:"CLIENT NAME",id:"clientSigName",type:"text",value:(null===E||void 0===E?void 0:E.clientSigName)||"",size:"large",fullWidth:!0,onChange:function(t){N((function(e){return Object(i.a)(Object(i.a)({},e),{},{clientSigName:t.target.value})}))},disabled:"view"===n}),Object(T.jsx)(g.a,{children:"CLIENT SIGNATURE:"}),Object(T.jsx)(m.a,{sx:{border:"2px solid gray",padding:"10px",borderRadius:"8px"},children:Object(T.jsx)(w.a,{penColor:"black",canvasProps:{width:500,height:200,className:"sigCanvas"},ref:function(t){ct(t)},disabled:"view"===n})}),Object(T.jsx)(b.a,{variant:"outlined",onClick:function(){rt.clear()},sx:{margin:"10px"},size:"large",children:"Clear signature"})]})})]})]}),Object(T.jsxs)(j.a,{children:["view"!==n?Object(T.jsx)(b.a,{variant:"contained",color:"primary",onClick:function(){"add"===n?function(){bt.apply(this,arguments)}():"update"===n&&function(){jt.apply(this,arguments)}()},children:"add"===n?"Submit changes":"update"===n?"Update form":""}):Object(T.jsx)(T.Fragment,{}),Object(T.jsx)(b.a,{variant:"contained",color:"error",onClick:function(){return $(!0)},children:"Cancel"})]})]}),Z?Object(T.jsxs)(s.a,{open:Z,fullWidth:!0,maxWidth:"sm",children:[Object(T.jsx)(l.a,{children:"Confirmation"}),Object(T.jsxs)(u.a,{children:[Object(T.jsx)(d.a,{}),Object(T.jsx)("br",{}),Object(T.jsx)(g.a,{children:"Are you sure you want to cancel the ".concat(null===z||void 0===z?void 0:z.title,"?")})]}),Object(T.jsxs)(j.a,{children:[Object(T.jsx)(b.a,{variant:"contained",color:"error",onClick:function(){return O()},children:"Yes"}),Object(T.jsx)(b.a,{variant:"contained",color:"primary",onClick:function(){return $(!1)},children:"No"})]})]}):Object(T.jsx)(T.Fragment,{})]})}},1752:function(t,e,n){var i,a,o,r;t.exports=(i=n(20),a=n(4),o=n(1753),r=n(1754),function(t){function e(i){if(n[i])return n[i].exports;var a=n[i]={exports:{},id:i,loaded:!1};return t[i].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function a(t,e){var n={};for(var i in t)e.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},l=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=i(n(1)),d=n(2),h=i(d),p=i(n(3)),v=i(n(4)),f=function(t){function e(){var t,n,i;o(this,e);for(var c=arguments.length,s=Array(c),l=0;l<c;l++)s[l]=arguments[l];return n=i=r(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(s))),i._sigPad=null,i._excludeOurProps=function(){var t=i.props;return t.canvasProps,t.clearOnResize,a(t,["canvasProps","clearOnResize"])},i.getCanvas=function(){return i._canvas},i.getTrimmedCanvas=function(){var t=document.createElement("canvas");return t.width=i._canvas.width,t.height=i._canvas.height,t.getContext("2d").drawImage(i._canvas,0,0),(0,v.default)(t)},i.getSignaturePad=function(){return i._sigPad},i._checkClearOnResize=function(){i.props.clearOnResize&&i._resizeCanvas()},i._resizeCanvas=function(){var t=i.props.canvasProps||{},e=t.width,n=t.height;if(!e||!n){var a=i._canvas,o=Math.max(window.devicePixelRatio||1,1);e||(a.width=a.offsetWidth*o),n||(a.height=a.offsetHeight*o),a.getContext("2d").scale(o,o),i.clear()}},i.on=function(){return window.addEventListener("resize",i._checkClearOnResize),i._sigPad.on()},i.off=function(){return window.removeEventListener("resize",i._checkClearOnResize),i._sigPad.off()},i.clear=function(){return i._sigPad.clear()},i.isEmpty=function(){return i._sigPad.isEmpty()},i.fromDataURL=function(t,e){return i._sigPad.fromDataURL(t,e)},i.toDataURL=function(t,e){return i._sigPad.toDataURL(t,e)},i.fromData=function(t){return i._sigPad.fromData(t)},i.toData=function(){return i._sigPad.toData()},r(i,n)}return c(e,t),l(e,[{key:"componentDidMount",value:function(){this._sigPad=new p.default(this._canvas,this._excludeOurProps()),this._resizeCanvas(),this.on()}},{key:"componentWillUnmount",value:function(){this.off()}},{key:"componentDidUpdate",value:function(){Object.assign(this._sigPad,this._excludeOurProps())}},{key:"render",value:function(){var t=this,e=this.props.canvasProps;return h.default.createElement("canvas",s({ref:function(e){t._canvas=e}},e))}}]),e}(d.Component);f.propTypes={velocityFilterWeight:u.default.number,minWidth:u.default.number,maxWidth:u.default.number,minDistance:u.default.number,dotSize:u.default.oneOfType([u.default.number,u.default.func]),penColor:u.default.string,throttle:u.default.number,onEnd:u.default.func,onBegin:u.default.func,canvasProps:u.default.object,clearOnResize:u.default.bool},f.defaultProps={clearOnResize:!0},e.default=f},function(t,e){t.exports=i},function(t,e){t.exports=a},function(t,e){t.exports=o},function(t,e){t.exports=r}]))},1753:function(t,e,n){"use strict";function i(t,e,n){this.x=t,this.y=e,this.time=n||(new Date).getTime()}function a(t,e,n,i){this.startPoint=t,this.control1=e,this.control2=n,this.endPoint=i}function o(t,e){var n=this,i=e||{};this.velocityFilterWeight=i.velocityFilterWeight||.7,this.minWidth=i.minWidth||.5,this.maxWidth=i.maxWidth||2.5,this.throttle="throttle"in i?i.throttle:16,this.minDistance="minDistance"in i?i.minDistance:5,this.throttle?this._strokeMoveUpdate=function(t,e,n){var i,a,o,r=null,c=0;n||(n={});var s=function(){c=!1===n.leading?0:Date.now(),r=null,o=t.apply(i,a),r||(i=a=null)};return function(){var l=Date.now();c||!1!==n.leading||(c=l);var u=e-(l-c);return i=this,a=arguments,u<=0||u>e?(r&&(clearTimeout(r),r=null),c=l,o=t.apply(i,a),r||(i=a=null)):r||!1===n.trailing||(r=setTimeout(s,u)),o}}(o.prototype._strokeUpdate,this.throttle):this._strokeMoveUpdate=o.prototype._strokeUpdate,this.dotSize=i.dotSize||function(){return(this.minWidth+this.maxWidth)/2},this.penColor=i.penColor||"black",this.backgroundColor=i.backgroundColor||"rgba(0,0,0,0)",this.onBegin=i.onBegin,this.onEnd=i.onEnd,this._canvas=t,this._ctx=t.getContext("2d"),this.clear(),this._handleMouseDown=function(t){1===t.which&&(n._mouseButtonDown=!0,n._strokeBegin(t))},this._handleMouseMove=function(t){n._mouseButtonDown&&n._strokeMoveUpdate(t)},this._handleMouseUp=function(t){1===t.which&&n._mouseButtonDown&&(n._mouseButtonDown=!1,n._strokeEnd(t))},this._handleTouchStart=function(t){if(1===t.targetTouches.length){var e=t.changedTouches[0];n._strokeBegin(e)}},this._handleTouchMove=function(t){t.preventDefault();var e=t.targetTouches[0];n._strokeMoveUpdate(e)},this._handleTouchEnd=function(t){t.target===n._canvas&&(t.preventDefault(),n._strokeEnd(t))},this.on()}n.r(e),i.prototype.velocityFrom=function(t){return this.time!==t.time?this.distanceTo(t)/(this.time-t.time):1},i.prototype.distanceTo=function(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))},i.prototype.equals=function(t){return this.x===t.x&&this.y===t.y&&this.time===t.time},a.prototype.length=function(){for(var t=0,e=void 0,n=void 0,i=0;i<=10;i+=1){var a=i/10,o=this._point(a,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),r=this._point(a,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(i>0){var c=o-e,s=r-n;t+=Math.sqrt(c*c+s*s)}e=o,n=r}return t},a.prototype._point=function(t,e,n,i,a){return e*(1-t)*(1-t)*(1-t)+3*n*(1-t)*(1-t)*t+3*i*(1-t)*t*t+a*t*t*t},o.prototype.clear=function(){var t=this._ctx,e=this._canvas;t.fillStyle=this.backgroundColor,t.clearRect(0,0,e.width,e.height),t.fillRect(0,0,e.width,e.height),this._data=[],this._reset(),this._isEmpty=!0},o.prototype.fromDataURL=function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=new Image,a=n.ratio||window.devicePixelRatio||1,o=n.width||this._canvas.width/a,r=n.height||this._canvas.height/a;this._reset(),i.src=t,i.onload=function(){e._ctx.drawImage(i,0,0,o,r)},this._isEmpty=!1},o.prototype.toDataURL=function(t){var e;if("image/svg+xml"===t)return this._toSVG();for(var n=arguments.length,i=Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];return(e=this._canvas).toDataURL.apply(e,[t].concat(i))},o.prototype.on=function(){this._handleMouseEvents(),this._handleTouchEvents()},o.prototype.off=function(){this._canvas.removeEventListener("mousedown",this._handleMouseDown),this._canvas.removeEventListener("mousemove",this._handleMouseMove),document.removeEventListener("mouseup",this._handleMouseUp),this._canvas.removeEventListener("touchstart",this._handleTouchStart),this._canvas.removeEventListener("touchmove",this._handleTouchMove),this._canvas.removeEventListener("touchend",this._handleTouchEnd)},o.prototype.isEmpty=function(){return this._isEmpty},o.prototype._strokeBegin=function(t){this._data.push([]),this._reset(),this._strokeUpdate(t),"function"===typeof this.onBegin&&this.onBegin(t)},o.prototype._strokeUpdate=function(t){var e=t.clientX,n=t.clientY,i=this._createPoint(e,n),a=this._data[this._data.length-1],o=a&&a[a.length-1],r=o&&i.distanceTo(o)<this.minDistance;if(!o||!r){var c=this._addPoint(i),s=c.curve,l=c.widths;s&&l&&this._drawCurve(s,l.start,l.end),this._data[this._data.length-1].push({x:i.x,y:i.y,time:i.time,color:this.penColor})}},o.prototype._strokeEnd=function(t){var e=this.points.length>2,n=this.points[0];if(!e&&n&&this._drawDot(n),n){var i=this._data[this._data.length-1],a=i[i.length-1];n.equals(a)||i.push({x:n.x,y:n.y,time:n.time,color:this.penColor})}"function"===typeof this.onEnd&&this.onEnd(t)},o.prototype._handleMouseEvents=function(){this._mouseButtonDown=!1,this._canvas.addEventListener("mousedown",this._handleMouseDown),this._canvas.addEventListener("mousemove",this._handleMouseMove),document.addEventListener("mouseup",this._handleMouseUp)},o.prototype._handleTouchEvents=function(){this._canvas.style.msTouchAction="none",this._canvas.style.touchAction="none",this._canvas.addEventListener("touchstart",this._handleTouchStart),this._canvas.addEventListener("touchmove",this._handleTouchMove),this._canvas.addEventListener("touchend",this._handleTouchEnd)},o.prototype._reset=function(){this.points=[],this._lastVelocity=0,this._lastWidth=(this.minWidth+this.maxWidth)/2,this._ctx.fillStyle=this.penColor},o.prototype._createPoint=function(t,e,n){var a=this._canvas.getBoundingClientRect();return new i(t-a.left,e-a.top,n||(new Date).getTime())},o.prototype._addPoint=function(t){var e=this.points;if(e.push(t),e.length>2){3===e.length&&e.unshift(e[0]);var n=this._calculateCurveControlPoints(e[0],e[1],e[2]).c2,i=this._calculateCurveControlPoints(e[1],e[2],e[3]).c1,o=new a(e[1],n,i,e[2]),r=this._calculateCurveWidths(o);return e.shift(),{curve:o,widths:r}}return{}},o.prototype._calculateCurveControlPoints=function(t,e,n){var a=t.x-e.x,o=t.y-e.y,r=e.x-n.x,c=e.y-n.y,s=(t.x+e.x)/2,l=(t.y+e.y)/2,u=(e.x+n.x)/2,d=(e.y+n.y)/2,h=Math.sqrt(a*a+o*o),p=Math.sqrt(r*r+c*c),v=p/(h+p),f=u+(s-u)*v,g=d+(l-d)*v,m=e.x-f,b=e.y-g;return{c1:new i(s+m,l+b),c2:new i(u+m,d+b)}},o.prototype._calculateCurveWidths=function(t){var e=t.startPoint,n=t.endPoint,i={start:null,end:null},a=this.velocityFilterWeight*n.velocityFrom(e)+(1-this.velocityFilterWeight)*this._lastVelocity,o=this._strokeWidth(a);return i.start=this._lastWidth,i.end=o,this._lastVelocity=a,this._lastWidth=o,i},o.prototype._strokeWidth=function(t){return Math.max(this.maxWidth/(t+1),this.minWidth)},o.prototype._drawPoint=function(t,e,n){var i=this._ctx;i.moveTo(t,e),i.arc(t,e,n,0,2*Math.PI,!1),this._isEmpty=!1},o.prototype._drawCurve=function(t,e,n){var i=this._ctx,a=n-e,o=Math.floor(t.length());i.beginPath();for(var r=0;r<o;r+=1){var c=r/o,s=c*c,l=s*c,u=1-c,d=u*u,h=d*u,p=h*t.startPoint.x;p+=3*d*c*t.control1.x,p+=3*u*s*t.control2.x,p+=l*t.endPoint.x;var v=h*t.startPoint.y;v+=3*d*c*t.control1.y,v+=3*u*s*t.control2.y,v+=l*t.endPoint.y;var f=e+l*a;this._drawPoint(p,v,f)}i.closePath(),i.fill()},o.prototype._drawDot=function(t){var e=this._ctx,n="function"===typeof this.dotSize?this.dotSize():this.dotSize;e.beginPath(),this._drawPoint(t.x,t.y,n),e.closePath(),e.fill()},o.prototype._fromData=function(t,e,n){for(var a=0;a<t.length;a+=1){var o=t[a];if(o.length>1)for(var r=0;r<o.length;r+=1){var c=o[r],s=new i(c.x,c.y,c.time),l=c.color;if(0===r)this.penColor=l,this._reset(),this._addPoint(s);else if(r!==o.length-1){var u=this._addPoint(s),d=u.curve,h=u.widths;d&&h&&e(d,h,l)}}else this._reset(),n(o[0])}},o.prototype._toSVG=function(){var t=this,e=this._data,n=this._canvas,i=Math.max(window.devicePixelRatio||1,1),a=n.width/i,o=n.height/i,r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttributeNS(null,"width",n.width),r.setAttributeNS(null,"height",n.height),this._fromData(e,(function(t,e,n){var i=document.createElement("path");if(!isNaN(t.control1.x)&&!isNaN(t.control1.y)&&!isNaN(t.control2.x)&&!isNaN(t.control2.y)){var a="M "+t.startPoint.x.toFixed(3)+","+t.startPoint.y.toFixed(3)+" C "+t.control1.x.toFixed(3)+","+t.control1.y.toFixed(3)+" "+t.control2.x.toFixed(3)+","+t.control2.y.toFixed(3)+" "+t.endPoint.x.toFixed(3)+","+t.endPoint.y.toFixed(3);i.setAttribute("d",a),i.setAttribute("stroke-width",(2.25*e.end).toFixed(3)),i.setAttribute("stroke",n),i.setAttribute("fill","none"),i.setAttribute("stroke-linecap","round"),r.appendChild(i)}}),(function(e){var n=document.createElement("circle"),i="function"===typeof t.dotSize?t.dotSize():t.dotSize;n.setAttribute("r",i),n.setAttribute("cx",e.x),n.setAttribute("cy",e.y),n.setAttribute("fill",e.color),r.appendChild(n)}));var c='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 '+a+" "+o+'" width="'+a+'" height="'+o+'">',s=r.innerHTML;if(void 0===s){var l=document.createElement("dummy"),u=r.childNodes;l.innerHTML="";for(var d=0;d<u.length;d+=1)l.appendChild(u[d].cloneNode(!0));s=l.innerHTML}return"data:image/svg+xml;base64,"+btoa(c+s+"</svg>")},o.prototype.fromData=function(t){var e=this;this.clear(),this._fromData(t,(function(t,n){return e._drawCurve(t,n.start,n.end)}),(function(t){return e._drawDot(t)})),this._data=t},o.prototype.toData=function(){return this._data},e.default=o},1754:function(t,e,n){t.exports=function(t){function e(i){if(n[i])return n[i].exports;var a=n[i]={exports:{},id:i,loaded:!1};return t[i].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e){"use strict";function n(t){var e=t.getContext("2d"),n=t.width,i=t.height,a=e.getImageData(0,0,n,i).data,c=o(!0,n,i,a),s=o(!1,n,i,a),l=r(!0,n,i,a),u=r(!1,n,i,a)-l+1,d=s-c+1,h=e.getImageData(l,c,u,d);return t.width=u,t.height=d,e.clearRect(0,0,u,d),e.putImageData(h,0,0),t}function i(t,e,n,i){return{red:i[4*(n*e+t)],green:i[4*(n*e+t)+1],blue:i[4*(n*e+t)+2],alpha:i[4*(n*e+t)+3]}}function a(t,e,n,a){return i(t,e,n,a).alpha}function o(t,e,n,i){for(var o=t?1:-1,r=t?0:n-1;t?r<n:r>-1;r+=o)for(var c=0;c<e;c++)if(a(c,r,e,i))return r;return null}function r(t,e,n,i){for(var o=t?1:-1,r=t?0:e-1;t?r<e:r>-1;r+=o)for(var c=0;c<n;c++)if(a(r,c,e,i))return r;return null}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n}])}}]);
//# sourceMappingURL=42.89ff8b5e.chunk.js.map