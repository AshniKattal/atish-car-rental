(this["webpackJsonp@minimal/minimal-kit-react"]=this["webpackJsonp@minimal/minimal-kit-react"]||[]).push([[45],{1527:function(t,a,e){"use strict";var n=e(23);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var d=n(e(117)),o=e(0);a.default=(0,d.default)((0,o.jsx)("path",{d:"M21 11H6.83l3.58-3.59L9 6l-6 6 6 6 1.41-1.41L6.83 13H21z"}),"KeyboardBackspace")},1564:function(t,a){function e(t){var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}e.keys=function(){return[]},e.resolve=e,t.exports=e,e.id=1564},1858:function(t,a,e){"use strict";e.r(a),e.d(a,"default",(function(){return U}));var n=e(9),d=e(6),o=e(18),c=e(3),l=e.n(c),i=e(4),r=e(1508),b=e(133),u=e(1466),s=e(701),j=e(286),h=e(145),m=e(1484),v=e(83),O=e(287),x=e(52),p=e(69),f=e.n(p),y=e(118),g=e(68),F=e(49),S=e(134),T=e(48),N=e(65),A=e(1527),D=e.n(A),w=e(1563),k=e.n(w),M=e(50),P=e.n(M),_=e(0);var I=function(t){var a=t.companyName,e=t.us_invoicelist,n=t.us_total,d=n.totalSubtotalAmount,o=n.totalInvoiceAmount,c=n.totalPaymentMadeAmount,l=n.totalAmountDue;return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsxs)("thead",{children:[Object(_.jsx)("tr",{children:Object(_.jsx)("th",{"data-b-a-s":"thin","data-b-a-c":"00000000",colSpan:12,"data-f-bold":!0,"data-a-h":"center",children:a||""})}),Object(_.jsxs)("tr",{children:[Object(_.jsx)("th",{"data-b-a-s":"thin","data-b-a-c":"00000000",colSpan:5,"data-f-bold":!0,"data-a-h":"center",children:"Vehicle Booking"}),Object(_.jsx)("th",{"data-b-a-s":"thin","data-b-a-c":"00000000"}),Object(_.jsx)("th",{"data-b-a-s":"thin","data-b-a-c":"00000000",colSpan:4,"data-f-bold":!0,"data-f-color":"FFFF0000","data-a-h":"center",children:"PAYMENT"}),Object(_.jsx)("th",{"data-b-a-s":"thin","data-b-a-c":"00000000"}),Object(_.jsx)("th",{"data-b-a-s":"thin","data-b-a-c":"00000000"})]})]}),Object(_.jsxs)("tbody",{children:[Object(_.jsxs)("tr",{children:[Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-f-bold":!0,"data-a-h":"center",children:"BOOKING NUMBER"}),Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-f-bold":!0,"data-a-h":"center",children:"CUSTOMER"}),Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-f-bold":!0,"data-a-h":"center",children:"DATE"}),Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-f-bold":!0,"data-a-h":"center",children:"AMOUNT"}),Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-f-bold":!0,"data-a-h":"center",children:"TOTAL"}),Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000"}),Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-f-bold":!0,"data-f-color":"FFFF0000","data-a-h":"center",children:"DATE"}),Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-f-bold":!0,"data-f-color":"FFFF0000","data-a-h":"center",children:"PAYMENT NO:"}),Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-f-bold":!0,"data-f-color":"FFFF0000","data-a-h":"center",children:"TYPE"}),Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-f-bold":!0,"data-f-color":"FFFF0000","data-a-h":"center",children:"AMOUNT"}),Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000"}),Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-f-bold":!0,"data-f-color":"FF00B0F0","data-a-h":"center",children:"TOTAL AMOUNT DUE"})]}),null===e||void 0===e?void 0:e.map((function(t,a){var e,n,d,o,c,l,r,b,u,s,j,h,m,v,O,x,p,y,g,F,S,T,N,A,D,w;return Object(_.jsxs)("tr",{children:[Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-a-h":"center",children:(null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.bookingId)||""}),Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-a-h":"center",children:(null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.clientName)||""}),Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-a-h":"center",children:f()(null===t||void 0===t||null===(d=t.data)||void 0===d?void 0:d.dateCreated.toDate()).format("DD-MM-YYYY")||""}),Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-a-h":"center",children:Object(_.jsx)(P.a,{value:Number((null===t||void 0===t||null===(o=t.data)||void 0===o?void 0:o.docSubTotal)||0).toFixed(2),displayType:"text",thousandSeparator:!0})}),Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-a-h":"center",children:Object(_.jsx)(P.a,{value:Number((null===t||void 0===t||null===(c=t.data)||void 0===c?void 0:c.bookingTotalAmount)||0).toFixed(2),displayType:"text",thousandSeparator:!0})}),Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000"}),Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-f-color":"FFFF0000","data-a-h":"center",children:null!==t&&void 0!==t&&null!==(l=t.data)&&void 0!==l&&l.attachedPaymentNumber&&(null===t||void 0===t||null===(r=t.data)||void 0===r||null===(b=r.attachedPaymentNumber)||void 0===b?void 0:b.length)>0?null===t||void 0===t||null===(u=t.data)||void 0===u||null===(s=u.attachedPaymentNumber)||void 0===s?void 0:s.map((function(t,a){return Object(_.jsxs)(i.Fragment,{children:[(null===t||void 0===t?void 0:t.paymentDate)||"",Object(_.jsx)("br",{})]},a)})):"-"}),Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-f-color":"FFFF0000","data-a-h":"center","data-a-wrap":!1,children:null!==t&&void 0!==t&&null!==(j=t.data)&&void 0!==j&&j.attachedPaymentNumber&&(null===t||void 0===t||null===(h=t.data)||void 0===h||null===(m=h.attachedPaymentNumber)||void 0===m?void 0:m.length)>0?null===t||void 0===t||null===(v=t.data)||void 0===v||null===(O=v.attachedPaymentNumber)||void 0===O?void 0:O.map((function(t,a){return Object(_.jsxs)(i.Fragment,{children:["".concat((null===t||void 0===t?void 0:t.paymentNumberString)||""),Object(_.jsx)("br",{})]},a)})):"-"}),Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-f-color":"FFFF0000","data-a-h":"center","data-a-wrap":!1,children:null!==t&&void 0!==t&&null!==(x=t.data)&&void 0!==x&&x.attachedPaymentNumber&&(null===t||void 0===t||null===(p=t.data)||void 0===p||null===(y=p.attachedPaymentNumber)||void 0===y?void 0:y.length)>0?null===t||void 0===t||null===(g=t.data)||void 0===g||null===(F=g.attachedPaymentNumber)||void 0===F?void 0:F.map((function(t,a){return Object(_.jsxs)(i.Fragment,{children:[(null===t||void 0===t?void 0:t.paymentType)||"",Object(_.jsx)("br",{})]},a)})):"-"}),Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-f-color":"FFFF0000","data-a-h":"center","data-a-wrap":!1,children:null!==t&&void 0!==t&&null!==(S=t.data)&&void 0!==S&&S.attachedPaymentNumber&&(null===t||void 0===t||null===(T=t.data)||void 0===T||null===(N=T.attachedPaymentNumber)||void 0===N?void 0:N.length)>0?null===t||void 0===t||null===(A=t.data)||void 0===A||null===(D=A.attachedPaymentNumber)||void 0===D?void 0:D.map((function(t,a){return Object(_.jsxs)(i.Fragment,{children:[Object(_.jsx)(P.a,{value:Number((null===t||void 0===t?void 0:t.paymentAmount)||0).toFixed(2),displayType:"text",thousandSeparator:!0}),Object(_.jsx)("br",{})]},a)})):"-"}),Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000"}),Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-f-color":"FF00B0F0","data-a-h":"center",children:Object(_.jsx)(P.a,{value:Number((null===t||void 0===t||null===(w=t.data)||void 0===w?void 0:w.totalAmountDue)||0).toFixed(2),displayType:"text",thousandSeparator:!0})})]},a)})),Object(_.jsx)("tr",{children:Object(_.jsx)("td",{colSpan:12})}),Object(_.jsxs)("tr",{children:[Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-f-bold":!0,"data-a-h":"center",colSpan:6,children:"Total Amount (Sub-total)"}),Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-f-bold":!0,"data-a-h":"center",colSpan:5,children:Object(_.jsx)(P.a,{value:Number(d||0).toFixed(2),displayType:"text",thousandSeparator:!0})})]}),Object(_.jsxs)("tr",{children:[Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-f-bold":!0,"data-a-h":"center",colSpan:6,children:"Total"}),Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-f-bold":!0,"data-a-h":"center",colSpan:5,children:Object(_.jsx)(P.a,{value:Number(o||0).toFixed(2),displayType:"text",thousandSeparator:!0})})]}),Object(_.jsxs)("tr",{children:[Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-f-bold":!0,"data-a-h":"center",colSpan:6,children:"Total payment made"}),Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-f-bold":!0,"data-a-h":"center",colSpan:5,children:Object(_.jsx)(P.a,{value:Number(c||0).toFixed(2),displayType:"text",thousandSeparator:!0})})]}),Object(_.jsxs)("tr",{children:[Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-f-bold":!0,"data-a-h":"center",colSpan:6,children:"Total amount due"}),Object(_.jsx)("td",{"data-b-a-s":"thin","data-b-a-c":"00000000","data-f-bold":!0,"data-a-h":"center",colSpan:5,children:Object(_.jsx)(P.a,{value:Number(l||0).toFixed(2),displayType:"text",thousandSeparator:!0})})]})]})]})},E=e(121),R=e(1844),Y=e(472),B=e(250),C=Object(i.lazy)((function(){return e.e(32).then(e.bind(null,1826))}));function U(){var t=Object(T.g)(),a=Object(v.a)().themeStretch,e=Object(E.a)("up","sm"),c=Object(x.b)(),p=Object(y.b)().enqueueSnackbar,A=Object(x.c)(Y.b),w=A.documents,M=A.companyDetails,P=A.clientList,U=A.clientDocumentObjectSelected,L=A.reportDocType,V=Object(i.useState)(""),z=Object(o.a)(V,2),H=z[0],J=(z[1],Object(i.useState)("")),K=Object(o.a)(J,2),Z=K[0],q=(K[1],Object(i.useRef)(),Object(i.useRef)(),Object(i.useRef)()),G=Object(i.useRef)(),W=Object(i.useState)(new Date),Q=Object(o.a)(W,2),X=Q[0],$=Q[1],tt=Object(i.useState)(new Date),at=Object(o.a)(tt,2),et=at[0],nt=at[1],dt=Object(i.useState)([]),ot=Object(o.a)(dt,2),ct=ot[0],lt=ot[1],it=Object(i.useState)({totalSubtotalAmount:0,totalStorage:0,totalScanning:0,totalVat:0,totalInvoiceAmount:0,totalPaymentMadeAmount:0,totalAmountDue:0}),rt=Object(o.a)(it,2),bt=rt[0],ut=rt[1],st=bt.totalSubtotalAmount,jt=bt.totalStorage,ht=bt.totalScanning,mt=bt.totalVat,vt=bt.totalInvoiceAmount,Ot=bt.totalPaymentMadeAmount,xt=bt.totalAmountDue;function pt(){return pt=Object(d.a)(l.a.mark((function t(){var a,e,n,o,i,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!X||!et){t.next=17;break}if(!(new Date(X)>new Date(et))){t.next=6;break}p("Date incorrect. To Date cannot be before From Date.",{variant:"error"}),c(Object(g.d)(!1)),t.next=15;break;case 6:return c(Object(g.d)(!0)),a=X.toISOString(),e=a.split("T"),n=et.toISOString(),o=n.split("T"),i=new Date("".concat(e[0],"T00:00:00.000Z")),r=new Date("".concat(o[0],"T23:59:59.000Z")),t.next=15,F.b.collection("vehiclebooking").where("dateCreated",">=",S.a.firestore.Timestamp.fromDate(i)).where("dateCreated","<=",S.a.firestore.Timestamp.fromDate(r)).get().then(function(){var t=Object(d.a)(l.a.mark((function t(a){var e;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(null===a||void 0===a||null===(e=a.docs)||void 0===e?void 0:e.length)>0?ft([],a):(ut({totalSubtotalAmount:0,totalStorageCal:0,totalScanningCal:0,totalVat:0,totalInvoiceAmount:0,totalPaymentMadeAmount:0,totalAmountDue:0}),lt([]),c(Object(g.d)(!1)));case 1:case"end":return t.stop()}}),t)})));return function(a){return t.apply(this,arguments)}}()).catch((function(t){p("Error occured while fetching Bookings: ".concat(null===t||void 0===t?void 0:t.message),{variant:"error"}),c(Object(g.d)(!1))}));case 15:t.next=18;break;case 17:c(Object(g.d)(!1));case 18:case"end":return t.stop()}}),t)}))),pt.apply(this,arguments)}function ft(t,a){var e=[],d=0,o=0,l=0,i=0,r=0,b=0;null===a||void 0===a||a.docs.forEach((function(t){var a,c;if((null===t||void 0===t||null===(a=t.data())||void 0===a||!a.isVoid)&&(null===t||void 0===t||null===(c=t.data())||void 0===c||!c.deleted)){var u,s,j,h,m,v,O,x=0;if(null!==t&&void 0!==t&&null!==(u=t.data())&&void 0!==u&&u.attachedPaymentNumber&&(null===t||void 0===t||null===(s=t.data())||void 0===s||null===(j=s.attachedPaymentNumber)||void 0===j?void 0:j.length)>0){var p,f,y=0;null===t||void 0===t||null===(p=t.data())||void 0===p||p.attachedPaymentNumber.forEach((function(t){y+=Number(null===t||void 0===t?void 0:t.paymentAmount)})),x=Number(null===t||void 0===t||null===(f=t.data())||void 0===f?void 0:f.bookingTotalAmount)-y,r+=Number(y)}else{var g;x=Number(null===t||void 0===t||null===(g=t.data())||void 0===g?void 0:g.bookingTotalAmount)}e.push({id:null===t||void 0===t?void 0:t.id,data:Object(n.a)(Object(n.a)({},null===t||void 0===t?void 0:t.data()),{},{totalAmountDue:x})}),d+=Number(null===t||void 0===t||null===(h=t.data())||void 0===h?void 0:h.bookingTotalAmount),o+=Number(null===t||void 0===t||null===(m=t.data())||void 0===m?void 0:m.invStorageFee),l+=Number(null===t||void 0===t||null===(v=t.data())||void 0===v?void 0:v.invScanningFee),i+=Number(null===t||void 0===t||null===(O=t.data())||void 0===O?void 0:O.bookingTotalAmount),b+=Number(x)}})),ut({totalSubtotalAmount:d,totalStorage:o,totalScanning:l,totalVat:0,totalInvoiceAmount:i,totalPaymentMadeAmount:r,totalAmountDue:b}),e.sort(Object(B.g)("id")),lt(e),c(Object(g.d)(!1))}Object(i.useEffect)((function(){G.current()}),[]),Object(i.useEffect)((function(){q.current()}),[X,et,U,P,L]),G.current=function(){c(Object(Y.g)(void 0)),c(Object(Y.f)(null)),c(Object(Y.c)(void 0)),c(Object(Y.d)(null)),c(Object(Y.e)([])),c(Object(Y.i)("")),$(new Date),nt(new Date),lt([])},q.current=function(){return pt.apply(this,arguments)};return Object(_.jsx)(O.a,{title:"Report",children:Object(_.jsxs)(r.a,{maxWidth:!a&&"xl",children:[Object(_.jsxs)(b.a,{container:!0,spacing:3,children:[Object(_.jsx)(b.a,{item:!0,xs:12,md:12,children:Object(_.jsxs)(u.a,{spacing:3,direction:"row",alignItems:"center",children:[Object(_.jsx)(s.a,{startIcon:Object(_.jsx)(D.a,{}),variant:"outlined",color:"primary",onClick:function(){return t(N.b.general.app1)},children:"Back"}),Object(_.jsx)(j.a,{variant:"h3",children:"Report section"})]})}),Object(_.jsx)(b.a,{item:!0,xs:12,md:12,children:Object(_.jsxs)(u.a,{spacing:3,children:[Object(_.jsx)("hr",{}),Object(_.jsxs)(u.a,{direction:"row",spacing:3,alignItems:"center",children:[Object(_.jsx)(R.a,{label:"From",value:X||"",onChange:function(t){$(t)},renderInput:function(t){return Object(_.jsx)(h.a,Object(n.a)(Object(n.a)({},t),{},{size:"small"}))},inputFormat:"dd/MM/yyyy"}),Object(_.jsx)(R.a,{label:"To",value:et||"",onChange:function(t){nt(t)},renderInput:function(t){return Object(_.jsx)(h.a,Object(n.a)(Object(n.a)({},t),{},{size:"small"}))},inputFormat:"dd/MM/yyyy"})]})]})}),Object(_.jsx)(b.a,{item:!0,xs:12,md:12,style:{display:ct&&(null===ct||void 0===ct?void 0:ct.length)>0&&X&&et?"":"none"},children:Object(_.jsxs)(u.a,{spacing:3,children:[Object(_.jsx)(u.a,{direction:"row",spacing:3,children:Object(_.jsx)(s.a,{variant:"contained",color:"primary",onClick:function(){return function(t){var a=f()(X).format("DD-MM-YYYY"),e=f()(et).format("DD-MM-YYYY");if("idStatementTable"===t){var n=document.getElementById(t);k.a.convert(n,{name:"SOA_".concat(null===U||void 0===U?void 0:U.name,"_").concat(a,"_TO_").concat(e,".xlsx")})}else if("idReportTable"===t){var d=document.getElementById(t);k.a.convert(d,{name:"REPORT_".concat(a,"_TO_").concat(e,".xlsx")})}else if("idIncomeReportTable"===t){var o=document.getElementById(t);k.a.convert(o,{name:"Income_report_".concat(a,"_TO_").concat(e,".xlsx")})}else if("idSummaryIncomeReportTable"===t){var c=document.getElementById(t);k.a.convert(c,{name:"Summary_income_".concat(a,"_TO_").concat(e,".xlsx")})}}("idReportTable")},style:{width:e?"200px":"100%"},children:"Download as excel"})}),Object(_.jsx)(i.Suspense,{fallback:Object(_.jsx)(_.Fragment,{}),children:Object(_.jsx)(C,{logo:H,sigImage:Z,companyDetails:M,clientDocumentObjectSelected:U,documents:w,reportDocType:L,companyDetail:M,us_invoicelist:ct||[],totalSubtotalAmount:st||0,totalStorage:jt||0,totalScanning:ht||0,totalVat:mt||0,totalInvoiceAmount:vt||0,totalPaymentMadeAmount:Ot||0,totalAmountDue:xt||0,clientList:P})})]})}),Object(_.jsx)(b.a,{item:!0,xs:12,md:12,style:{display:X&&et?!M||ct&&0!==(null===ct||void 0===ct?void 0:ct.length)?"none":"":"none"},children:Object(_.jsx)(m.a,{severity:"warning",children:"No Bookings found for the chosen date"})})]}),Object(_.jsx)("table",{id:"idReportTable",border:"1",style:{display:"none"},"data-cols-width":"20,20,20,20,20,10,20,20,20,20,10,20",children:Object(_.jsx)(I,{companyDetails:M,documents:w,reportDocType:L,companyName:(null===M||void 0===M?void 0:M.name)||"",us_invoicelist:ct||[],us_total:bt||0})})]})})}}}]);
//# sourceMappingURL=45.63183e42.chunk.js.map