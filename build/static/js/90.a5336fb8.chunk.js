(this["webpackJsonp@minimal/minimal-kit-react"]=this["webpackJsonp@minimal/minimal-kit-react"]||[]).push([[90],{1813:function(e,n,t){"use strict";t.r(n);var i=t(9),l=t(27),a=t(6),o=t(18),c=t(3),d=t.n(c),r=t(4),u=t(49),s=t(52),v=t(1508),b=t(1516),m=t(1466),p=t(133),j=t(1491),O=t(145),f=t(286),y=t(154),h=t(250),x=t(72),N=t(118),g=t(204),C=t(68),R=t(83),T=t(0),k=Object(r.lazy)((function(){return Promise.all([t.e(1),t.e(7)]).then(t.bind(null,1541))})),w=Object(r.lazy)((function(){return Promise.all([t.e(8),t.e(91)]).then(t.bind(null,1574))})),S=Object(r.lazy)((function(){return t.e(92).then(t.bind(null,1758))}));n.default=function(){var e,n=Object(R.a)().themeStretch,t=Object(s.b)(),c=Object(N.b)().enqueueSnackbar,D=Object(x.a)().user,E=Object(s.c)(y.c).companyList,I=Object(r.useState)([]),L=Object(o.a)(I,2),B=L[0],_=L[1],z=Object(r.useState)([]),P=Object(o.a)(z,2),F=P[0],J=P[1],A=Object(r.useState)({id:"",companyRefId:"",companyRefName:"",name:"",companyType:"",tan:"",address:"",contactNumber:"",mobileNumber:"",email:"",email2:"",email3:"",email4:"",brn:"",nic:"",buyerType:null,representativeName:"",representativeContactNumber:""}),H=Object(o.a)(A,2),M=H[0],q=H[1],U=Object(r.useState)(""),V=Object(o.a)(U,2),W=V[0],Y=V[1],G=Object(r.useState)(null),K=Object(o.a)(G,2),Q=K[0],X=K[1],Z=Object(r.useState)(null),$=Object(o.a)(Z,2),ee=$[0],ne=$[1],te=Object(r.useState)(!1),ie=Object(o.a)(te,2),le=ie[0],ae=ie[1],oe=Object(r.useState)(""),ce=Object(o.a)(oe,2),de=ce[0],re=ce[1],ue=Object(r.useRef)(),se=Object(r.useRef)(),ve=Object(r.useRef)(),be=Object(r.useRef)(),me=Object(r.useRef)(),pe=Object(r.useState)(!1),je=Object(o.a)(pe,2),Oe=je[0],fe=je[1];Object(r.useEffect)((function(){me.current()}),[W]),me.current=function(){var e,n,t;W&&(null!==D&&void 0!==D&&null!==(e=D.permissions)&&void 0!==e&&null!==(n=e.viewClientChk)&&void 0!==n&&null!==(t=n.assignedCompanyId)&&void 0!==t&&t.includes(W)?fe(!0):(c("You do not have the permission to view clients for this company",{variant:"error"}),fe(!1)))},Object(r.useEffect)((function(){ue.current()}),[D]),Object(r.useEffect)((function(){se.current()}),[E]),Object(r.useEffect)((function(){W&&Oe?ve.current():(_([]),J([]))}),[W,Oe]),Object(r.useEffect)((function(){be.current()}),[Q]);var ye=function(){var e=Object(a.a)(d.a.mark((function e(){var n,t,i,l;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"admin_member"===(null===D||void 0===D?void 0:D.role)&&null!==D&&void 0!==D&&D.a_comp&&(null===D||void 0===D||null===(n=D.a_comp)||void 0===n?void 0:n.length)>0&&null!==D&&void 0!==D&&null!==(t=D.permissions)&&void 0!==t&&t.viewClientChk&&1===(null===D||void 0===D||null===(i=D.a_comp)||void 0===i?void 0:i.length)&&Y(null===D||void 0===D||null===(l=D.a_comp[0])||void 0===l?void 0:l.id);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();ue.current=ye;var he=function(){var e=Object(a.a)(d.a.mark((function e(){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!E||0!==E.length){e.next=6;break}return t(Object(C.d)(!0)),e.next=4,Object(h.j)(null===D||void 0===D?void 0:D.id,null===D||void 0===D?void 0:D.a_comp,null===D||void 0===D?void 0:D.role);case 4:(n=e.sent).error?(c(n.msg||"",{variant:n.variant}),t(Object(C.d)(!1))):(t(Object(y.d)(n)),t(Object(C.d)(!1)));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();se.current=he;var xe=function(){var e=Object(a.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!W||""===W){e.next=4;break}return t(Object(C.d)(!0)),e.next=4,u.b.collection("company").doc(W).collection("client").orderBy("name","asc").get().then((function(e){var n,i=[];(null===e||void 0===e||null===(n=e.docs)||void 0===n?void 0:n.length)>0?(e.docs.forEach((function(e){var n,t,l,a,o,c,d,r,u,s,v,b,m,p,j,O,f,y;"--counterStatus--"!==e.id&&i.push({id:null===e||void 0===e?void 0:e.id,data:null===e||void 0===e?void 0:e.data(),name:(null===e||void 0===e||null===(n=e.data())||void 0===n?void 0:n.name)||"",companyRefName:(null===e||void 0===e||null===(t=e.data())||void 0===t?void 0:t.companyRefName)||"",companyRefId:(null===e||void 0===e||null===(l=e.data())||void 0===l?void 0:l.companyRefId)||"",companyType:(null===e||void 0===e||null===(a=e.data())||void 0===a?void 0:a.companyType)||"",address:(null===e||void 0===e||null===(o=e.data())||void 0===o?void 0:o.address)||"",contactNumber:(null===e||void 0===e||null===(c=e.data())||void 0===c?void 0:c.contactNumber)||"",mobileNumber:(null===e||void 0===e||null===(d=e.data())||void 0===d?void 0:d.mobileNumber)||"",email:(null===e||void 0===e||null===(r=e.data())||void 0===r?void 0:r.email)||"",email2:(null===e||void 0===e||null===(u=e.data())||void 0===u?void 0:u.email2)||"",email3:(null===e||void 0===e||null===(s=e.data())||void 0===s?void 0:s.email3)||"",email4:(null===e||void 0===e||null===(v=e.data())||void 0===v?void 0:v.email4)||"",tan:(null===e||void 0===e||null===(b=e.data())||void 0===b?void 0:b.tan)||"",brn:(null===e||void 0===e||null===(m=e.data())||void 0===m?void 0:m.brn)||"",nic:(null===e||void 0===e||null===(p=e.data())||void 0===p?void 0:p.nic)||"",buyerType:null!==e&&void 0!==e&&null!==(j=e.data())&&void 0!==j&&j.buyerType?JSON.stringify(null===e||void 0===e||null===(O=e.data())||void 0===O?void 0:O.buyerType):null,representativeName:(null===e||void 0===e||null===(f=e.data())||void 0===f?void 0:f.representativeName)||"",representativeContactNumber:(null===e||void 0===e||null===(y=e.data())||void 0===y?void 0:y.representativeContactNumber)||""})})),J(i),_(i),t(Object(C.d)(!1))):(J([]),_([]),t(Object(C.d)(!1)))})).catch((function(e){c("Error occured while fetching clients: ".concat(null===e||void 0===e?void 0:e.message),{variant:"error"}),t(Object(C.d)(!1))}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();ve.current=xe,be.current=function(){if(Q){var e=B.filter((function(e){return(null===e||void 0===e?void 0:e.id)===(null===Q||void 0===Q?void 0:Q.id)}));J(e)}else J(Object(l.a)(B))};var Ne=function(){ae(!1),q({id:"",companyRefId:"",companyRefName:"",name:"",companyType:"",tan:"",address:"",contactNumber:"",mobileNumber:"",email:"",email2:"",email3:"",email4:"",brn:"",nic:"",buyerType:null,representativeName:"",representativeContactNumber:""})},ge=function(){var e=Object(a.a)(d.a.mark((function e(n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(Object(C.d)(!0)),e.next=3,u.b.collection("company").doc(W).collection("client").doc(n).delete().then(Object(a.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:xe(),t(Object(g.e)(void 0)),t(Object(g.d)(void 0)),t(Object(C.d)(!1));case 4:case"end":return e.stop()}}),e)})))).catch((function(e){c("Error occured while deleting a client: ".concat(null===e||void 0===e?void 0:e.message),{variant:"error"}),t(Object(C.d)(!1))}));case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return Object(T.jsxs)(v.a,{maxWidth:!n&&"xl",children:[Object(T.jsxs)("div",{style:{display:"admin_member"===(null===D||void 0===D?void 0:D.role)&&null!==D&&void 0!==D&&D.a_comp&&1===(null===D||void 0===D||null===(e=D.a_comp)||void 0===e?void 0:e.length)?"none":""},children:[Object(T.jsx)(b.a,{children:Object(T.jsx)(m.a,{sx:{p:3},children:Object(T.jsx)(p.a,{container:!0,children:Object(T.jsx)(p.a,{item:!0,xs:12,md:4,children:Object(T.jsx)(j.a,{ListboxProps:{style:{maxHeight:"70vh"}},size:"small",label:"Please select company",id:"client-drop-down",options:E||[],value:ee||null,renderInput:function(e){return Object(T.jsx)(O.a,Object(i.a)(Object(i.a)({},e),{},{label:"Please select company"}))},onChange:function(e,n,t){"removeOption"!==t&&"clear"!==t&&n?(Y(null===n||void 0===n?void 0:n.id),ne(n)):"removeOption"!==t&&"clear"!==t||(Y(""),ne(null))},getOptionLabel:function(e){return(null===e||void 0===e?void 0:e.name)||""},renderOption:function(e,n){return Object(r.createElement)("li",Object(i.a)(Object(i.a)({},e),{},{key:null===n||void 0===n?void 0:n.id}),Object(T.jsx)("span",{children:(null===n||void 0===n?void 0:n.name)||""}))}})})})})}),Object(T.jsx)("br",{})]}),Object(T.jsx)(p.a,{container:!0,spacing:3,children:W&&Oe&&F?Object(T.jsxs)(T.Fragment,{children:[Object(T.jsxs)(p.a,{item:!0,xs:12,md:12,children:[Object(T.jsx)(f.a,{children:"".concat(null===F||void 0===F?void 0:F.length," clients retrieved")})," "]}),(null===F||void 0===F?void 0:F.length)>0?Object(T.jsx)(p.a,{item:!0,xs:12,md:4,children:Object(T.jsx)(j.a,{ListboxProps:{style:{maxHeight:"70vh"}},size:"small",label:"Search client",id:"client-drop-down",options:B||[],value:Q||null,renderInput:function(e){return Object(T.jsx)(O.a,Object(i.a)(Object(i.a)({},e),{},{label:"Search client"}))},onChange:function(e,n,t){"removeOption"!==t&&"clear"!==t&&n?X(n):"removeOption"!==t&&"clear"!==t||X(null)},getOptionLabel:function(e){return(null===e||void 0===e?void 0:e.name)||""},renderOption:function(e,n){return Object(r.createElement)("li",Object(i.a)(Object(i.a)({},e),{},{key:null===n||void 0===n?void 0:n.id}),Object(T.jsx)("span",{children:(null===n||void 0===n?void 0:n.name)||""}))}})}):Object(T.jsx)(T.Fragment,{}),Object(T.jsx)(p.a,{item:!0,xs:12,md:12,children:Object(T.jsx)(r.Suspense,{fallback:Object(T.jsx)("p",{children:"Loading..."}),children:Object(T.jsx)(k,{companyId:W,type:"client",headers:[{id:"list",label:"List"},{id:"update",label:"Update"},{id:"delete",label:"Delete"},{id:"name",label:"Name"},{id:"companyType",label:"Type"},{id:"address",label:"Address"},{id:"contactNumber",label:"Contact number"},{id:"mobileNumber",label:"Mobile_Number"},{id:"email",label:"Email 1"},{id:"email2",label:"Email 2"},{id:"email3",label:"Email 3"},{id:"email4",label:"Email 4"},{id:"tan",label:"VAT"},{id:"brn",label:"BRN"},{id:"nic",label:"NIC"},{id:"buyerType",label:"Buyer Type"},{id:"representativeName",label:"Representative name"},{id:"representativeContactNumber",label:"Representative contact number"}],aCollection:F,addBtnDisplay:!!ee,addBtnLabel:"Create a client",addBtnFunc:function(){re("add"),ae(!0),q(Object(i.a)(Object(i.a)({},M),{},{id:"",companyRefName:"",name:"",companyType:"",tan:"",address:"",contactNumber:"",mobileNumber:"",email:"",email2:"",email3:"",email4:"",brn:"",nic:"",buyerType:null,representativeName:"",representativeContactNumber:""}))},openDialog:le,handleCloseDialog:Ne,emptyColMsg:"Sorry, not a single client has been created yet. Please create a client.",updateBtnDisplay:!0,deleteBtnDisplay:!0,updateBtnFunc:function(e,n){re("update"),ae(!0),q({id:e,name:(null===n||void 0===n?void 0:n.name)||"",companyRefId:(null===n||void 0===n?void 0:n.companyRefId)||"",companyRefName:(null===n||void 0===n?void 0:n.companyRefName)||"",companyType:(null===n||void 0===n?void 0:n.companyType)||"",tan:(null===n||void 0===n?void 0:n.tan)||"",address:(null===n||void 0===n?void 0:n.address)||"",email:(null===n||void 0===n?void 0:n.email)||"",email2:(null===n||void 0===n?void 0:n.email2)||"",email3:(null===n||void 0===n?void 0:n.email3)||"",email4:(null===n||void 0===n?void 0:n.email4)||"",contactNumber:(null===n||void 0===n?void 0:n.contactNumber)||"",mobileNumber:(null===n||void 0===n?void 0:n.mobileNumber)||"",brn:(null===n||void 0===n?void 0:n.brn)||"",nic:(null===n||void 0===n?void 0:n.nic)||"",buyerType:(null===n||void 0===n?void 0:n.buyerType)||null,representativeName:(null===n||void 0===n?void 0:n.representativeName)||"",representativeContactNumber:(null===n||void 0===n?void 0:n.representativeContactNumber)||""})},deleteBtnFunc:ge})})})]}):Object(T.jsx)(T.Fragment,{})}),Object(T.jsx)("div",{children:de&&"add"===de?Object(T.jsx)(r.Suspense,{fallback:Object(T.jsx)("p",{children:"Loading..."}),children:Object(T.jsx)(w,{companyId:W,openDialog:le,handleCloseDialog:Ne,clientDetails:M,setClientDetails:q,initializeClientList:xe})}):Object(T.jsx)(r.Suspense,{fallback:Object(T.jsx)("p",{children:"Loading..."}),children:Object(T.jsx)(S,{companyId:W,openDialog:le,handleCloseDialog:Ne,clientDetails:M,setClientDetails:q,initializeClientList:xe})})})]})}}}]);
//# sourceMappingURL=90.a5336fb8.chunk.js.map