(this["webpackJsonp@minimal/minimal-kit-react"]=this["webpackJsonp@minimal/minimal-kit-react"]||[]).push([[35],{1560:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(9),i=n(1865),c=n(130),o=n(286),l=n(1473),r=n(1498),d=n(1497),s=n(147),u=n(4),b=n(50),j=n.n(b),v=n(68),m=n.n(v),p=n(120),h=n(52),O=n(184),x=n(1574),g=n.n(x),y=n(0);function f(e){var t,n=e.product,b=e.callLocation,v=e.disableEditing,x=Object(h.b)(),f=Object(p.b)().enqueueSnackbar,k=n.name,w=n.price,D=Object(h.c)(O.b).bookingData;return Object(u.useEffect)((function(){if(null!==D&&void 0!==D&&D.bookingPickupDate&&null!==D&&void 0!==D&&D.bookingReturnDate&&m()(null===D||void 0===D?void 0:D.bookingReturnDate).format("YYYY-MM-DD")!==m()(new Date).format("YYYY-MM-DD")){var e=m()(null===D||void 0===D?void 0:D.bookingPickupDate,"YYYY-MM-DD"),t=m()(null===D||void 0===D?void 0:D.bookingReturnDate,"YYYY-MM-DD");if(t.isAfter(e)){var n=t.diff(e,"days")+1;x(Object(O.c)(Object(a.a)(Object(a.a)({},D),{},{bookingNumberOfDays:n})))}else f("Return date should be after Pickup date",{variant:"error"})}}),[null===D||void 0===D?void 0:D.bookingPickupDate,null===D||void 0===D?void 0:D.bookingReturnDate]),Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(c.a,{item:!0,xs:12,md:12,children:Object(y.jsx)(o.a,{variant:"h4",sx:{mt:2,mb:1,display:"block"},children:k||""})}),Object(y.jsx)(c.a,{item:!0,xs:12,md:12,children:Object(y.jsxs)(l.a,{direction:"row",spacing:1,alignItems:"center",children:[Object(y.jsx)(r.a,{title:"Or similar models",children:Object(y.jsx)(g.a,{color:"info"})}),Object(y.jsx)(o.a,{children:"Or similar model"})]})}),Object(y.jsx)(c.a,{item:!0,xs:12,md:12,children:Object(y.jsxs)(o.a,{children:[Object(y.jsx)(j.a,{value:Number(w||0).toFixed(2),displayType:"text",thousandSeparator:!0,prefix:"".concat("\u20ac"," ")})," ","/ day"]})}),Object(y.jsx)(c.a,{item:!0,xs:12,md:12,children:Object(y.jsx)(d.a,{ListboxProps:{style:{maxHeight:"70vh"}},size:"small",label:"Pickup address",id:"pickup-drop-down",options:[{id:"ssr",title:"SSR Airport, Plaine Magnien, Mauritius"},{id:"anywhere",title:"Desired location - anywhere (+ additional cost)"}]||[],value:(null===D||void 0===D?void 0:D.bookingPickupAddress)||null,renderInput:function(e){return Object(y.jsx)(s.a,Object(a.a)(Object(a.a)({},e),{},{label:"Pickup address",InputLabelProps:{required:!0},size:"large"}))},required:!0,onChange:function(e,t,n){x("removeOption"!==n&&"clear"!==n&&t?Object(O.c)(Object(a.a)(Object(a.a)({},D),{},{bookingPickupAddress:t})):Object(O.c)(Object(a.a)(Object(a.a)({},D),{},{bookingPickupAddress:null})))},getOptionLabel:function(e){return e.title},disabled:"bookingList"===b&&v})}),"anywhere"===(null===D||void 0===D||null===(t=D.bookingPickupAddress)||void 0===t?void 0:t.id)&&Object(y.jsx)(c.a,{item:!0,xs:12,md:12,children:Object(y.jsx)(s.a,{variant:"outlined",fullWidth:!0,name:"bookingPickupAnywhereAddress",label:"Specify desired address",type:"text",id:"bookingPickupAnywhereAddress",value:(null===D||void 0===D?void 0:D.bookingPickupAnywhereAddress)||"",size:"large",onChange:function(e){x(Object(O.c)(Object(a.a)(Object(a.a)({},D),{},{bookingPickupAnywhereAddress:e.target.value})))},disabled:"bookingList"===b&&v})}),Object(y.jsx)(c.a,{item:!0,xs:12,md:6,children:Object(y.jsx)(i.a,{label:"Pickup date",value:(null===D||void 0===D?void 0:D.bookingPickupDate)||"",onChange:function(e){x(Object(O.c)(Object(a.a)(Object(a.a)({},D),{},{bookingPickupDate:e})))},renderInput:function(e){return Object(y.jsx)(s.a,Object(a.a)(Object(a.a)({},e),{},{size:"large",fullWidth:!0,disabled:"bookingList"===b&&v}))},inputFormat:"dd/MM/yyyy",disabled:"bookingList"===b&&v})}),Object(y.jsx)(c.a,{item:!0,xs:12,md:6,children:Object(y.jsx)(s.a,{variant:"outlined",fullWidth:!0,name:"bookingPickupTime",label:"Pickup time",type:"time",id:"bookingPickupTime",value:(null===D||void 0===D?void 0:D.bookingPickupTime)||"",size:"large",onChange:function(e){x(Object(O.c)(Object(a.a)(Object(a.a)({},D),{},{bookingPickupTime:e.target.value})))},disabled:"bookingList"===b&&v})}),Object(y.jsx)(c.a,{item:!0,xs:12,md:6,children:Object(y.jsx)(i.a,{label:"Return date",value:(null===D||void 0===D?void 0:D.bookingReturnDate)||"",onChange:function(e){x(Object(O.c)(Object(a.a)(Object(a.a)({},D),{},{bookingReturnDate:e})))},renderInput:function(e){return Object(y.jsx)(s.a,Object(a.a)(Object(a.a)({},e),{},{size:"large",fullWidth:!0,disabled:"bookingList"===b&&v}))},inputFormat:"dd/MM/yyyy",disabled:"bookingList"===b&&v})}),Object(y.jsx)(c.a,{item:!0,xs:12,md:6,children:Object(y.jsx)(s.a,{variant:"outlined",fullWidth:!0,name:"bookingReturnTime",label:"Return time",type:"time",id:"bookingReturnTime",value:(null===D||void 0===D?void 0:D.bookingReturnTime)||"",size:"large",onChange:function(e){x(Object(O.c)(Object(a.a)(Object(a.a)({},D),{},{bookingReturnTime:e.target.value})))},disabled:"bookingList"===b&&v})})]})}},1561:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(9),i=n(130),c=n(286),o=n(704),l=n(1473),r=n(147),d=n(52),s=n(184),u=n(0);function b(e){var t=e.callLocation,n=e.disableEditing,b=Object(d.b)(),j=Object(d.c)(s.b).bookingData;return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(i.a,{item:!0,xs:12,md:12,children:Object(u.jsx)(c.a,{variant:"h6",children:"Add extra options (Optional)"})}),Object(u.jsx)(i.a,{item:!0,xs:12,md:12,children:Object(u.jsx)(o.a,{})}),Object(u.jsx)(i.a,{item:!0,xs:12,md:8,children:Object(u.jsxs)(l.a,{spacing:1,children:[Object(u.jsx)(c.a,{variant:"subtitle1",children:"Baby Seat"}),Object(u.jsx)(c.a,{children:"Baby seat suitable for 0-13 Kg."})]})}),Object(u.jsx)(i.a,{item:!0,xs:12,md:4,children:Object(u.jsx)(r.a,{label:"Baby seat quantity",variant:"outlined",size:"large",fullWidth:!0,name:"bookingBabySeatQty",type:"number",id:"bookingBabySeatQty",value:(null===j||void 0===j?void 0:j.bookingBabySeatQty)||0,onChange:function(e){Number(e.target.value)>=0&&b(Object(s.c)(Object(a.a)(Object(a.a)({},j),{},{bookingBabySeatQty:e.target.value})))},disabled:"bookingList"===t&&n})}),Object(u.jsx)(i.a,{item:!0,xs:12,md:12,children:Object(u.jsx)(o.a,{})}),Object(u.jsx)(i.a,{item:!0,xs:12,md:8,children:Object(u.jsxs)(l.a,{spacing:1,children:[Object(u.jsx)(c.a,{variant:"subtitle1",children:"Booster Seat"}),Object(u.jsx)(c.a,{children:"Booster Seat suitable for 7-12 years old."})]})}),Object(u.jsx)(i.a,{item:!0,xs:12,md:4,children:Object(u.jsx)(r.a,{label:"Booster seat quantity",variant:"outlined",size:"large",fullWidth:!0,name:"bookingBoosterSeatQty",type:"number",id:"bookingBoosterSeatQty",value:(null===j||void 0===j?void 0:j.bookingBoosterSeatQty)||0,onChange:function(e){Number(e.target.value)>=0&&b(Object(s.c)(Object(a.a)(Object(a.a)({},j),{},{bookingBoosterSeatQty:e.target.value})))},disabled:"bookingList"===t&&n})}),Object(u.jsx)(i.a,{item:!0,xs:12,md:12,children:Object(u.jsx)(o.a,{})}),Object(u.jsx)(i.a,{item:!0,xs:12,md:8,children:Object(u.jsxs)(l.a,{spacing:1,children:[Object(u.jsx)(c.a,{variant:"subtitle1",children:"Child Seat"}),Object(u.jsx)(c.a,{children:"Child seat suitable for 9-18 Kg."})]})}),Object(u.jsx)(i.a,{item:!0,xs:12,md:4,children:Object(u.jsx)(r.a,{label:"Child seat quantity",variant:"outlined",size:"large",fullWidth:!0,name:"bookingChildSeatQty",type:"number",id:"bookingChildSeatQty",value:(null===j||void 0===j?void 0:j.bookingChildSeatQty)||0,onChange:function(e){Number(e.target.value)>=0&&b(Object(s.c)(Object(a.a)(Object(a.a)({},j),{},{bookingChildSeatQty:e.target.value})))},disabled:"bookingList"===t&&n})}),Object(u.jsx)(i.a,{item:!0,xs:12,md:12,children:Object(u.jsx)(o.a,{})})]})}},1562:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(9),i=n(130),c=n(286),o=n(704),l=n(1473),r=n(50),d=n.n(r),s=n(1575),u=n.n(s),b=n(4),j=n(52),v=n(184),m=n(0);function p(e){var t=e.price,n=e.bookingData,r=Object(j.b)(),s=Object(b.useRef)();return Object(b.useEffect)((function(){s.current()}),[null===n||void 0===n?void 0:n.bookingNumberOfDays,null===n||void 0===n?void 0:n.bookingBabySeatQty,null===n||void 0===n?void 0:n.bookingBoosterSeatQty,null===n||void 0===n?void 0:n.bookingChildSeatQty]),s.current=function(){var e;e=Number((null===n||void 0===n?void 0:n.bookingNumberOfDays)||0)*Number(t||0)+7*Number((null===n||void 0===n?void 0:n.bookingBabySeatQty)||0)+7*Number((null===n||void 0===n?void 0:n.bookingBoosterSeatQty)||0)+7*Number((null===n||void 0===n?void 0:n.bookingChildSeatQty)||0),r(Object(v.c)(Object(a.a)(Object(a.a)({},n),{},{bookingTotalAmount:e})))},Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(i.a,{item:!0,xs:12,md:7,children:Object(m.jsx)(c.a,{children:"Price per day"})}),Object(m.jsx)(i.a,{item:!0,xs:12,md:5,children:Object(m.jsx)(c.a,{align:"right",children:Object(m.jsx)(d.a,{value:Number(t||0).toFixed(2),displayType:"text",thousandSeparator:!0,prefix:"".concat("\u20ac"," ")})})}),Object(m.jsx)(i.a,{item:!0,xs:12,md:12,children:Object(m.jsx)(o.a,{})}),Object(m.jsx)(i.a,{item:!0,xs:12,md:7,children:Object(m.jsx)(c.a,{children:"Rental Days"})}),Object(m.jsx)(i.a,{item:!0,xs:12,md:5,children:Object(m.jsx)(c.a,{align:"right",children:(null===n||void 0===n?void 0:n.bookingNumberOfDays)||0})}),Object(m.jsx)(i.a,{item:!0,xs:12,md:12,children:Object(m.jsx)(o.a,{})}),Object(m.jsx)(i.a,{item:!0,xs:12,md:7,children:Object(m.jsx)(c.a,{children:"Rental Fee"})}),Object(m.jsx)(i.a,{item:!0,xs:12,md:5,children:Object(m.jsx)(c.a,{align:"right",children:Object(m.jsx)(d.a,{value:(Number(t||0)*Number((null===n||void 0===n?void 0:n.bookingNumberOfDays)||0)).toFixed(2),displayType:"text",thousandSeparator:!0,prefix:"".concat("\u20ac"," ")})})}),null!==n&&void 0!==n&&n.bookingBabySeatQty&&Number((null===n||void 0===n?void 0:n.bookingBabySeatQty)||0)>0?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(i.a,{item:!0,xs:12,md:12,children:Object(m.jsx)(o.a,{})}),Object(m.jsx)(i.a,{item:!0,xs:12,md:7,children:Object(m.jsxs)(l.a,{direction:"row",alignItems:"center",spacing:1,children:[Object(m.jsx)(c.a,{children:"(+) Baby Seat"}),Object(m.jsx)(u.a,{fontSize:"small"}),Object(m.jsx)(c.a,{children:Number(null===n||void 0===n?void 0:n.bookingBabySeatQty)})]})}),Object(m.jsx)(i.a,{item:!0,xs:12,md:5,children:Object(m.jsx)(c.a,{align:"right",children:Object(m.jsx)(d.a,{value:(Number(t||0)*Number((null===n||void 0===n?void 0:n.bookingBabySeatQty)||0)).toFixed(2),displayType:"text",thousandSeparator:!0,prefix:"".concat("\u20ac"," ")})})})]}):Object(m.jsx)(m.Fragment,{}),null!==n&&void 0!==n&&n.bookingBoosterSeatQty&&Number((null===n||void 0===n?void 0:n.bookingBoosterSeatQty)||0)>0?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(i.a,{item:!0,xs:12,md:12,children:Object(m.jsx)(o.a,{})}),Object(m.jsx)(i.a,{item:!0,xs:12,md:7,children:Object(m.jsxs)(l.a,{direction:"row",alignItems:"center",spacing:1,children:[Object(m.jsx)(c.a,{children:"(+) Booster Seat"}),Object(m.jsx)(u.a,{fontSize:"small"}),Object(m.jsx)(c.a,{children:Number(null===n||void 0===n?void 0:n.bookingBoosterSeatQty)})]})}),Object(m.jsx)(i.a,{item:!0,xs:12,md:5,children:Object(m.jsx)(c.a,{align:"right",children:Object(m.jsx)(d.a,{value:(Number(t||0)*Number((null===n||void 0===n?void 0:n.bookingBoosterSeatQty)||0)).toFixed(2),displayType:"text",thousandSeparator:!0,prefix:"".concat("\u20ac"," ")})})})]}):Object(m.jsx)(m.Fragment,{}),null!==n&&void 0!==n&&n.bookingChildSeatQty&&Number((null===n||void 0===n?void 0:n.bookingChildSeatQty)||0)>0?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(i.a,{item:!0,xs:12,md:12,children:Object(m.jsx)(o.a,{})}),Object(m.jsx)(i.a,{item:!0,xs:12,md:7,children:Object(m.jsxs)(l.a,{direction:"row",alignItems:"center",spacing:1,children:[Object(m.jsx)(c.a,{children:"(+) Child Seat"}),Object(m.jsx)(u.a,{fontSize:"small"}),Object(m.jsx)(c.a,{children:Number(null===n||void 0===n?void 0:n.bookingChildSeatQty)})]})}),Object(m.jsx)(i.a,{item:!0,xs:12,md:5,children:Object(m.jsx)(c.a,{align:"right",children:Object(m.jsx)(d.a,{value:(Number(t||0)*Number((null===n||void 0===n?void 0:n.bookingChildSeatQty)||0)).toFixed(2),displayType:"text",thousandSeparator:!0,prefix:"".concat("\u20ac"," ")})})})]}):Object(m.jsx)(m.Fragment,{}),Object(m.jsx)(i.a,{item:!0,xs:12,md:12,children:Object(m.jsx)(o.a,{})}),Object(m.jsx)(i.a,{item:!0,xs:12,md:7,children:Object(m.jsx)(c.a,{variant:"h6",children:"Total amount"})}),Object(m.jsx)(i.a,{item:!0,xs:12,md:5,children:Object(m.jsx)(c.a,{align:"right",children:Object(m.jsx)(d.a,{value:Number((null===n||void 0===n?void 0:n.bookingTotalAmount)||0).toFixed(2),displayType:"text",thousandSeparator:!0,prefix:"".concat("\u20ac"," ")})})})]})}},1573:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=1573},1589:function(e,t,n){"use strict";n.d(t,"a",(function(){return z}));var a=n(9),i=n(7),c=n(18),o=n(3),l=n.n(o),r=(n(1572),n(1402)),d=n(1410),s=n(1418),u=n(704),b=n(130),j=n(1473),v=n(1550),m=n(1497),p=n(147),h=n(286),O=n(1419),x=n(705),g=n(120),y=n(4),f=n(52),k=n(193),w=n(184),D=n(77),S=n(48),P=n(72),N=n(1560),C=n(1561),A=n(1562),T=n(0);function z(e){var t,n,o,z=e.open,E=e.setOpen,F=e.fetchBooking,Y=e.viewOnly,M=Object(P.a)().user,R=Object(g.b)().enqueueSnackbar,B=Object(f.b)(),I=Object(f.c)(w.b).bookingData,Q=Object(y.useState)(!1),L=Object(c.a)(Q,2),U=L[0],W=L[1];function q(){return(q=Object(i.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B(Object(D.d)(!0)),e.next=3,S.b.collection("vehiclebooking").doc(null===I||void 0===I?void 0:I.bookingId).set(Object(a.a)({},I),{merge:!0}).then(Object(i.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"client"===(null===M||void 0===M?void 0:M.role)?H("client"):"client"!==(null===M||void 0===M?void 0:M.role)&&H("admin");case 1:case"end":return e.stop()}}),e)})))).catch((function(e){R("Error occured while updating booking details: ".concat(null===e||void 0===e?void 0:e.message),{variant:"error"}),B(Object(D.d)(!1))}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e){return J.apply(this,arguments)}function J(){return(J=Object(i.a)(l.a.mark((function e(t){var n,a,i,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.e)(null===I||void 0===I?void 0:I.bookingId,"".concat((null===M||void 0===M?void 0:M.lastName)||""," ").concat((null===M||void 0===M?void 0:M.firstName)||""),null===M||void 0===M?void 0:M.email,I,null===I||void 0===I||null===(n=I.vehicleDetails)||void 0===n?void 0:n.name,"client",t);case 2:if(null===(a=e.sent)||void 0===a||!a.error){e.next=8;break}R(null===a||void 0===a?void 0:a.message,{variant:"error"}),B(Object(D.d)(!1)),e.next=13;break;case 8:if(null!==a&&void 0!==a&&a.error){e.next=13;break}return e.next=11,Object(k.e)(null===I||void 0===I?void 0:I.bookingId,"Admin","info@reachingheightsltd.com",I,null===I||void 0===I||null===(i=I.vehicleDetails)||void 0===i?void 0:i.name,"admin",t);case 11:null!==(c=e.sent)&&void 0!==c&&c.error?(R(null===c||void 0===c?void 0:c.message,{variant:"error"}),B(Object(D.d)(!1))):(R(null===a||void 0===a?void 0:a.message,{variant:"success"}),R(null===c||void 0===c?void 0:c.message,{variant:"success"}),K(),F(),B(Object(D.d)(!1)));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(){B(Object(w.c)({bookingPickupAddress:null,bookingPickupAnywhereAddress:"",bookingPickupDate:new Date,bookingPickupTime:"00:00",bookingReturnDate:new Date,bookingReturnTime:"00:00",bookingNumberOfDays:0,bookingBabySeatQty:0,bookingBoosterSeatQty:0,bookingChildSeatQty:0,bookingTotalAmount:0})),E(!1)}Object(y.useEffect)((function(){z&&(Y||"client"==(null===M||void 0===M?void 0:M.role)&&("confirmed"===(null===I||void 0===I?void 0:I.status)||"declined"===(null===I||void 0===I?void 0:I.status))?W(!0):W(!1))}),[z]);var V=function(){var e=Object(i.a)(l.a.mark((function e(t,n,i){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),"removeOption"!==i&&"clear"!==i&&n?B(Object(w.c)(Object(a.a)(Object(a.a)({},I),{},{status:n}))):"removeOption"!==i&&"clear"!==i||B(Object(w.c)(Object(a.a)(Object(a.a)({},I),{},{status:"pending"})));case 2:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}();return Object(T.jsxs)(r.a,{open:z,maxWidth:"md",fullWidth:!0,children:[Object(T.jsx)(d.a,{children:"Update booking"}),Object(T.jsxs)(s.a,{children:[Object(T.jsx)(u.a,{}),Object(T.jsx)("br",{}),Object(T.jsxs)(b.a,{container:!0,spacing:3,justifyContent:"flex-end",children:[Object(T.jsx)(b.a,{item:!0,xs:12,md:4,children:Object(T.jsxs)(j.a,{spacing:3,children:[Object(T.jsx)(T.Fragment,{children:"pending"===(null===I||void 0===I?void 0:I.status)?Object(T.jsx)(v.a,{severity:"warning",children:"Pending"}):"confirmed"===(null===I||void 0===I?void 0:I.status)&&"client"===(null===M||void 0===M?void 0:M.role)?Object(T.jsx)(v.a,{severity:"success",children:"Confirmed"}):"declined"===(null===I||void 0===I?void 0:I.status)?Object(T.jsx)(v.a,{severity:"error",children:"Declined"}):Object(T.jsx)(T.Fragment,{})}),M&&"client"!==(null===M||void 0===M?void 0:M.role)?Object(T.jsx)(m.a,{size:"small",label:"Please choose status",id:"client-drop-down",options:["pending","confirmed","declined"],value:(null===I||void 0===I?void 0:I.status)||null,renderInput:function(e){return Object(T.jsx)(p.a,Object(a.a)(Object(a.a)({},e),{},{label:"Please choose status",fullWidth:!0}))},onChange:function(e,t,n){return V(e,t,n)},getOptionLabel:function(e){return"pending"===e?"Pending":"confirmed"===e?"Confirmed":"declined"===e?"Declined":""},disabled:U}):Object(T.jsx)(T.Fragment,{})]})}),Object(T.jsx)(N.a,{product:{name:(null===I||void 0===I||null===(t=I.vehicleDetails)||void 0===t?void 0:t.name)||"",price:(null===I||void 0===I||null===(n=I.vehicleDetails)||void 0===n?void 0:n.price)||0},callLocation:"bookingList",disableEditing:U}),Object(T.jsx)(C.a,{callLocation:"bookingList",disableEditing:U}),Object(T.jsx)(u.a,{}),Object(T.jsx)(b.a,{item:!0,xs:12,md:12,children:Object(T.jsx)(h.a,{align:"right",variant:"h5",children:"Price summary"})}),Object(T.jsx)(b.a,{item:!0,xs:12,md:6,children:Object(T.jsx)(b.a,{container:!0,spacing:3,children:Object(T.jsx)(A.a,{price:(null===I||void 0===I||null===(o=I.vehicleDetails)||void 0===o?void 0:o.price)||0,bookingData:I})})})]})]}),Object(T.jsxs)(O.a,{children:[U?Object(T.jsx)(T.Fragment,{}):Object(T.jsx)(x.a,{variant:"contained",color:"primary",size:"large",onClick:function(){!function(){q.apply(this,arguments)}()},children:"Submit changes"}),Object(T.jsx)(x.a,{variant:"outlined",color:"error",size:"large",onClick:function(){return K()},children:"Close"})]})]})}},1825:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return ce}));var a=n(28),i=n(9),c=n(7),o=n(18),l=n(3),r=n.n(l),d=n(4),s=n(1514),u=n(130),b=n(1473),j=n(705),v=n(286),m=n(147),p=n(1522),h=n(1519),O=n(1520),x=n(1489),g=n(1507),y=n(1536),f=n(1537),k=n(1541),w=n(1539),D=n(1540),S=n(1538),P=n(1505),N=n(704),C=n(1402),A=n(1410),T=n(1418),z=n(1419),E=n(84),F=n(287),Y=n(52),M=n(68),R=n.n(M),B=n(120),I=n(77),Q=n(48),L=n(155),U=n(49),W=n(65),q=n(1533),H=n.n(q),J=n(1532),K=n.n(J),V=n(1671),_=n(1865),Z=n(472),G=n(50),X=n.n(G),$=n(72),ee=n(46),te=n(184),ne=n(1589),ae=n(0),ie=Object(d.lazy)((function(){return n.e(3).then(n.bind(null,1555))}));function ce(){var e,t,n,l,M,q,J,G,ce,oe=Object($.a)().user,le=Object(U.g)(),re=Object(E.a)().themeStretch,de=Object(Y.b)(),se=Object(B.b)().enqueueSnackbar,ue=Object(d.useRef)(),be=Object(Y.c)(Z.b),je=be.companyDetails,ve=be.clientDocumentObjectSelected,me=be.paymentDocType,pe=Object(d.useState)([]),he=Object(o.a)(pe,2),Oe=he[0],xe=he[1],ge=Object(d.useState)(new Date),ye=Object(o.a)(ge,2),fe=ye[0],ke=ye[1],we=Object(d.useState)(new Date),De=Object(o.a)(we,2),Se=De[0],Pe=De[1],Ne=Object(d.useState)(""),Ce=Object(o.a)(Ne,2),Ae=Ce[0],Te=Ce[1],ze=Object(d.useState)(!1),Ee=Object(o.a)(ze,2),Fe=Ee[0],Ye=Ee[1],Me=Object(d.useState)(null),Re=Object(o.a)(Me,2),Be=Re[0],Ie=Re[1],Qe=Object(d.useState)(!1),Le=Object(o.a)(Qe,2),Ue=Le[0],We=Le[1],qe=Object(d.useState)(!1),He=Object(o.a)(qe,2),Je=He[0],Ke=He[1],Ve=Object(d.useState)({expenseAmt:0,expenseDesc:""}),_e=Object(o.a)(Ve,2),Ze=_e[0],Ge=_e[1],Xe=Object(d.useState)(null),$e=Object(o.a)(Xe,2),et=$e[0],tt=$e[1],nt=Object(d.useState)(""),at=Object(o.a)(nt,2),it=at[0],ct=at[1],ot=Object(d.useState)(""),lt=Object(o.a)(ot,2),rt=lt[0],dt=lt[1],st=Object(d.useState)(""),ut=Object(o.a)(st,2),bt=ut[0],jt=ut[1],vt=Object(d.useState)(!1),mt=Object(o.a)(vt,2),pt=mt[0],ht=mt[1];function Ot(){return xt.apply(this,arguments)}function xt(){return(xt=Object(c.a)(r.a.mark((function e(){var t,n,a,c,o,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===fe||""===fe||void 0===Se||""===Se||!je){e.next=17;break}if(!(new Date(fe)>new Date(Se))){e.next=6;break}se("Date incorrect. To Date cannot be before From Date.",{variant:"error"}),de(Object(I.d)(!1)),e.next=15;break;case 6:return de(Object(I.d)(!0)),t=fe.toISOString(),n=t.split("T"),a=Se.toISOString(),c=a.split("T"),o=new Date("".concat(n[0],"T00:00:00.000Z")),l=new Date("".concat(c[0],"T23:59:59.000Z")),e.next=15,Q.b.collection("vehiclebooking").where("dateCreated",">=",L.a.firestore.Timestamp.fromDate(o)).where("dateCreated","<=",L.a.firestore.Timestamp.fromDate(l)).get().then((function(e){var t,n=[];(null===e||void 0===e||null===(t=e.docs)||void 0===t?void 0:t.length)>0?(null===e||void 0===e||e.docs.forEach((function(e){var t,a,c,o,l,r=Number((null===e||void 0===e||null===(t=e.data())||void 0===t?void 0:t.docRemainingPaymentAmt)||0),d=0;null!==e&&void 0!==e&&null!==(a=e.data())&&void 0!==a&&a.invoiceExpensetData&&(null===e||void 0===e||null===(c=e.data())||void 0===c||null===(o=c.invoiceExpensetData)||void 0===o?void 0:o.length)>0&&(null===e||void 0===e||null===(l=e.data())||void 0===l||l.invoiceExpensetData.forEach((function(e){d+=Number((null===e||void 0===e?void 0:e.expenseAmt)||0)})));n.push({checked:!1,id:null===e||void 0===e?void 0:e.id,data:Object(i.a)({},null===e||void 0===e?void 0:e.data()),paymentAmt:0,paymentType:"",docRemainingPaymentAmt:r,totalExpenseAmountForInvoice:d})})),xe(n)):xe([]),de(Object(I.d)(!1))})).catch((function(e){se("Error occured while fetching bookings: ".concat(null===e||void 0===e?void 0:e.message),{variant:"error"}),de(Object(I.d)(!1))}));case 15:e.next=18;break;case 17:de(Object(I.d)(!1));case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function gt(e,t){var n,o,l,d,s=[],u=e.toString();1===(null===(n=u)||void 0===n?void 0:n.length)?u="0000".concat(u):2===(null===(o=u)||void 0===o?void 0:o.length)?u="000".concat(u):3===(null===(l=u)||void 0===l?void 0:l.length)?u="00".concat(u):4===(null===(d=u)||void 0===d?void 0:d.length)&&(u="0".concat(u));var b=Q.b.batch(),j=e.toString(),v=Q.b.collection("company").doc(je.id).collection("payment").doc("paymentCounter"),m=Q.b.collection("company").doc(je.id).collection("payment").doc(j);t.forEach((function(e){var t,n,c,o,l,r,d=Q.b.collection("vehiclebooking").doc(e.id),v=Number((null===e||void 0===e?void 0:e.docRemainingPaymentAmt)||0),m=[];null!==e&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&t.attachedPaymentNumber&&(null===e||void 0===e||null===(n=e.data)||void 0===n||null===(c=n.attachedPaymentNumber)||void 0===c?void 0:c.length)>0?m=[].concat(Object(a.a)(null===e||void 0===e||null===(r=e.data)||void 0===r?void 0:r.attachedPaymentNumber),[{paymentNumber:j,paymentNumberString:u,paymentType:null===e||void 0===e?void 0:e.paymentType,paymentAmount:null===e||void 0===e?void 0:e.paymentAmount,paymentRemainingAmount:v,paymentDate:R()(new Date).format("DD-MM-YYYY")}]):m.push({paymentNumber:j,paymentNumberString:u,paymentType:null===e||void 0===e?void 0:e.paymentType,paymentAmount:null===e||void 0===e?void 0:e.paymentAmount,paymentRemainingAmount:v,paymentDate:R()(new Date).format("DD-MM-YYYY")});var p="";v===Number((null===e||void 0===e||null===(o=e.data)||void 0===o?void 0:o.bookingTotalAmount)||0)?p="Unpaid":v>0&&v<Number((null===e||void 0===e||null===(l=e.data)||void 0===l?void 0:l.bookingTotalAmount)||0)?p="Partially paid":v<0?p="Over paid":0===v&&(p="Paid"),s.push(Object(i.a)(Object(i.a)({invoiceId:null===e||void 0===e?void 0:e.id},null===e||void 0===e?void 0:e.data),{},{attachedPaymentNumber:m,paymentStatus:p,docRemainingPaymentAmt:v})),b.set(d,{docRemainingPaymentAmt:v,attachedPaymentNumber:m,paymentStatus:p},{merge:!0})})),b.set(v,{paymentCounter:Number(e)},{merge:!0}),b.set(m,{invoiceList:s,paymentDate:R()(new Date).format("DD-MM-YYYY"),dateCreated:L.a.firestore.Timestamp.fromDate(new Date)},{merge:!0}),b.commit().then(Object(c.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return se("Payment stored successfully"),ct(""),dt(""),jt(""),ht(!1),e.next=7,Ot();case 7:de(Object(I.d)(!1));case 8:case"end":return e.stop()}}),e)}))))}function yt(){return(yt=Object(c.a)(r.a.mark((function e(t,n,a,o,l){var d,s,u,b,j,v;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:de(Object(I.d)(!0)),n&&(null===n||void 0===n?void 0:n.length)>0?(d=[],n.forEach((function(e){(null===e||void 0===e?void 0:e.paymentNumber)!==(null===t||void 0===t?void 0:t.paymentNumber)&&d.push(Object(i.a)({},e))})),s=0,void 0!==a&&null!==a&&(s=Number(null===t||void 0===t?void 0:t.paymentAmount)+Number(a)),u="",s===Number(l||0)?u="Unpaid":s>0&&s<Number(l||0)?u="Partially paid":s<0?u="Over paid":0===s&&(u="Paid"),b=Q.b.batch(),j=Q.b.collection("vehiclebooking").doc(o),v=Q.b.collection("company").doc(je.id).collection("payment").doc(null===t||void 0===t?void 0:t.paymentNumber),b.set(j,{attachedPaymentNumber:d,docRemainingPaymentAmt:s,paymentStatus:u},{merge:!0}),b.set(v,{isDeleted:!0,deletedTimestamp:L.a.firestore.FieldValue.serverTimestamp()},{merge:!0}),b.commit().then(Object(c.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return se("Payment removed and Invoice updated successfully."),e.next=3,Ot();case 3:de(Object(I.d)(!1));case 4:case"end":return e.stop()}}),e)})))).catch((function(e){se("Error occured while executing batch: ".concat(null===e||void 0===e?void 0:e.message),{variant:"error"}),de(Object(I.d)(!1))}))):de(Object(I.d)(!1));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ft(){return ft=Object(c.a)(r.a.mark((function e(t){var n,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Oe.find((function(e){return e.id===t})),Object(V.isEmpty)(n)||(de(Object(I.d)(!0)),a=Q.b.collection("company").doc(je.id).collection("payment").doc("paymentCounter"),Q.b.runTransaction(function(){var e=Object(c.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.get(a).then((function(e){return e.exists?Number(e.data().paymentCounter||0)+1:null})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then(function(){var e=Object(c.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==t){e.next=5;break}return e.next=3,Q.b.collection("company").doc(je.id).collection("payment").doc("paymentCounter").set({paymentCounter:1}).then(Object(c.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kt(1,n);case 2:case"end":return e.stop()}}),e)})))).catch((function(e){se("Error occured while creating payment counter: ".concat(null===e||void 0===e?void 0:e.message),{variant:"error"}),de(Object(I.d)(!1))}));case 3:e.next=8;break;case 5:if(!(t&&Number(t)>0)){e.next=8;break}return e.next=8,kt(t,n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){se("Error occured while executing payment transaction: ".concat(null===e||void 0===e?void 0:e.message),{variant:"error"}),de(Object(I.d)(!1))})));case 2:case"end":return e.stop()}}),e)}))),ft.apply(this,arguments)}function kt(e,t){return wt.apply(this,arguments)}function wt(){return(wt=Object(c.a)(r.a.mark((function e(t,n){var a,o,l,d,s,u,b,j,v,m,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u=t.toString(),1===(null===(a=u)||void 0===a?void 0:a.length)?u="0000".concat(u):2===(null===(o=u)||void 0===o?void 0:o.length)?u="000".concat(u):3===(null===(l=u)||void 0===l?void 0:l.length)?u="00".concat(u):4===(null===(d=u)||void 0===d?void 0:d.length)&&(u="0".concat(u)),b=Q.b.batch(),j=t.toString(),v=Q.b.collection("company").doc(je.id).collection("payment").doc("paymentCounter"),m=Q.b.collection("company").doc(je.id).collection("payment").doc(j),p=Q.b.collection("vehiclebooking").doc(n.id),b.set(v,{paymentCounter:Number(t)},{merge:!0}),b.set(m,{invoiceList:[Object(i.a)({},n)],paymentDate:R()(new Date).format("DD-MM-YYYY"),dateCreated:L.a.firestore.Timestamp.fromDate(new Date)},{merge:!0}),b.set(p,{paymentStatus:"Paid",docRemainingPaymentAmt:0,attachedPaymentNumber:[{paymentNumber:j,paymentNumberString:u,paymentType:"",paymentAmount:(null===n||void 0===n||null===(s=n.data)||void 0===s?void 0:s.bookingTotalAmount)||0,paymentRemainingAmount:0,paymentDate:R()(new Date).format("DD-MM-YYYY")}]},{merge:!0}),b.commit().then(Object(c.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return se("Full payment stored successfully"),e.next=3,Ot();case 3:de(Object(I.d)(!1));case 4:case"end":return e.stop()}}),e)}))));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(d.useEffect)((function(){ue.current()}),[fe,Se,je,ve,me]),ue.current=Ot;var Dt=function(){var e=Object(c.a)(r.a.mark((function e(t,n){var c,o,l,d,s,u,b,j,v;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!(t.target.files&&t.target.files.length>0)){e.next=24;break}return de(Object(I.d)(!0)),o="",l=new Date,d=l.toISOString(),s="/screenshot/".concat(null===je||void 0===je?void 0:je.id,"/").concat(null===Be||void 0===Be||null===(c=Be.invoiceData)||void 0===c?void 0:c.docType,"/").concat(d),u=t.target.files[0],b=Q.c.storage().ref(),j=b.child(s),e.next=12,j.put(u);case 12:return e.next=14,j.getDownloadURL();case 14:if(!(o=e.sent)){e.next=22;break}return(v=Object(a.a)((null===Be||void 0===Be?void 0:Be.invoiceScreenshotData)||[])).push({dateString:d,screenshotUrl:o,screenshotStoragePath:s,timestamp:L.a.firestore.Timestamp.fromDate(new Date)}),e.next=20,Q.b.collection("vehiclebooking").doc(null===Be||void 0===Be?void 0:Be.invoiceId).set({invoiceScreenshotData:v},{merge:!0}).then((function(){Ie(Object(i.a)(Object(i.a)({},Be),{},{invoiceScreenshotData:v})),se("Sreenshot uploaded successfully"),de(Object(I.d)(!1)),Ot()})).catch((function(e){se("Error occured while uploading screenshot: ".concat((null===e||void 0===e?void 0:e.message)||""),{variant:"error"}),de(Object(I.d)(!1))}));case 20:e.next=24;break;case 22:se("Error occured while getting screenshot storage url",{variant:"error"}),de(Object(I.d)(!1));case 24:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function St(){return(St=Object(c.a)(r.a.mark((function e(t){var n,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===t||void 0===t||!t.screenshotStoragePath){e.next=6;break}return de(Object(I.d)(!0)),n=Q.c.storage().ref(),o=n.child(null===t||void 0===t?void 0:t.screenshotStoragePath),e.next=6,o.delete().then(Object(c.a)(r.a.mark((function e(){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(n=Object(a.a)((null===Be||void 0===Be?void 0:Be.invoiceScreenshotData)||[])).filter((function(e){return(null===e||void 0===e?void 0:e.screenshotStoragePath)!==(null===t||void 0===t?void 0:t.screenshotStoragePath)})),e.next=4,Q.b.collection("vehiclebooking").doc(null===Be||void 0===Be?void 0:Be.invoiceId).set({invoiceScreenshotData:n},{merge:!0}).then((function(){Ie(Object(i.a)(Object(i.a)({},Be),{},{invoiceScreenshotData:n})),se("Sreenshot deleted successfully"),de(Object(I.d)(!1)),Ot()})).catch((function(e){se("Error occured while deleting screenshot: ".concat((null===e||void 0===e?void 0:e.message)||""),{variant:"error"}),de(Object(I.d)(!1))}));case 4:case"end":return e.stop()}}),e)})))).catch((function(e){se("Error occured while deleting screenshot: ".concat((null===e||void 0===e?void 0:e.message)||""),{variant:"error"}),de(Object(I.d)(!1))}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Pt(){return(Pt=Object(c.a)(r.a.mark((function e(){var t,n,c,o,l,d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(de(Object(I.d)(!0)),c="",o=Object(a.a)((null===et||void 0===et||null===(t=et.invoiceData)||void 0===t?void 0:t.invoiceExpensetData)||[]),null===Ze||void 0===Ze||!Ze.expenseStoragePath){e.next=11;break}return l=Q.c.storage().ref(),d=l.child(null===Ze||void 0===Ze?void 0:Ze.expenseStoragePath),e.next=8,d.put(null===Ze||void 0===Ze?void 0:Ze.expenseFile);case 8:return e.next=10,d.getDownloadURL();case 10:c=e.sent;case 11:return c?o.push({dateString:null===Ze||void 0===Ze?void 0:Ze.dateString,expenseAmt:null===Ze||void 0===Ze?void 0:Ze.expenseAmt,expenseDesc:null===Ze||void 0===Ze?void 0:Ze.expenseDesc,expenseUrl:c,expenseStoragePath:null===Ze||void 0===Ze?void 0:Ze.expenseStoragePath,timestamp:L.a.firestore.Timestamp.fromDate(new Date)}):o.push({dateString:"",expenseAmt:null===Ze||void 0===Ze?void 0:Ze.expenseAmt,expenseDesc:null===Ze||void 0===Ze?void 0:Ze.expenseDesc,expenseUrl:"",expenseStoragePath:"",timestamp:L.a.firestore.Timestamp.fromDate(new Date)}),e.next=14,Q.b.collection("company").doc(null===je||void 0===je?void 0:je.id).collection(null===et||void 0===et||null===(n=et.invoiceData)||void 0===n?void 0:n.docType).doc(null===et||void 0===et?void 0:et.invoiceId).set({invoiceExpensetData:o},{merge:!0}).then((function(){tt(Object(i.a)(Object(i.a)({},et),{},{invoiceData:Object(i.a)(Object(i.a)({},null===et||void 0===et?void 0:et.invoiceData),{},{invoiceExpensetData:o})})),Ot(),se("Expense uploaded successfully"),Ke(!1),de(Object(I.d)(!1))})).catch((function(e){se("Error occured while uploading expense: ".concat((null===e||void 0===e?void 0:e.message)||""),{variant:"error"}),de(Object(I.d)(!1))}));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Nt(){return(Nt=Object(c.a)(r.a.mark((function e(t,n){var a,o,l,d,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(de(Object(I.d)(!0)),null===t||void 0===t||!t.expenseStoragePath){e.next=6;break}return l=Q.c.storage().ref(),d=l.child(null===t||void 0===t?void 0:t.expenseStoragePath),e.next=6,d.delete().then(Object(c.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:se("Image Url deleted successfully"),de(Object(I.d)(!1));case 2:case"end":return e.stop()}}),e)})))).catch((function(e){se("Error occured while deleting expense: ".concat((null===e||void 0===e?void 0:e.message)||""),{variant:"error"}),de(Object(I.d)(!1))}));case 6:return de(Object(I.d)(!0)),s=[],null===et||void 0===et||null===(a=et.invoiceData)||void 0===a||a.invoiceExpensetData.forEach((function(e){(null===e||void 0===e?void 0:e.expenseDesc)!==(null===t||void 0===t?void 0:t.expenseDesc)&&(e.timestamp&&R()(e.timestamp.toDate()).format("DD-MM-YYYY, HH:MM:ss")||"")!==(t.timestamp&&R()(t.timestamp.toDate()).format("DD-MM-YYYY, HH:MM:ss")||"")&&s.push(Object(i.a)({},t))})),e.next=11,Q.b.collection("company").doc(null===je||void 0===je?void 0:je.id).collection(null===et||void 0===et||null===(o=et.invoiceData)||void 0===o?void 0:o.docType).doc(null===et||void 0===et?void 0:et.invoiceId).set({invoiceExpensetData:s},{merge:!0}).then((function(){tt(Object(i.a)(Object(i.a)({},et),{},{invoiceData:Object(i.a)(Object(i.a)({},null===et||void 0===et?void 0:et.invoiceData),{},{invoiceExpensetData:s})})),Ot(),se("Expense deleted successfully"),de(Object(I.d)(!1))})).catch((function(e){se("Error occured while deleting expense: ".concat((null===e||void 0===e?void 0:e.message)||""),{variant:"error"}),de(Object(I.d)(!1))}));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ct=Object(d.useState)(!1),At=Object(o.a)(Ct,2),Tt=At[0],zt=At[1];return Object(ae.jsxs)(F.a,{title:"Payment/Expense",children:[Object(ae.jsx)(s.a,{maxWidth:!re&&"xl",children:Object(ae.jsxs)(u.a,{container:!0,spacing:3,children:[Object(ae.jsx)(u.a,{item:!0,xs:12,md:12,children:Object(ae.jsxs)(b.a,{spacing:3,direction:"row",alignItems:"center",children:[Object(ae.jsx)(j.a,{startIcon:Object(ae.jsx)(H.a,{}),variant:"outlined",color:"primary",onClick:function(){return le(W.b.general.app1)},children:"Back"}),Object(ae.jsx)(v.a,{variant:"h3",children:"Payment/Expense section"})]})}),Object(ae.jsx)(d.Suspense,{fallback:Object(ae.jsx)(ae.Fragment,{}),children:Object(ae.jsx)(ie,{type:"payment"})}),Object(ae.jsx)("br",{}),Object(ae.jsx)("br",{}),je&&Object(ae.jsx)(ae.Fragment,{children:Object(ae.jsx)(u.a,{item:!0,xs:12,md:12,children:Object(ae.jsxs)(b.a,{spacing:3,children:[Object(ae.jsx)("hr",{}),Object(ae.jsx)(v.a,{children:"Please choose any booking and insert an amount"}),Object(ae.jsxs)(b.a,{direction:"row",spacing:3,alignItems:"center",children:[Object(ae.jsx)(_.a,{label:"From",value:fe||"",onChange:function(e){ke(e)},renderInput:function(e){return Object(ae.jsx)(m.a,Object(i.a)(Object(i.a)({},e),{},{size:"small"}))},inputFormat:"dd/MM/yyyy"}),Object(ae.jsx)(_.a,{label:"To",value:Se||"",onChange:function(e){Pe(e)},renderInput:function(e){return Object(ae.jsx)(m.a,Object(i.a)(Object(i.a)({},e),{},{size:"small"}))},inputFormat:"dd/MM/yyyy"})]}),Object(ae.jsx)(p.a,{children:Object(ae.jsxs)(b.a,{style:{padding:"10px"},children:[Object(ae.jsx)("br",{}),Object(ae.jsxs)(h.a,{fullWidth:!0,variant:"outlined",size:"small",style:{width:"300px"},disabled:!Oe||0===(null===Oe||void 0===Oe?void 0:Oe.length),children:[Object(ae.jsx)(O.a,{id:"paymentType-select-label",children:"Filter"}),Object(ae.jsxs)(x.a,{labelId:"paymentType-select-label",label:"Filter",value:Ae||"",onChange:function(e){Te(e.target.value)},children:[Object(ae.jsx)(g.a,{value:"",children:"All"}),Object(ae.jsx)(g.a,{value:"Unpaid",children:"Unpaid"}),Object(ae.jsx)(g.a,{value:"Partially paid",children:"Partially paid"}),Object(ae.jsx)(g.a,{value:"Over paid",children:"Over paid"}),Object(ae.jsx)(g.a,{value:"Paid",children:"Paid"})]})]}),Object(ae.jsx)("br",{}),Object(ae.jsx)(y.a,{children:Object(ae.jsxs)(f.a,{border:1,children:[Object(ae.jsx)(k.a,{children:Object(ae.jsxs)(w.a,{children:[Object(ae.jsx)(D.a,{size:"small",align:"center",style:{whiteSpace:"nowrap"},children:"Status"}),Object(ae.jsx)(D.a,{size:"small",align:"center",style:{whiteSpace:"nowrap"},children:"View booking details"}),Object(ae.jsx)(D.a,{size:"small",align:"center",style:{whiteSpace:"nowrap"},children:"Booking Number"}),Object(ae.jsx)(D.a,{size:"small",align:"center",style:{whiteSpace:"nowrap"},children:"Datetime created"}),Object(ae.jsx)(D.a,{size:"small",align:"center",style:{whiteSpace:"nowrap"},children:"Do full payment"}),Object(ae.jsx)(D.a,{size:"small",align:"center",style:{whiteSpace:"nowrap"},children:"Add partial payment"}),Object(ae.jsx)(D.a,{size:"small",align:"center",style:{whiteSpace:"nowrap"},children:"Bill to"}),Object(ae.jsx)(D.a,{size:"small",align:"center",style:{whiteSpace:"nowrap"},children:"Booking amount"}),Object(ae.jsx)(D.a,{size:"small",align:"center",style:{whiteSpace:"nowrap"},children:"Remaining amount"}),Object(ae.jsx)(D.a,{size:"small",align:"center",style:{whiteSpace:"nowrap"},children:"Recent payment made"}),Object(ae.jsx)(D.a,{size:"small",align:"center",style:{whiteSpace:"nowrap"},children:"Upload/view screenshot"})]})}),Object(ae.jsx)(S.a,{children:Oe&&(null===Oe||void 0===Oe?void 0:Oe.length)>0&&(null===(e=Oe.filter((function(e){var t,n;return""===Ae&&""!==(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.paymentStatus)||""!==Ae&&(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.paymentStatus)===Ae})))||void 0===e?void 0:e.map((function(e,t){var n,a,c,o,l,r,s,u,m,p,h,O,x,g,y;return Object(ae.jsxs)(w.a,{children:[Object(ae.jsx)(D.a,{size:"small",align:"center",style:{whiteSpace:"nowrap"},children:(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.paymentStatus)||"Un Paid"}),Object(ae.jsx)(D.a,{align:"center",size:"small",style:{whiteSpace:"nowrap"},children:Object(ae.jsx)(b.a,{direction:"row",alignItems:"center",justifyContent:"center",spacing:2,children:Object(ae.jsx)(P.a,{variant:"contained",color:"primary",onClick:function(){var t,n;de(Object(te.c)(Object(i.a)(Object(i.a)({},null===e||void 0===e?void 0:e.data),{},{bookingPickupDate:null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.bookingPickupDate.toDate(),bookingReturnDate:null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.bookingReturnDate.toDate()}))),zt(!0)},children:Object(ae.jsx)(ee.a,{icon:"carbon:view"})})})}),Object(ae.jsx)(D.a,{size:"small",align:"center",style:{whiteSpace:"nowrap"},children:(null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.bookingId)||""}),Object(ae.jsx)(D.a,{size:"small",align:"center",style:{whiteSpace:"nowrap"},children:R()(null===e||void 0===e||null===(c=e.data)||void 0===c?void 0:c.dateCreated.toDate()).format("DD-MM-YYYY, HH:MM:ss")}),Object(ae.jsx)(D.a,{size:"small",align:"center",style:{whiteSpace:"nowrap"},children:Object(ae.jsx)(j.a,{variant:"contained",color:"primary",onClick:function(){return function(e){return ft.apply(this,arguments)}(null===e||void 0===e?void 0:e.id)},disabled:Number(null===e||void 0===e||null===(o=e.data)||void 0===o?void 0:o.docRemainingPaymentAmt)<Number(null===e||void 0===e||null===(l=e.data)||void 0===l?void 0:l.bookingTotalAmount)&&Number(null===e||void 0===e||null===(r=e.data)||void 0===r?void 0:r.docRemainingPaymentAmt)>0||0===Number(null===e||void 0===e||null===(s=e.data)||void 0===s?void 0:s.docRemainingPaymentAmt),children:"Make full payment"})}),Object(ae.jsx)(D.a,{size:"small",align:"center",style:{whiteSpace:"nowrap"},children:Object(ae.jsx)(j.a,{variant:"contained",color:"primary",onClick:function(){ct(null===e||void 0===e?void 0:e.id),ht(!0)},disabled:0===Number(null===e||void 0===e||null===(u=e.data)||void 0===u?void 0:u.docRemainingPaymentAmt),children:"Add partial-payment"})}),Object(ae.jsx)(D.a,{size:"small",align:"center",style:{whiteSpace:"nowrap"},children:(null===e||void 0===e||null===(m=e.data)||void 0===m?void 0:m.clientName)||""}),Object(ae.jsx)(D.a,{size:"small",align:"center",style:{whiteSpace:"nowrap"},children:Object(ae.jsx)(X.a,{value:Number((null===e||void 0===e||null===(p=e.data)||void 0===p?void 0:p.bookingTotalAmount)||0).toFixed(2),displayType:"text",thousandSeparator:!0})}),Object(ae.jsx)(D.a,{size:"small",align:"center",style:{whiteSpace:"nowrap",background:0===Number((null===e||void 0===e?void 0:e.docRemainingPaymentAmt)||0)?"#C6FEBE":Number((null===e||void 0===e?void 0:e.docRemainingPaymentAmt)||0)<0?"#FEC3BE":"#FEFEBE"},children:Number((null===e||void 0===e?void 0:e.docRemainingPaymentAmt)||0).toFixed(2)}),Object(ae.jsx)(D.a,{size:"small",align:"center",style:{whiteSpace:"nowrap"},children:null!==e&&void 0!==e&&null!==(h=e.data)&&void 0!==h&&h.attachedPaymentNumber&&(null===e||void 0===e||null===(O=e.data)||void 0===O||null===(x=O.attachedPaymentNumber)||void 0===x?void 0:x.length)>0?null===e||void 0===e||null===(g=e.data)||void 0===g||null===(y=g.attachedPaymentNumber)||void 0===y?void 0:y.map((function(t,n){var a,i,c;return Object(ae.jsxs)(d.Fragment,{children:[Object(ae.jsxs)(b.a,{direction:"row",alignItems:"center",children:[Object(ae.jsx)(P.a,{onClick:function(){var n,a;return function(e,t,n,a,i){return yt.apply(this,arguments)}(t,null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.attachedPaymentNumber,null===e||void 0===e?void 0:e.docRemainingPaymentAmt,null===e||void 0===e?void 0:e.id,null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.bookingTotalAmount)},disabled:!(null!==oe&&void 0!==oe&&null!==(a=oe.permissions)&&void 0!==a&&null!==(i=a.deleteFullPartialPaymentChk)&&void 0!==i&&null!==(c=i.assignedCompanyId)&&void 0!==c&&c.includes(null===je||void 0===je?void 0:je.id)),children:Object(ae.jsx)(K.a,{color:"error"})}),Object(ae.jsx)(v.a,{children:"Date: ".concat(null===t||void 0===t?void 0:t.paymentDate,", Payment: ").concat(Number(null===t||void 0===t?void 0:t.paymentAmount).toFixed(2))})]}),Object(ae.jsx)(N.a,{})]},n)})):"No recent payment made"}),Object(ae.jsx)(D.a,{size:"small",align:"center",style:{whiteSpace:"nowrap"},children:Object(ae.jsx)(j.a,{variant:"contained",color:"primary",onClick:function(){var t;Ye(!0),Ie({invoiceId:null===e||void 0===e?void 0:e.id,invoiceScreenshotData:(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.invoiceScreenshotData)||null,invoiceData:Object(i.a)({},null===e||void 0===e?void 0:e.data)})},children:"upload/view"})})]},t)})))})]})})]})})]})})})]})}),Fe?Object(ae.jsx)(ae.Fragment,{children:Object(ae.jsxs)(C.a,{open:Fe,onClose:function(){Ye(!1),Ie(null)},fullWidth:!0,maxWidth:"md",children:[Object(ae.jsx)(A.a,{children:"Payment screenshots"}),Object(ae.jsxs)(T.a,{children:[Object(ae.jsx)("br",{}),Object(ae.jsxs)(v.a,{children:["Upload Screenshot"," ",Object(ae.jsx)("span",{style:{color:"red"},children:"(Max Size of 25 KB)"}),":"," "]}),Object(ae.jsx)(m.a,{className:"uploadInput",variant:"outlined",size:"small",fullWidth:!0,name:"image",type:"file",id:"image",accept:".png,.jpeg",onChange:function(e){return Dt(e)}}),Object(ae.jsx)("br",{}),Object(ae.jsx)("br",{}),Object(ae.jsx)(y.a,{children:Object(ae.jsxs)(f.a,{border:1,children:[Object(ae.jsx)(k.a,{children:Object(ae.jsxs)(w.a,{children:[Object(ae.jsx)(D.a,{size:"small",children:"Date"}),Object(ae.jsx)(D.a,{size:"small",children:"View"}),Object(ae.jsx)(D.a,{size:"small",children:"Delete"})]})}),Object(ae.jsx)(S.a,{children:(null===Be||void 0===Be?void 0:Be.invoiceScreenshotData)&&(null===Be||void 0===Be||null===(t=Be.invoiceScreenshotData)||void 0===t?void 0:t.length)>0&&(null===Be||void 0===Be||null===(n=Be.invoiceScreenshotData)||void 0===n?void 0:n.map((function(e,t){return Object(ae.jsxs)(w.a,{children:[Object(ae.jsx)(D.a,{size:"small",children:(null===e||void 0===e?void 0:e.dateString)||""}),Object(ae.jsx)(D.a,{size:"small",children:null!==e&&void 0!==e&&e.screenshotUrl&&""!==(null===e||void 0===e?void 0:e.screenshotUrl)?Object(ae.jsx)(j.a,{variant:"contained",color:"primary",href:"".concat(null===e||void 0===e?void 0:e.screenshotUrl),target:"_blank",children:"open"}):Object(ae.jsx)(v.a,{children:"No url found"})}),Object(ae.jsx)(D.a,{size:"small",children:Object(ae.jsx)(j.a,{variant:"contained",color:"error",onClick:function(){return function(e){return St.apply(this,arguments)}(e)},children:"delete"})})]},t)})))})]})})]}),Object(ae.jsx)(z.a,{children:Object(ae.jsx)(j.a,{onClick:function(){Ye(!1),Ie(null)},variant:"contained",color:"error",children:"Close"})})]})}):Object(ae.jsx)(ae.Fragment,{}),Ue?Object(ae.jsx)(ae.Fragment,{children:Object(ae.jsxs)(C.a,{open:Ue,onClose:function(){We(!1),Ke(!1),tt(null)},fullWidth:!0,maxWidth:"md",children:[Object(ae.jsx)(A.a,{children:"Expenses"}),Object(ae.jsxs)(T.a,{children:[Object(ae.jsx)("br",{}),!Je&&Object(ae.jsx)(j.a,{onClick:function(){return Ke(!0)},variant:"contained",color:"primary",children:"Add expense"}),Je&&Object(ae.jsxs)(u.a,{container:!0,spacing:3,children:[Object(ae.jsx)(u.a,{item:!0,xs:12,md:12,children:Object(ae.jsx)(m.a,{variant:"outlined",size:"small",fullWidth:!0,name:"expenseAmount",type:"text",id:"expenseAmount",label:"Expense amount",onChange:function(e){Ge(Object(i.a)(Object(i.a)({},Ze),{},{expenseAmt:e.target.value}))},required:!0})}),Object(ae.jsx)(u.a,{item:!0,xs:12,md:12,children:Object(ae.jsx)(m.a,{variant:"outlined",size:"small",fullWidth:!0,name:"expenseDesc",type:"text",id:"expenseDesc",label:"Expense description",onChange:function(e){Ge(Object(i.a)(Object(i.a)({},Ze),{},{expenseDesc:e.target.value}))},required:!0})}),Object(ae.jsxs)(u.a,{item:!0,xs:12,md:12,children:[Object(ae.jsxs)(v.a,{children:["Upload expense"," ",Object(ae.jsx)("span",{style:{color:"red"},children:"(Max Size of 25 KB)"}),":"," "]}),Object(ae.jsx)(m.a,{className:"uploadInput",variant:"outlined",size:"small",fullWidth:!0,name:"image",type:"file",id:"image",accept:".png,.jpeg,.pdf",onChange:function(e){return function(e){if(e.target.files&&e.target.files.length>0){var t,n=(new Date).toISOString(),a="/expense/".concat(null===je||void 0===je?void 0:je.id,"/").concat(null===et||void 0===et||null===(t=et.invoiceData)||void 0===t?void 0:t.docType,"/").concat(n),c=e.target.files[0];Ge(Object(i.a)(Object(i.a)({},Ze),{},{dateString:n,expenseStoragePath:a,expenseFile:c}))}}(e)}})]}),Object(ae.jsx)(u.a,{item:!0,xs:12,md:12,children:Object(ae.jsx)(j.a,{onClick:function(){return function(){return Pt.apply(this,arguments)}()},variant:"contained",color:"primary",disabled:!(null!==Ze&&void 0!==Ze&&Ze.expenseAmt)||!(null!==Ze&&void 0!==Ze&&Ze.expenseDesc)||!(null!==oe&&void 0!==oe&&null!==(l=oe.permissions)&&void 0!==l&&l.addExpense),children:"add expense"})})]}),Object(ae.jsx)("br",{}),Object(ae.jsx)("br",{}),Object(ae.jsx)(y.a,{children:Object(ae.jsxs)(f.a,{border:1,children:[Object(ae.jsx)(k.a,{children:Object(ae.jsxs)(w.a,{children:[Object(ae.jsx)(D.a,{size:"small",style:{whiteSpace:"nowrap"},children:"Date"}),Object(ae.jsx)(D.a,{size:"small",style:{whiteSpace:"nowrap"},children:"Amount"}),Object(ae.jsx)(D.a,{size:"small",style:{whiteSpace:"nowrap"},children:"Description"}),Object(ae.jsx)(D.a,{size:"small",style:{whiteSpace:"nowrap"},children:"View uploaded image"}),Object(ae.jsx)(D.a,{size:"small",style:{whiteSpace:"nowrap"},children:"Delete"})]})}),Object(ae.jsx)(S.a,{children:(null===et||void 0===et||null===(M=et.invoiceData)||void 0===M?void 0:M.invoiceExpensetData)&&(null===et||void 0===et||null===(q=et.invoiceData)||void 0===q||null===(J=q.invoiceExpensetData)||void 0===J?void 0:J.length)>0&&(null===et||void 0===et||null===(G=et.invoiceData)||void 0===G||null===(ce=G.invoiceExpensetData)||void 0===ce?void 0:ce.map((function(e,t){var n;return Object(ae.jsxs)(w.a,{children:[Object(ae.jsx)(D.a,{size:"small",style:{whiteSpace:"nowrap"},children:(null===e||void 0===e?void 0:e.dateString)||e.timestamp&&R()(e.timestamp.toDate()).format("DD-MM-YYYY, HH:MM:ss")||""}),Object(ae.jsx)(D.a,{size:"small",style:{whiteSpace:"nowrap"},children:Object(ae.jsx)(X.a,{value:Math.round(Number((null===e||void 0===e?void 0:e.expenseAmt)||0)),displayType:"text",thousandSeparator:!0})}),Object(ae.jsx)(D.a,{size:"small",style:{whiteSpace:"nowrap"},children:(null===e||void 0===e?void 0:e.expenseDesc)||""}),Object(ae.jsx)(D.a,{size:"small",style:{whiteSpace:"nowrap"},children:null!==e&&void 0!==e&&e.expenseUrl&&""!==(null===e||void 0===e?void 0:e.expenseUrl)?Object(ae.jsx)(j.a,{variant:"contained",color:"primary",href:"".concat(null===e||void 0===e?void 0:e.expenseUrl),target:"_blank",children:"open"}):Object(ae.jsx)(v.a,{children:"No url found"})}),Object(ae.jsx)(D.a,{size:"small",style:{whiteSpace:"nowrap"},children:Object(ae.jsx)(P.a,{onClick:function(){!function(e,t){Nt.apply(this,arguments)}(e,t)},disabled:!(null!==oe&&void 0!==oe&&null!==(n=oe.permissions)&&void 0!==n&&n.deleteExpense),color:"error",children:Object(ae.jsx)(K.a,{})})})]},t)})))})]})})]}),Object(ae.jsx)(z.a,{children:Object(ae.jsx)(j.a,{onClick:function(){We(!1),Ke(!1),tt(null)},variant:"contained",color:"error",children:"Close"})})]})}):Object(ae.jsx)(ae.Fragment,{}),pt?Object(ae.jsx)(ae.Fragment,{children:Object(ae.jsxs)(C.a,{open:pt,onClose:function(){ct(""),dt(""),jt(""),ht(!1)},fullWidth:!0,maxWidth:"sm",children:[Object(ae.jsx)(A.a,{children:"Add partial payment"}),Object(ae.jsxs)(T.a,{children:[Object(ae.jsx)("br",{}),Object(ae.jsxs)(b.a,{spacing:3,children:[Object(ae.jsx)(m.a,{variant:"outlined",name:"payment",label:"Payment amount",id:"payment",type:"text",value:rt||"",size:"small",fullWidth:!0,onChange:function(e){return dt(e.target.value)},required:!0}),Object(ae.jsxs)(h.a,{fullWidth:!0,variant:"outlined",size:"small",style:{background:Number(rt||0)>0&&""===bt?"#FEFEBE":"transparent"},disabled:!rt||0===Number(rt||0)||Number(rt||0)<0,children:[Object(ae.jsx)(O.a,{required:!0,id:"paymentType-select-label",children:"Choose type"}),Object(ae.jsxs)(x.a,{required:!0,labelId:"paymentType-select-label",label:"Choose type",value:bt||"",onChange:function(e){jt(e.target.value)},children:[Object(ae.jsx)(g.a,{value:"",children:"Choose a payment type"}),Object(ae.jsx)(g.a,{value:"cheque",children:"Cheque"}),Object(ae.jsx)(g.a,{value:"cash",children:"Cash"}),Object(ae.jsx)(g.a,{value:"JUICE",children:"JUICE"}),Object(ae.jsx)(g.a,{value:"Bank Transfer",children:"Bank Transfer"})]})]})]})]}),Object(ae.jsxs)(z.a,{children:[Object(ae.jsx)(j.a,{onClick:function(){return function(){if(Oe&&(null===Oe||void 0===Oe?void 0:Oe.length)>0){de(Object(I.d)(!0));var e=[];Oe.forEach((function(t){var n;if((null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.bookingId)===it){var a,c,o,l,r,d=0,s="";(d=Number((null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.docRemainingPaymentAmt)||0)>0?Number((null===t||void 0===t||null===(l=t.data)||void 0===l?void 0:l.docRemainingPaymentAmt)||0)-Number(rt):Number((null===t||void 0===t||null===(r=t.data)||void 0===r?void 0:r.bookingTotalAmount)||0)-Number(rt))===Number((null===t||void 0===t||null===(c=t.data)||void 0===c?void 0:c.bookingTotalAmount)||0)?s="Unpaid":0!==d&&d<Number((null===t||void 0===t||null===(o=t.data)||void 0===o?void 0:o.bookingTotalAmount)||0)?s="Partially paid":d<0?s="Over paid":0===d&&(s="Paid"),e.push(Object(i.a)(Object(i.a)({},t),{},{paymentAmount:rt,paymentType:bt,data:Object(i.a)(Object(i.a)({},t.data),{},{paymentStatus:s}),docRemainingPaymentAmt:d}))}}));var t=Q.b.collection("company").doc(je.id).collection("payment").doc("paymentCounter");Q.b.runTransaction(function(){var e=Object(c.a)(r.a.mark((function e(n){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.get(t).then((function(e){return e.exists?Number(e.data().paymentCounter||0)+1:null})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then(function(){var t=Object(c.a)(r.a.mark((function t(n){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==n){t.next=5;break}return t.next=3,Q.b.collection("company").doc(je.id).collection("payment").doc("paymentCounter").set({paymentCounter:1}).then((function(){gt(1,e)})).catch((function(e){se("Error occured while creating payment counter: ".concat(null===e||void 0===e?void 0:e.message),{variant:"error"}),de(Object(I.d)(!1))}));case 3:t.next=6;break;case 5:n&&Number(n)>0&&gt(n,e);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){se("Error occured while executing payment transaction: ".concat(null===e||void 0===e?void 0:e.message),{variant:"error"}),de(Object(I.d)(!1))}))}}()},variant:"contained",color:"primary",disabled:!it||!rt||!bt,children:"Add"}),Object(ae.jsx)(j.a,{onClick:function(){ct(""),dt(""),jt(""),ht(!1)},variant:"contained",color:"error",children:"Close"})]})]})}):Object(ae.jsx)(ae.Fragment,{}),Tt?Object(ae.jsx)(ne.a,{open:Tt,setOpen:zt,fetchBooking:Ot,viewOnly:!0}):Object(ae.jsx)(ae.Fragment,{})]})}}}]);
//# sourceMappingURL=35.ccff70d9.chunk.js.map