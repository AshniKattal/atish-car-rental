(this["webpackJsonp@minimal/minimal-kit-react"]=this["webpackJsonp@minimal/minimal-kit-react"]||[]).push([[65],{1834:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return p}));var o=n(9),i=n(27),a=n(6),r=n(3),c=n.n(r),_=n(701),d=n(52),E=n(68),A=n(472),l=n(250),s=n(118),u=n(49),P=n(134),T=n(72),R=n(69),C=n.n(R),v=n(0);function p(e){var t=e.originalDocParticulars,n=e.documentDetails,r=e.savedDescriptions,R=e.us_s_quotationNumber,p=e.us_s_purchaseOrderNumber,m=e.set_us_showViewDocument,S=e.refreshTable,O=e.fetchDescription,I=e.displayDiscountColumns,N=e.partialPaymentAmount,f=Object(T.a)().user,D=Object(s.b)().enqueueSnackbar,h=Object(d.b)(),b=Object(d.c)(A.b),L=b.documentType,g=b.companyIdSelected,y=b.companyDetails,M=b.clientDocumentObjectSelected,B=n.docCustomIdNumber,V=n.docBillTo,x=n.docShipTo,w=n.docDate,U=n.docParticulars,Y=n.docSubTotal,k=n.docVatFee,H=n.docTotal,j=n.docTermsAndCondition,K=n.docBLNumber,G=n.docSupplier,F=n.docContainerNumber,W=n.docPackages,Z=n.docDescription,z=n.docGrossWeight,q=n.docVolume,X=n.docPortOfLoading,Q=n.docETA,J=n.docVesselName,$=n.docRoE,ee=n.docPlaceOfLanding,te=n.transactionType,ne=n.personType,oe=n.invoiceTypeDesc,ie=n.invoiceRefIdentifier,ae=n.downPayment,re=n.downPaymentInvoiceNumber,ce=n.discountTotalAmount,_e=n.discountedTotalAmount,de=n.docSalesTransaction,Ee=n.docReasonStated,Ae=n.docTotalTaxableWithoutVatParticulars,le=n.docTotalTaxableVatOnlyParticulars,se=n.docTotalTaxableParticulars,ue=n.docTotalZeroRatedParticulars,Pe=n.docTotalExemptParticulars,Te=n.docTotalDisbursementParticulars,Re=n.docTotalExemptBodiesParticulars,Ce=n.docDisbursementParticularsData,ve=n.invJobRef,pe=n.invStorageFee,me=n.invScanningFee,Se=n.invGatePassFee,Oe=n.invVehicleNo,Ie=n.transportFees,Ne=n.transportDesc,fe=n.invApplyVat,De=n.docShipper,he=n.docMarkNos,be=n.docCommodity,Le=n.docHbl,ge=n.docDepot;function ye(){return ye=Object(a.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h(Object(E.d)(!0)),!B){e.next=8;break}return e.next=4,Object(l.d)(B,g,null===L||void 0===L?void 0:L.id);case 4:null!==(t=e.sent)&&void 0!==t&&t.error?D(null===t||void 0===t?void 0:t.message,{variant:"error"}):(h(Object(E.d)(!0)),Me(null===t||void 0===t?void 0:t.documentNumber,null===t||void 0===t?void 0:t.documentNumberDocString)),e.next=10;break;case 8:n=u.b.collection("company").doc(g).collection(null===L||void 0===L?void 0:L.id).doc("documentIndex"),u.b.runTransaction((function(e){return e.get(n).then((function(t){if(!t.exists)return e.update(n,{documentIndex:1}),1;var o=Number(t.data().documentIndex)+1;return e.update(n,{documentIndex:o}),o}))})).then(function(){var e=Object(a.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(l.h)(t);case 2:(n=e.sent)&&Me(t,n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){D("Error occured while overall Invoice saving transactions: ".concat(null===e||void 0===e?void 0:e.message),{variant:"error"}),h(Object(E.d)(!1))}));case 10:case"end":return e.stop()}}),e)}))),ye.apply(this,arguments)}function Me(e,t){return Be.apply(this,arguments)}function Be(){return Be=Object(a.a)(c.a.mark((function e(n,_){var d,A,s,T,C,v,b,ye,Me,Be,xe,we,Ue,Ye,ke,He,je,Ke,Ge;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Be=new Date,xe=[],we="","quotation"===(null===L||void 0===L?void 0:L.id)){e.next=7;break}return e.next=6,Object(l.q)(g);case 6:we=e.sent;case 7:return Ue=[],"transport"===(null===y||void 0===y||null===(d=y.data)||void 0===d?void 0:d.documentTemplate)?(Ye=[],(null===U||void 0===U?void 0:U.length)>0&&U.forEach(function(){var e=Object(a.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:""!==(null===t||void 0===t?void 0:t.customDetail)?(n=[].concat(Object(i.a)(null===t||void 0===t?void 0:t.valueList),[null===t||void 0===t?void 0:t.customDetail]),(n=Object(i.a)(new Set(n))).sort(),Ye.push(Object(o.a)(Object(o.a)({},t),{},{valueList:n})),Ue.push(Object(o.a)(Object(o.a)({},t),{},{valueList:[]}))):(Ye.push(Object(o.a)({},t)),Ue.push(Object(o.a)(Object(o.a)({},t),{},{valueList:[]})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),0===(null===t||void 0===t?void 0:t.length)?(null===Ye||void 0===Ye?void 0:Ye.length)>0&&Ye.forEach(function(){var e=Object(a.a)(c.a.mark((function e(t){var n,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=[],null!==t&&void 0!==t&&t.valueList&&(null===t||void 0===t||null===(n=t.valueList)||void 0===n?void 0:n.length)>0&&(o=Object(i.a)(new Set(null===t||void 0===t?void 0:t.valueList))).sort(),e.next=4,u.b.collection("company").doc(g).collection("particulars").add({orderNum:(null===t||void 0===t?void 0:t.orderNum)||"",title:(null===t||void 0===t?void 0:t.title)||"",customDetail:(null===t||void 0===t?void 0:t.customDetail)||"",selectedValue:(null===t||void 0===t?void 0:t.selectedValue)||"",valueList:o,isChecked:(null===t||void 0===t?void 0:t.isChecked)||!1,amount:(null===t||void 0===t?void 0:t.amount)||""});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()):(null===Ye||void 0===Ye?void 0:Ye.length)>0&&Ye.forEach(function(){var e=Object(a.a)(c.a.mark((function e(t){var n,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===t||void 0===t||!t.id||""===(null===t||void 0===t?void 0:t.id)){e.next=5;break}return a=[],null!==t&&void 0!==t&&t.valueList&&(null===t||void 0===t||null===(n=t.valueList)||void 0===n?void 0:n.length)>0&&(a=Object(i.a)(new Set(null===t||void 0===t?void 0:t.valueList))).sort(),e.next=5,u.b.collection("company").doc(g).collection("particulars").doc(null===t||void 0===t?void 0:t.id).update(Object(o.a)(Object(o.a)({},t),{},{valueList:a}),{merge:!0});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())):"transport"!==(null===y||void 0===y||null===(A=y.data)||void 0===A?void 0:A.documentTemplate)&&(ke="",U.map((function(e){return(null===e||void 0===e?void 0:e.rowDescription)||""})).forEach(function(){var e=Object(a.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||""===t){e.next=5;break}if(ke=ke+" "+t,null!==r&&void 0!==r&&r.find((function(e){return(null===e||void 0===e?void 0:e.description)===t}))){e.next=5;break}return e.next=5,u.b.collection("company").doc(g).collection("saved_descriptions").add({text:t});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ke&&(He=ke.split(" "),je=[],He.forEach((function(e){je.push(e.toLowerCase())})),xe=[].concat(je,[n.toString(),_])),xe=Object(i.a)(new Set(xe))),Ke={ebsGlobalInvoiceCounterReached:"quotation"===(null===L||void 0===L?void 0:L.id)?null:we,id:n.toString(),docString:_,docCustomIdNumber:B,docTitle:null===L||void 0===L?void 0:L.title,docType:null===L||void 0===L?void 0:L.id,clientId:null===M||void 0===M?void 0:M.id,docDate:P.a.firestore.Timestamp.fromDate(new Date(w)),docDateTimeCreated:P.a.firestore.FieldValue.serverTimestamp(),docIssuedDateTime:Be,docParticulars:"transport"===(null===y||void 0===y||null===(s=y.data)||void 0===s?void 0:s.documentTemplate)?Ue:U,docSubTotal:Y,docVatFee:k,docTotal:H,docShipTo:x,docBillTo:V,docTermsAndCondition:j||"",paymentStatus:"Unpaid",docRemainingPaymentAmt:H,attachedPaymentNumber:[],docQuoteNumber:R||"",docPurchaseOrderNumber:p||"",keywords:xe,transactionType:te||null,personType:ne||null,invoiceTypeDesc:oe||null,invoiceRefIdentifier:ie||"",downPayment:ae||0,downPaymentInvoiceNumber:re||"",discountTotalAmount:ce||0,discountedTotalAmount:_e||0,docSalesTransaction:de||null,docReasonStated:Ee||"",displayDiscountColumns:I||!1,createdByUserId:(null===f||void 0===f?void 0:f.id)||"",createdByUserEmail:(null===f||void 0===f?void 0:f.email)||"",createdByUserTime:new Date},"transport"===(null===y||void 0===y||null===(T=y.data)||void 0===T?void 0:T.documentTemplate)?Ke=Object(o.a)(Object(o.a)({},Ke),{},{invJobRef:ve||"",invStorageFee:pe||"",invScanningFee:me||"",invGatePassFee:Se||"",invVehicleNo:Oe||"",transportFees:Ie||"",transportDesc:Ne||"",invApplyVat:fe||!1}):"flexitrans"===(null===y||void 0===y||null===(C=y.data)||void 0===C?void 0:C.documentTemplate)?Ke=Object(o.a)(Object(o.a)({},Ke),{},{docBLNumber:K||"",docSupplier:G||"",docContainerNumber:F||"",docPackages:W||"",docDescription:Z||"",docGrossWeight:z||"",docVolume:q||"",docPortOfLoading:X||"",docETA:Q||"",docVesselName:J||"",docRoE:$||"",docPlaceOfLanding:ee||"",docTotalTaxableWithoutVatParticulars:Ae||"",docTotalTaxableVatOnlyParticulars:le||"",docTotalTaxableParticulars:se||"",docTotalZeroRatedParticulars:ue||"",docTotalExemptParticulars:Pe||"",docTotalDisbursementParticulars:Te||"",docTotalExemptBodiesParticulars:Re||"",docDisbursementParticularsData:Ce||[],docShipper:De||"",docMarkNos:he||"",docCommodity:be||"",docHbl:Le||"",docDepot:ge||""}):(null===y||void 0===y?void 0:y.id)!==Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_PROTECTED_COMPANY:"d49MsS8JbYcUnff60n0E",REACT_APP_PROTECTED_USER:"Baelzs07ToMHTlIPzsHqjMZLBL72",REACT_APP_CUSTOM_REQUIREMENT_WORLDLINK_EXAMPLE:'["9VNEXj9ahhngQ3U8oQ4i"]',REACT_APP_EBS_MRA_ID:"17128123218161EW4CBZY12Y",REACT_APP_EBS_MRA_USERNAME:"Oudish",REACT_APP_EBS_MRA_PASSWORD:"Ash124Ash124",REACT_APP_EBS_MRA_REFRESH_TOKEN_PARAM:"FALSE",REACT_APP_EBS_MRA_TOKEN_ENDPOINT:"https://vfisc.mra.mu/einvoice-token-service/token-api/generate-token",REACT_APP_EBS_TRANSACTION_TYPES:'[{"id": "B2B","type": "(B2B) Business to Business"},{"id": "B2G","type": "(B2G) Business to Government"},{"id": "B2C","type": "(B2C) Business to Consumer"},{"id": "EXP","type": "(EXP) Zero rated supplies - Exports"},{"id": "B2E","type": "(B2E) Taxable supplies made to exempt bodies or persons"}]',REACT_APP_EBS_VAT_OR_NON_VAT_REGISTERED_VALUES:'[{"id":"VATR","title":"VAT Registered"},{"id":"NVTR","title":"Non VAT Registered"}]',REACT_APP_EBS_BUYER_TYPE_VALUES:'[{"id":"VATR","title":"VAT Registered Person"},{"id":"NVTR","title":"Non VAT Registered Person"},{"id":"EXMP","title":"Exempt Person"}]',REACT_APP_EBS_TAX_CODE_VALUES:'[{"id":"TC01","title":"(T) Taxable rate - 15%"},{"id":"TC02","title":"(Z) Zero rated"},{"id":"TC03","title":"(E) Exempt"},{"id":"TC04","title":"(D - Disbursement) Non fiscal items not affecting turnover"},{"id":"TC05","title":"(TEB) Standard rated supplies made to exempt bodies or persons"}]',REACT_APP_EBS_NATURE_VALUES:'[{"id":"GOODS","title":"Goods"},{"id":"SERVICES","title":"Services"}]',REACT_APP_EBS_SALES_TRANSACTION_VALUES:'[{"id":"CASH","title":"CASH (Cash/Bank Transfers/Cheques/Cards/Other)"},{"id":"CREDIT","title":"Credit"}]',REACT_APP_PARTICULAR_DESC_OPTIONS:'["Gate Pass", "Landing Charges"]',REACT_APP_EBS_INVOICE_TYPE_DESC_INVOICE:'[{"id": "STD","type": "Standard"},{"id": "TRN","type": "Training"}]',REACT_APP_EBS_INVOICE_TYPE_DESC_CREDIT_NOTE:'[{"id": "CRN","type": "Credit"}]',REACT_APP_EBS_INVOICE_TYPE_DESC_DEBIT_NOTE:'[{"id": "DRN","type": "Debit"}]',REACT_APP_EBS_INVOICE_TYPE_DESC_PROFORMA:'[{"id": "PRF","type": "Proforma"}]',REACT_APP_DOCUMENT_TEMPLATES:'["std", "transport", "slarks", "smart_promote", "flexitrans"]',REACT_APP_EMAILJS_PUBLIC_KEY:"GSb72AhjTKPF-1qEF",REACT_APP_CONVERT_API_SECRET:"13cZcSaMcOWpV9lI",REACT_APP_ADMIN_EMAIL:"contact@fertositeweb.com",REACT_APP_ADMIN_EMAIL_SERVICE_KEY:"service_4u2qlcp",REACT_APP_REGISTRATION_FORM_TEMPLATE_KEY:"template_gtoask8",REACT_APP_INQUIRY_FORM_TEMPLATE_KEY:"template_u6twrz9",REACT_APP_SOA_TEMPLATE_KEY:"template_0p7wave",REACT_APP_SOFTWARE_NAME:"Reaching Heights Ltd",REACT_APP_OWNER_CAR_RENTAL_ATISH:"carrentalatish",REACT_APP_OWNER:"carrentalatish",REACT_APP_VERSION:"4.1.7",REACT_APP_API_KEY:"AIzaSyDYknQfnmlUF6VJPhU9d0yFgf1ZKmGtuEA",REACT_APP_AUTH_DOMAIN:"car-rental-39926.firebaseapp.com",REACT_APP_PROJECT_ID:"car-rental-39926",REACT_APP_STORAGE_BUCKET:"car-rental-39926.appspot.com",REACT_APP_MESSAGING_SENDER_ID:"398655009731",REACT_APP_APP_ID:"1:398655009731:web:fa32fd1360970c0f1e8376",REACT_APP_MEASUREMENT_ID:"G-68J9VBEQEP",REACT_APP_DISTRICT:'["Flacq","Grand Port","Moka","Pamplemousses","Plaines Wilhems","Port Louis","Rivi\xe8re du Rempart","Rivi\xe8re Noire","Savanne"]',REACT_APP_GOOGLE_MAP_API_KEY:"AIzaSyAuUzKzg8D3zZkgeEz7oXFwBDnMulZX26I",REACT_APP_COLLECTION_STORES:"stores",REACT_APP_COLLECTION_SERVICES:"services",REACT_APP_COLLECTION_VEHICLES:"vehicles",REACT_APP_CURRENCY_USED:"\u20ac",REACT_APP_ICON_180:"/favicon/carrental/apple-touch-icon.png",REACT_APP_ICON_32:"/favicon/carrental/favicon-32x32.png",REACT_APP_ICON_16:"/favicon/carrental/favicon-16x16.png",REACT_APP_TITLE:"Reaching Heights Ltd",REACT_APP_DESCRIPTION:"Car Rental platform",REACT_APP_KEYWORDS:"Reaching Heights Ltd,RHL,car-rental,Car Rental",REACT_APP_AUTHOR:"Reaching Heights Ltd",REACT_APP_RHL_ID:"5HAEgHE1kKox9ZdweP3I",REACT_APP_COMPANY_ID:"5HAEgHE1kKox9ZdweP3I",REACT_APP_COMPANY_NAME:"REACHING HEIGHTS LTD",REACT_APP_SERVICE_KEY:"service_ishhonm",REACT_APP_TEMPLATE_KEY:"template_u6twrz9",REACT_APP_EMAIL:"info@reachingheightsltd.com",REACT_APP_LIGHTER:"#B3C3E8",REACT_APP_LIGHT:"#5381ED",REACT_APP_MAIN:"#333333",REACT_APP_DARK:"#1441A8",REACT_APP_DARKER:"#0D2A6E"}).REACT_APP_CUSTOM_SMART_PROMOTE_ID||"proforma"!==(null===(v=Ke)||void 0===v?void 0:v.docType)&&"invoice"!==(null===(b=Ke)||void 0===b?void 0:b.docType)&&"vat_invoice"!==(null===(ye=Ke)||void 0===ye?void 0:ye.docType)&&"cash_transaction"!==(null===(Me=Ke)||void 0===Me?void 0:Me.docType)||Object(i.a)((null===(Ge=Ke)||void 0===Ge?void 0:Ge.docParticulars)||[]).forEach(function(){var e=Object(a.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===t||void 0===t||!t.inventoryItemData){e.next=3;break}return e.next=3,u.b.collection("company").doc(null===y||void 0===y?void 0:y.id).collection("inventory").doc(null===t||void 0===t||null===(n=t.inventoryItemData)||void 0===n?void 0:n.id).get().then(function(){var e=Object(a.a)(c.a.mark((function e(n){var o,r,_,d,E,A,l,s,P,T,R,C,v,p,m,S,O,I,N,f;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.exists){e.next=15;break}return v=Number((null===n||void 0===n||null===(o=n.data())||void 0===o?void 0:o.qtyRemaining)||0),p=Number((null===t||void 0===t?void 0:t.rowQty)||0),m=v-p,S=p+Number((null===n||void 0===n||null===(r=n.data())||void 0===r?void 0:r.qtySold)||0),O=Object(i.a)((null===n||void 0===n||null===(_=n.data())||void 0===_?void 0:_.allInventoryItemTransactions)||[]),I=0,fe&&(I=1.15*Number((null===t||void 0===t?void 0:t.rowDiscountedAmount)||(null===t||void 0===t?void 0:t.rowAmount)||0)),O.push({documentNumber:null===(d=Ke)||void 0===d?void 0:d.id,docString:null===(E=Ke)||void 0===E?void 0:E.docString,docCustomIdNumber:null===(A=Ke)||void 0===A?void 0:A.docCustomIdNumber,docTitle:null===(l=Ke)||void 0===l?void 0:l.docTitle,docType:null===(s=Ke)||void 0===s?void 0:s.docType,docDate:new Date,actualRemainingStockAmount:v,itemQtySold:p,itemId:null===t||void 0===t||null===(P=t.inventoryItemData)||void 0===P?void 0:P.id,rowAmount:(null===t||void 0===t?void 0:t.rowAmount)||0,rowDiscountAmount:(null===t||void 0===t?void 0:t.rowDiscountAmount)||0,rowDiscountedAmount:(null===t||void 0===t?void 0:t.rowDiscountedAmount)||0,rowAmountWithVAT:I,rowUnitPrice:(null===t||void 0===t?void 0:t.rowUnitPrice)||0}),N=Number((null===n||void 0===n||null===(T=n.data())||void 0===T?void 0:T.totalAmountReceivedWithoutVAT)||0)+Number((null===t||void 0===t?void 0:t.rowDiscountedAmount)||(null===t||void 0===t?void 0:t.rowAmount)||0),f=Number((null===n||void 0===n||null===(R=n.data())||void 0===R?void 0:R.totalAmountReceivedWithVAT)||0)+I,e.next=13,u.b.collection("company").doc(null===y||void 0===y?void 0:y.id).collection("inventory").doc(null===t||void 0===t||null===(C=t.inventoryItemData)||void 0===C?void 0:C.id).set({totalAmountReceivedWithoutVAT:Number(N||0).toFixed(2),totalAmountReceivedWithVAT:Number(f||0).toFixed(2),qtySold:S||0,qtyRemaining:m||0,allInventoryItemTransactions:O||[]},{merge:!0}).then(Object(a.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:D("Stock updated successfully");case 1:case"end":return e.stop()}}),e)})))).catch((function(e){D("Error occured while updating quantity of inventory item: ".concat(null===e||void 0===e?void 0:e.message),{variant:"error"})}));case 13:e.next=16;break;case 15:D("Stock could not be updated as item could not be found, please check inventory",{variant:"error"});case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=13,u.b.collection("company").doc(g).collection(null===L||void 0===L?void 0:L.id).doc(_.toString()).set(Object(o.a)({},Ke),{merge:!0}).then(Object(a.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("vat_invoice"!==(null===L||void 0===L?void 0:L.id)&&"invoice"!==(null===L||void 0===L?void 0:L.id)&&"cash_transaction"!==(null===L||void 0===L?void 0:L.id)||g!==Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_PROTECTED_COMPANY:"d49MsS8JbYcUnff60n0E",REACT_APP_PROTECTED_USER:"Baelzs07ToMHTlIPzsHqjMZLBL72",REACT_APP_CUSTOM_REQUIREMENT_WORLDLINK_EXAMPLE:'["9VNEXj9ahhngQ3U8oQ4i"]',REACT_APP_EBS_MRA_ID:"17128123218161EW4CBZY12Y",REACT_APP_EBS_MRA_USERNAME:"Oudish",REACT_APP_EBS_MRA_PASSWORD:"Ash124Ash124",REACT_APP_EBS_MRA_REFRESH_TOKEN_PARAM:"FALSE",REACT_APP_EBS_MRA_TOKEN_ENDPOINT:"https://vfisc.mra.mu/einvoice-token-service/token-api/generate-token",REACT_APP_EBS_TRANSACTION_TYPES:'[{"id": "B2B","type": "(B2B) Business to Business"},{"id": "B2G","type": "(B2G) Business to Government"},{"id": "B2C","type": "(B2C) Business to Consumer"},{"id": "EXP","type": "(EXP) Zero rated supplies - Exports"},{"id": "B2E","type": "(B2E) Taxable supplies made to exempt bodies or persons"}]',REACT_APP_EBS_VAT_OR_NON_VAT_REGISTERED_VALUES:'[{"id":"VATR","title":"VAT Registered"},{"id":"NVTR","title":"Non VAT Registered"}]',REACT_APP_EBS_BUYER_TYPE_VALUES:'[{"id":"VATR","title":"VAT Registered Person"},{"id":"NVTR","title":"Non VAT Registered Person"},{"id":"EXMP","title":"Exempt Person"}]',REACT_APP_EBS_TAX_CODE_VALUES:'[{"id":"TC01","title":"(T) Taxable rate - 15%"},{"id":"TC02","title":"(Z) Zero rated"},{"id":"TC03","title":"(E) Exempt"},{"id":"TC04","title":"(D - Disbursement) Non fiscal items not affecting turnover"},{"id":"TC05","title":"(TEB) Standard rated supplies made to exempt bodies or persons"}]',REACT_APP_EBS_NATURE_VALUES:'[{"id":"GOODS","title":"Goods"},{"id":"SERVICES","title":"Services"}]',REACT_APP_EBS_SALES_TRANSACTION_VALUES:'[{"id":"CASH","title":"CASH (Cash/Bank Transfers/Cheques/Cards/Other)"},{"id":"CREDIT","title":"Credit"}]',REACT_APP_PARTICULAR_DESC_OPTIONS:'["Gate Pass", "Landing Charges"]',REACT_APP_EBS_INVOICE_TYPE_DESC_INVOICE:'[{"id": "STD","type": "Standard"},{"id": "TRN","type": "Training"}]',REACT_APP_EBS_INVOICE_TYPE_DESC_CREDIT_NOTE:'[{"id": "CRN","type": "Credit"}]',REACT_APP_EBS_INVOICE_TYPE_DESC_DEBIT_NOTE:'[{"id": "DRN","type": "Debit"}]',REACT_APP_EBS_INVOICE_TYPE_DESC_PROFORMA:'[{"id": "PRF","type": "Proforma"}]',REACT_APP_DOCUMENT_TEMPLATES:'["std", "transport", "slarks", "smart_promote", "flexitrans"]',REACT_APP_EMAILJS_PUBLIC_KEY:"GSb72AhjTKPF-1qEF",REACT_APP_CONVERT_API_SECRET:"13cZcSaMcOWpV9lI",REACT_APP_ADMIN_EMAIL:"contact@fertositeweb.com",REACT_APP_ADMIN_EMAIL_SERVICE_KEY:"service_4u2qlcp",REACT_APP_REGISTRATION_FORM_TEMPLATE_KEY:"template_gtoask8",REACT_APP_INQUIRY_FORM_TEMPLATE_KEY:"template_u6twrz9",REACT_APP_SOA_TEMPLATE_KEY:"template_0p7wave",REACT_APP_SOFTWARE_NAME:"Reaching Heights Ltd",REACT_APP_OWNER_CAR_RENTAL_ATISH:"carrentalatish",REACT_APP_OWNER:"carrentalatish",REACT_APP_VERSION:"4.1.7",REACT_APP_API_KEY:"AIzaSyDYknQfnmlUF6VJPhU9d0yFgf1ZKmGtuEA",REACT_APP_AUTH_DOMAIN:"car-rental-39926.firebaseapp.com",REACT_APP_PROJECT_ID:"car-rental-39926",REACT_APP_STORAGE_BUCKET:"car-rental-39926.appspot.com",REACT_APP_MESSAGING_SENDER_ID:"398655009731",REACT_APP_APP_ID:"1:398655009731:web:fa32fd1360970c0f1e8376",REACT_APP_MEASUREMENT_ID:"G-68J9VBEQEP",REACT_APP_DISTRICT:'["Flacq","Grand Port","Moka","Pamplemousses","Plaines Wilhems","Port Louis","Rivi\xe8re du Rempart","Rivi\xe8re Noire","Savanne"]',REACT_APP_GOOGLE_MAP_API_KEY:"AIzaSyAuUzKzg8D3zZkgeEz7oXFwBDnMulZX26I",REACT_APP_COLLECTION_STORES:"stores",REACT_APP_COLLECTION_SERVICES:"services",REACT_APP_COLLECTION_VEHICLES:"vehicles",REACT_APP_CURRENCY_USED:"\u20ac",REACT_APP_ICON_180:"/favicon/carrental/apple-touch-icon.png",REACT_APP_ICON_32:"/favicon/carrental/favicon-32x32.png",REACT_APP_ICON_16:"/favicon/carrental/favicon-16x16.png",REACT_APP_TITLE:"Reaching Heights Ltd",REACT_APP_DESCRIPTION:"Car Rental platform",REACT_APP_KEYWORDS:"Reaching Heights Ltd,RHL,car-rental,Car Rental",REACT_APP_AUTHOR:"Reaching Heights Ltd",REACT_APP_RHL_ID:"5HAEgHE1kKox9ZdweP3I",REACT_APP_COMPANY_ID:"5HAEgHE1kKox9ZdweP3I",REACT_APP_COMPANY_NAME:"REACHING HEIGHTS LTD",REACT_APP_SERVICE_KEY:"service_ishhonm",REACT_APP_TEMPLATE_KEY:"template_u6twrz9",REACT_APP_EMAIL:"info@reachingheightsltd.com",REACT_APP_LIGHTER:"#B3C3E8",REACT_APP_LIGHT:"#5381ED",REACT_APP_MAIN:"#333333",REACT_APP_DARK:"#1441A8",REACT_APP_DARKER:"#0D2A6E"}).REACT_APP_CUSTOM_SMART_PROMOTE_ID){e.next=5;break}return e.next=3,Ve({id:_.toString(),data:Object(o.a)({},Ke)},"FULL");case 3:e.next=8;break;case 5:if(!("proforma"===(null===L||void 0===L?void 0:L.id)&&g===Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_PROTECTED_COMPANY:"d49MsS8JbYcUnff60n0E",REACT_APP_PROTECTED_USER:"Baelzs07ToMHTlIPzsHqjMZLBL72",REACT_APP_CUSTOM_REQUIREMENT_WORLDLINK_EXAMPLE:'["9VNEXj9ahhngQ3U8oQ4i"]',REACT_APP_EBS_MRA_ID:"17128123218161EW4CBZY12Y",REACT_APP_EBS_MRA_USERNAME:"Oudish",REACT_APP_EBS_MRA_PASSWORD:"Ash124Ash124",REACT_APP_EBS_MRA_REFRESH_TOKEN_PARAM:"FALSE",REACT_APP_EBS_MRA_TOKEN_ENDPOINT:"https://vfisc.mra.mu/einvoice-token-service/token-api/generate-token",REACT_APP_EBS_TRANSACTION_TYPES:'[{"id": "B2B","type": "(B2B) Business to Business"},{"id": "B2G","type": "(B2G) Business to Government"},{"id": "B2C","type": "(B2C) Business to Consumer"},{"id": "EXP","type": "(EXP) Zero rated supplies - Exports"},{"id": "B2E","type": "(B2E) Taxable supplies made to exempt bodies or persons"}]',REACT_APP_EBS_VAT_OR_NON_VAT_REGISTERED_VALUES:'[{"id":"VATR","title":"VAT Registered"},{"id":"NVTR","title":"Non VAT Registered"}]',REACT_APP_EBS_BUYER_TYPE_VALUES:'[{"id":"VATR","title":"VAT Registered Person"},{"id":"NVTR","title":"Non VAT Registered Person"},{"id":"EXMP","title":"Exempt Person"}]',REACT_APP_EBS_TAX_CODE_VALUES:'[{"id":"TC01","title":"(T) Taxable rate - 15%"},{"id":"TC02","title":"(Z) Zero rated"},{"id":"TC03","title":"(E) Exempt"},{"id":"TC04","title":"(D - Disbursement) Non fiscal items not affecting turnover"},{"id":"TC05","title":"(TEB) Standard rated supplies made to exempt bodies or persons"}]',REACT_APP_EBS_NATURE_VALUES:'[{"id":"GOODS","title":"Goods"},{"id":"SERVICES","title":"Services"}]',REACT_APP_EBS_SALES_TRANSACTION_VALUES:'[{"id":"CASH","title":"CASH (Cash/Bank Transfers/Cheques/Cards/Other)"},{"id":"CREDIT","title":"Credit"}]',REACT_APP_PARTICULAR_DESC_OPTIONS:'["Gate Pass", "Landing Charges"]',REACT_APP_EBS_INVOICE_TYPE_DESC_INVOICE:'[{"id": "STD","type": "Standard"},{"id": "TRN","type": "Training"}]',REACT_APP_EBS_INVOICE_TYPE_DESC_CREDIT_NOTE:'[{"id": "CRN","type": "Credit"}]',REACT_APP_EBS_INVOICE_TYPE_DESC_DEBIT_NOTE:'[{"id": "DRN","type": "Debit"}]',REACT_APP_EBS_INVOICE_TYPE_DESC_PROFORMA:'[{"id": "PRF","type": "Proforma"}]',REACT_APP_DOCUMENT_TEMPLATES:'["std", "transport", "slarks", "smart_promote", "flexitrans"]',REACT_APP_EMAILJS_PUBLIC_KEY:"GSb72AhjTKPF-1qEF",REACT_APP_CONVERT_API_SECRET:"13cZcSaMcOWpV9lI",REACT_APP_ADMIN_EMAIL:"contact@fertositeweb.com",REACT_APP_ADMIN_EMAIL_SERVICE_KEY:"service_4u2qlcp",REACT_APP_REGISTRATION_FORM_TEMPLATE_KEY:"template_gtoask8",REACT_APP_INQUIRY_FORM_TEMPLATE_KEY:"template_u6twrz9",REACT_APP_SOA_TEMPLATE_KEY:"template_0p7wave",REACT_APP_SOFTWARE_NAME:"Reaching Heights Ltd",REACT_APP_OWNER_CAR_RENTAL_ATISH:"carrentalatish",REACT_APP_OWNER:"carrentalatish",REACT_APP_VERSION:"4.1.7",REACT_APP_API_KEY:"AIzaSyDYknQfnmlUF6VJPhU9d0yFgf1ZKmGtuEA",REACT_APP_AUTH_DOMAIN:"car-rental-39926.firebaseapp.com",REACT_APP_PROJECT_ID:"car-rental-39926",REACT_APP_STORAGE_BUCKET:"car-rental-39926.appspot.com",REACT_APP_MESSAGING_SENDER_ID:"398655009731",REACT_APP_APP_ID:"1:398655009731:web:fa32fd1360970c0f1e8376",REACT_APP_MEASUREMENT_ID:"G-68J9VBEQEP",REACT_APP_DISTRICT:'["Flacq","Grand Port","Moka","Pamplemousses","Plaines Wilhems","Port Louis","Rivi\xe8re du Rempart","Rivi\xe8re Noire","Savanne"]',REACT_APP_GOOGLE_MAP_API_KEY:"AIzaSyAuUzKzg8D3zZkgeEz7oXFwBDnMulZX26I",REACT_APP_COLLECTION_STORES:"stores",REACT_APP_COLLECTION_SERVICES:"services",REACT_APP_COLLECTION_VEHICLES:"vehicles",REACT_APP_CURRENCY_USED:"\u20ac",REACT_APP_ICON_180:"/favicon/carrental/apple-touch-icon.png",REACT_APP_ICON_32:"/favicon/carrental/favicon-32x32.png",REACT_APP_ICON_16:"/favicon/carrental/favicon-16x16.png",REACT_APP_TITLE:"Reaching Heights Ltd",REACT_APP_DESCRIPTION:"Car Rental platform",REACT_APP_KEYWORDS:"Reaching Heights Ltd,RHL,car-rental,Car Rental",REACT_APP_AUTHOR:"Reaching Heights Ltd",REACT_APP_RHL_ID:"5HAEgHE1kKox9ZdweP3I",REACT_APP_COMPANY_ID:"5HAEgHE1kKox9ZdweP3I",REACT_APP_COMPANY_NAME:"REACHING HEIGHTS LTD",REACT_APP_SERVICE_KEY:"service_ishhonm",REACT_APP_TEMPLATE_KEY:"template_u6twrz9",REACT_APP_EMAIL:"info@reachingheightsltd.com",REACT_APP_LIGHTER:"#B3C3E8",REACT_APP_LIGHT:"#5381ED",REACT_APP_MAIN:"#333333",REACT_APP_DARK:"#1441A8",REACT_APP_DARKER:"#0D2A6E"}).REACT_APP_CUSTOM_SMART_PROMOTE_ID&&Number(N)>0)){e.next=8;break}return e.next=8,Ve({id:_.toString(),data:Object(o.a)({},Ke)},"PARTIAL");case 8:h(Object(E.d)(!0)),m({showViewButton:!0}),S(),D("".concat(null===L||void 0===L?void 0:L.title," saved successfully")),"transport"!==(null===y||void 0===y||null===(t=y.data)||void 0===t?void 0:t.documentTemplate)&&O(),h(Object(E.d)(!1));case 14:case"end":return e.stop()}}),e)})))).catch((function(e){D("Error occured while saving document: ".concat(null===e||void 0===e?void 0:e.message),{variant:"error"}),h(Object(E.d)(!1))}));case 13:case"end":return e.stop()}}),e)}))),Be.apply(this,arguments)}function Ve(e,t){return xe.apply(this,arguments)}function xe(){return xe=Object(a.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){h(Object(E.d)(!0));var o=u.b.collection("company").doc(g).collection("payment").doc("paymentCounter");u.b.runTransaction(function(){var e=Object(a.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.get(o).then((function(e){return e.exists?Number(e.data().paymentCounter||0)+1:null})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then(function(){var o=Object(a.a)(c.a.mark((function o(i){return c.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(null!==i){o.next=5;break}return o.next=3,u.b.collection("company").doc(g).collection("payment").doc("paymentCounter").set({paymentCounter:1}).then(Object(a.a)(c.a.mark((function o(){return c.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,we(1,t,n);case 2:o.sent&&e(!0);case 4:case"end":return o.stop()}}),o)})))).catch((function(e){D("Error occured while creating payment counter: ".concat(null===e||void 0===e?void 0:e.message),{variant:"error"}),h(Object(E.d)(!1))}));case 3:o.next=10;break;case 5:if(!(i&&Number(i)>0)){o.next=10;break}return o.next=8,we(i,t,n);case 8:o.sent&&e(!0);case 10:case"end":return o.stop()}}),o)})));return function(e){return o.apply(this,arguments)}}()).catch((function(t){D("Error occured while executing payment transaction: ".concat(null===t||void 0===t?void 0:t.message),{variant:"error"}),h(Object(E.d)(!1)),e(!0)}))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),xe.apply(this,arguments)}function we(e,t,n){return Ue.apply(this,arguments)}function Ue(){return(Ue=Object(a.a)(c.a.mark((function e(t,n,o){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){var i,r,_,d,A=t.toString();1===(null===(i=A)||void 0===i?void 0:i.length)?A="0000".concat(A):2===(null===(r=A)||void 0===r?void 0:r.length)?A="000".concat(A):3===(null===(_=A)||void 0===_?void 0:_.length)?A="00".concat(A):4===(null===(d=A)||void 0===d?void 0:d.length)&&(A="0".concat(A));var l,s=0,T=0,R="";if("FULL"===o)s=0,T=null===n||void 0===n||null===(l=n.data)||void 0===l?void 0:l.docTotal,R="Paid";else if("PARTIAL"===o){var v,p,m,S,O;if(T=Number(N||0),Number((null===n||void 0===n||null===(v=n.data)||void 0===v?void 0:v.docRemainingPaymentAmt)||0)>0)s=Number((null===n||void 0===n||null===(S=n.data)||void 0===S?void 0:S.docRemainingPaymentAmt)||0)-Number(N);else s=Number((null===n||void 0===n||null===(O=n.data)||void 0===O?void 0:O.docTotal)||0)-Number(N);s===Number((null===n||void 0===n||null===(p=n.data)||void 0===p?void 0:p.docTotal)||0)?R="Unpaid":0!==s&&s<Number((null===n||void 0===n||null===(m=n.data)||void 0===m?void 0:m.docTotal)||0)?R="Partially paid":s<0?R="Over paid":0===s&&(R="Paid")}var I=u.b.batch(),f=t.toString(),b=u.b.collection("company").doc(y.id).collection("payment").doc("paymentCounter"),g=u.b.collection("company").doc(y.id).collection("payment").doc(f),M=u.b.collection("company").doc(y.id).collection(null===L||void 0===L?void 0:L.id).doc(n.id);I.set(b,{paymentCounter:Number(t)},{merge:!0}),I.set(g,{invoiceList:[{invoiceId:null===n||void 0===n?void 0:n.id}],paymentDate:C()(new Date).format("DD-MM-YYYY"),dateCreated:P.a.firestore.Timestamp.fromDate(new Date)},{merge:!0}),I.set(M,{paymentStatus:R,docRemainingPaymentAmt:s,attachedPaymentNumber:[{paymentNumber:f,paymentNumberString:A,paymentType:"",paymentAmount:T,paymentRemainingAmount:s,paymentDate:C()(new Date).format("DD-MM-YYYY")}]},{merge:!0}),I.commit().then(Object(a.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:D("".concat(o," payment applied successfully")),h(Object(E.d)(!1)),e(!0);case 3:case"end":return t.stop()}}),t)})))).catch((function(t){D("Error occured while making ".concat(o," payment: ").concat(null===t||void 0===t?void 0:t.message),{variant:"error"}),h(Object(E.d)(!1)),e(!0)}))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(v.jsx)(v.Fragment,{children:Object(v.jsx)(_.a,{variant:"contained",color:"primary",onClick:function(){return function(){return ye.apply(this,arguments)}()},fullWidth:!0,disabled:!(null!==n&&void 0!==n&&n.docTotal),children:"Save ".concat(null===L||void 0===L?void 0:L.title)})})}}}]);
//# sourceMappingURL=65.f603231f.chunk.js.map